webpackJsonp([87],{1160:function(t,e,a){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s,l,i=function(){function t(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,a,r){return a&&t(e.prototype,a),r&&t(e,r),e}}(),u=a(1),c=function(t){return t&&t.__esModule?t:{default:t}}(u);a(41);e.default=t.exports=(l=s=function(t){function e(t){r(this,e);var a=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return a.start=function(t){a.touchX=t.touches[0].pageX,a.touchY=t.touches[0].pageY,a.initX=a.state.translateX},a.move=function(t){var e=a.props,r=e.max_disx,n=e.can_scroll,o=e.idx,s=parseInt(t.touches[0].pageX-a.touchX),l=parseInt(t.touches[0].pageY-a.touchY);a.setState({diffX:s,diffY:l}),!n||Math.abs(l)>Math.abs(s)||(s<0&&s>-r&&a.initX>-r?(a.props.reset_all(o),a.setState({translateX:s})):s>0&&s<r&&a.initX<0&&a.setState({translateX:a.initX+s}))},a.end=function(t){var e=a.props,r=e.max_disx,n=e.can_scroll,o=e.scroll_time,s=a.state,l=s.diffX,i=s.diffY,u=s.translateX,c=r/o,f=a,p=u;if(n&&!(Math.abs(i)>Math.abs(l)))if(l<0&&a.initX>-r)var d=(r-Math.abs(u))/c,_=setInterval(function(){p>=-r?(p-=3,f.setState({diffX:p,translateX:p})):(clearInterval(_),f.setState({diffX:-r,translateX:-r}))},d);else if(l>0&&a.initX<0)var h=Math.abs(u)/c,m=setInterval(function(){p<=0?(p+=3,f.setState({diffX:p,translateX:p})):(clearInterval(m),f.setState({diffX:0,translateX:0}))},h)},a.runClick=function(t){t.stopPropagation(),a.state.translateX<0?a.setState({diffX:0,translateX:0}):a.props.onClick()},a.state={diffX:0,translateX:0},a}return o(e,t),i(e,[{key:"componentWillReceiveProps",value:function(t){t.reset&&this.setState({translateX:0,diffX:0})}},{key:"render",value:function(){return c.default.createElement("div",{className:"scroll_warp limit-min",onTouchStart:this.start,onTouchMove:this.move,onTouchEnd:this.end,onClick:this.runClick,style:{transform:"translateX("+this.state.translateX+"px)"}},this.props.children)}}]),e}(c.default.Component),s.contextTypes={auth_info:c.default.PropTypes.object,req:c.default.PropTypes.object,fconf:c.default.PropTypes.object,env:c.default.PropTypes.object},l)},821:function(t,e,a){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var l,i,u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t},c=function(){function t(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,a,r){return a&&t(e.prototype,a),r&&t(e,r),e}}(),f=a(1),p=r(f),d=a(981),_=r(d),h=a(1160),m=r(h),v=a(270),g=r(v),b=a(46),y=r(b),E=a(75),X=a(15),x=r(X),w=a(114),j=r(w),k=a(17),P=r(k),M=a(984),O=a(982),C=r(O),S=a(165),T=r(S),N=a(113),I=r(N),q=a(76);r(q);e.default=t.exports=(i=l=function(t){function e(t){n(this,e);var a=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return a.move=function(t,e,r){t.stopPropagation(),(0,y.default)("/contact/fast_add_group?"+x.default.stringify({u2_list:e,group_id1:parseInt(a.context.req.query.id),idx:r}),"添加到分组","fetch")},a.updateGroup=function(t){var e=a.props.group_list.total.total;a.props.cursor.select("group_list","users").splice([t.idx,1]),a.props.cursor.select("group_list","total").set(e-1),a.resetAll(!0)},a.delItem=function(t,e,r){t.stopPropagation();var n=a.props.group_list.total,o=a.context,s=o.auth_info,l=o.fconf,i=a.props.cursor.select("group_list","users",r,"st").get(),c=a.props.statue,f=l.online_url+"talent/v3/uh/group_update_user?"+x.default.stringify(u({},s,{id1:parseInt(a.context.req.query.id),uid2:e})),p=fetch(f,{credentials:"same-origin"}).then(E.parse_online_json).then(function(t){var e=0,o=c.length,s=0;for(o;e<o;e++)if(c[e].st==i){s=e;break}a.props.cursor.select("statue",s,"num").set(c[s].num-1),a.props.cursor.select("statue",0,"num").set(c[0].num-1),a.props.cursor.select("group_list","users").splice([r,1]),a.props.cursor.select("group_list","total").set(n-1),I.default.sendWebViewBroadcast("update_suc"),a.resetAll(!0)}).catch(E.toast_error_handler);(0,j.default)("请求中...",p)},a.resetAll=function(t){a.setState({reset:t})},a.goUhchat=function(t,e){t.stopPropagation(),(0,y.default)("/uh_chat?"+x.default.stringify({u2:e,from:"groups"}),"极速联系","fetch")},a.filter=P.default.debounce(function(t,e){var r=a.context,n=r.auth_info,o=r.fconf;a.setState({cur_status:t,status_name:e});var s=o.online_url+"talent/v3/uh/group_user_list?"+x.default.stringify(u({},n,{id:parseInt(a.context.req.query.id),st:t,off:0,lmt:20})),l=fetch(s,{credentials:"same-origin"}).then(E.parse_online_json).then(function(t){a.setState({show_list:!1}),a.resetAll(!0),a.props.cursor.select("group_list").set(t)}).catch(E.toast_error_handler);(0,j.default)("请求中...",l)},500,!0),a.goChat=function(t,e){t.stopPropagation(),MaiMai_Native.native_chat?MaiMai_Native.native_chat("",e):alert("您的APP版本太低, 请升级新版!")},a.loadMore=function(){var t=a.context,e=t.fconf,r=t.req,n=t.auth_info,o=a.refs.loader,s=a.state,l=s.cur_status,i=s.page;o&&o.bindRequest(function(){var t=e.online_url+"talent/v3/uh/group_user_list?"+x.default.stringify(u({},n,{id:parseInt(r.query.id),st:l,off:i,lmt:20}));return fetch(t,{credentials:"same-origin"}).then(E.parse_online_json).then(function(t){a.resetAll(!0),a.setState({show_list:!1,page:i+20}),a.props.cursor.select("group_list","users").concat(t.users)}).catch(E.toast_error_handler)})},a.state={cur_status:0,status_name:"全部状态",show_list:!1,page:20,reset:!0},a}return s(e,t),c(e,[{key:"componentDidMount",value:function(){I.default.bindBroadcast("update_suc",this.updateGroup)}},{key:"componentWillUnmount",value:function(){I.default.unbindBroadcast("update_suc",this.updateGroup)}},{key:"renderContact",value:function(){var t=this,e=this.props.group_list;return e.total<1?p.default.createElement("div",{style:(0,M.margin)("70px","0px","0px","0px"),className:"text-light text-center small"},p.default.createElement("img",{src:"/static/images/no_result_icon.png",style:(0,M.size)(60)}),p.default.createElement("div",null,"该分组还没有数据哦~")):e.users.map(function(e,a){return p.default.createElement("div",{className:"scroll_group_item",key:a},p.default.createElement(m.default,{max_disx:"155",can_scroll:!0,reset:t.state.reset!=a,reset_all:t.resetAll,cursor:t.props.cursor,idx:a,scroll_time:3},p.default.createElement("ul",null,p.default.createElement(g.default,{contact:e.ucard,onClick:t.goToDetail,hideDist:!0},1==e.st&&p.default.createElement("div",{className:"fast_click_btn",onClick:function(a){t.goUhchat(a,e.ucard.id)}},"极速联系"),4==e.st&&p.default.createElement("div",{className:"fast_click_btn",onClick:function(a){t.goChat(a,e.ucard.id)}},"发消息"))),p.default.createElement("div",{className:"scroll_right scroll_right_item clearfix"},p.default.createElement("div",{className:"halfWidth fl_btn fl h-100",onClick:function(r){t.move(r,e.ucard.id,a)}},p.default.createElement("span",null,"移动")),p.default.createElement("div",{className:"halfWidth fr_btn fr h-100",onClick:function(r){t.delItem(r,e.ucard.id,a)}},p.default.createElement("span",null,"删除")))))})}},{key:"render",value:function(){var t=this,e=this.state,a=e.show_list,r=e.cur_status,n=e.status_name,o=this.props,s=o.statue,l=o.group_list,i=o.cursor,u=o.name;return p.default.createElement("div",{className:"fast_contact_group"},p.default.createElement(_.default,{title:u}),p.default.createElement("div",{className:"m-b-10 status_bar",onClick:function(){t.setState({show_list:!a})}},n," ",p.default.createElement("i",{className:a?"choiced":""})),p.default.createElement(C.default,{loadMore:this.loadMore,hasMore:l.total>l.users.length,loader:p.default.createElement(T.default,{ref:"loader",reload:this.loadMore,cursor:i.select("loading_status")})},this.renderContact()),p.default.createElement("div",{className:"status_detail_warp "+(a?"show":"hide")},p.default.createElement("div",{className:"mask",onClick:function(){t.setState({show_list:!1})}}),p.default.createElement("ul",{className:"status_detail"},s.map(function(e,a){return p.default.createElement("li",{onClick:function(){t.filter(e.st,e.name)},key:a},e.name," (",e.num,")",r==e.st&&p.default.createElement("i",{className:"choiced_icon"}))}))))}}]),e}(p.default.Component),l.contextTypes={auth_info:p.default.PropTypes.object,req:p.default.PropTypes.object,fconf:p.default.PropTypes.object,env:p.default.PropTypes.object},i)}});