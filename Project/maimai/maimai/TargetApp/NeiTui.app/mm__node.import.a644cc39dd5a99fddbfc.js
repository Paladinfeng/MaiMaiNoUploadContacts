webpackJsonp([18],{1098:function(e,t,i){"use strict";function a(){this.currentPage=0,this.data={},this.hasMore=!0,this.requesting=!1,this.cursor_status=0,this.firstload=0}function n(){var e={current_tabindex:0,tabs:[]},t=new a;t.data.videos=[],e.tabs.push(t);var t=new a;return t.data.hist=[],e.tabs.push(t),e}e.exports.TabEnum={hotlive:0,history:1},e.exports.tab_manager=n},1161:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var n=i(1),r=a(n),s=i(50),o=(a(s),i(46)),l=(a(o),i(113),i(63)),c=a(l),u=i(168),d=(a(u),i(284)),f=a(d),p=i(116),m=a(p),h=r.default.createClass({displayName:"LiveHistory",getInitialState:function(){return{}},componentDidMount:function(){},componentWillUnmount:function(){},render:function(){var e=this,t=this.props,i=t.videos;return 1!=t.first_load||i&&0!=i.length?r.default.createElement("div",null,i&&i.map(function(t){return r.default.createElement(f.default,{component:"li",className:"list-group-item",pressDelay:800,key:t.id,onClick:function(i){return e.liveHotClick(t)},style:{textAlign:"left"}},r.default.createElement("div",{className:"media list-group-item-heading list-group-item-text"},r.default.createElement("div",{className:"media-left"},r.default.createElement("img",{className:"media-object cursor-pointer",style:g.img_size,src:t.avatar}),r.default.createElement("div",{className:"live-hot-item-container"},r.default.createElement("div",{className:"live-hot-item-status"},t.tip))),r.default.createElement("div",{className:"media-body live-hotitem-right",style:g.right_container},r.default.createElement("div",{className:"text-muted small",style:g.title},t.title),r.default.createElement("div",{style:g.follow,className:"text-muted small"},t.subcnt,"人关注"),r.default.createElement("div",{style:g.positon_container},r.default.createElement("span",{style:g.name},c.default.mark(e,t.name)),r.default.createElement("span",{style:g.career}," | ",c.default.mark(e,m.default.getCareer(t))),1==t.judge&&r.default.createElement("span",{className:"add_v_img"})))))})):r.default.createElement("div",{style:{marginTop:50,height:80},className:"text-primary text-center"},"还没有热门职播哦")},liveHotClick:function(e){this.props.onClick(e)}}),g={img_size:{with:80,height:80},right_container:{marginLeft:20,marginRight:10},title:{fontSize:14,marginTop:5,color:"#232323"},follow:{fontSize:13,marginTop:5,color:"#A1A1A1"},positon_container:{marginTop:5},name:{fontSize:13,marginTop:5,color:"#5b7797"},career:{fontSize:13,marginTop:5,color:"#A1A1A1"},children:{paddingTop:5,paddingRight:10}};e.exports=h},1162:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),l=i(1),c=a(l),u=i(47),d=a(u),f=(i(115),i(15)),p=a(f),m=function(e){function t(){var e,i,a,s;n(this,t);for(var o=arguments.length,l=Array(o),c=0;c<o;c++)l[c]=arguments[c];return i=a=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),a.gotoRegister=function(){var e="http://maimai.cn/show2?"+p.default.stringify({regfr:"livevideo_bottom"});window.location=e},s=i,r(a,s)}return s(t,e),o(t,[{key:"componentDidMount",value:function(){window.screen.height,d.default.findDOMNode(this.refs.articleBottom)}},{key:"render",value:function(){return c.default.createElement("div",{ref:"articleBottom",className:"livevideoBottomWrap",onClick:this.gotoRegister},c.default.createElement("div",{className:"p-relative articleBottomBox"},c.default.createElement("div",{className:"articleBottomBg"}),c.default.createElement("div",{className:"articleBottom p-absolute text-white"},c.default.createElement("div",{className:"media-left p-r-10"},c.default.createElement("div",{className:"articleBottomAvatar"},c.default.createElement("img",{className:"w-100 radius-50",src:this.props.avatar}))),c.default.createElement("div",{className:"media-body media-middle font-14"},"我还有更多直播节目",c.default.createElement("br",null),"跟你共享"),c.default.createElement("div",{className:"media-right media-middle p-r"},c.default.createElement("div",{className:"download_btn_white small"},"立即下载")),c.default.createElement("div",{className:"articleBottomClose"}))),c.default.createElement("div",{className:"articleBottomDis text-center small clearfix"},c.default.createElement("div",{className:"fl w-60 white-bg l-h-22 border-radius-3 border-gray-1"},"我要提问"),c.default.createElement("div",{className:"fl text-blue l-h-24",style:h.nextpaly},"下一直播")))}}]),t}(c.default.Component),h={nextpaly:{float:"right",width:"40%"}};t.default=e.exports=m},1163:function(e,t,i){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),r=i(76),s=(function(e){e&&e.__esModule}(r),i(15),i(17)),o=i(1164),l=i(1165);i(286);t.default=e.exports=function(){function e(t,i,n){a(this,e),this.lid=i,this.af_id=-1,this.enter_time=Math.round(s.now()/1e3),this.baobabTree=n,this.auth_info=t.auth_info,this.u=t.auth_info.u,this.u&&-1!=this.u||(this.u=6),o.initFConf(t.fconf)}return n(e,[{key:"setFromFlag",value:function(e){this.from_out_side=e}},{key:"fetch_new_dlg",value:function(){var e=this;o.get_dial_live(this.auth_info,this.u,this.lid,this.af_id,this.enter_time).then(this.updateUsers.bind(this)).then(this._update_af_id.bind(this)).then(function(t){e.saveMessages(t.dials),e.fetch_new_dlg()}).catch(function(t){e.pollcnt=0,setTimeout(function(){e.fetch_new_dlg()},4e3+s.random(0,1e4))})}},{key:"messagesCursor",value:function(){return this.baobabTree.root.select("dials")}},{key:"usersCursor",value:function(){return this.baobabTree.root.select("users")}},{key:"updateUsers",value:function(e){var t=this;if(!e||!e.dials)return Promise.resolve(e);var i=[];if(s.forEach(e.dials,function(e){e.data&&e.data.src_uid&&i.push(e.data.src_uid)}),s.isEmpty(i))return Promise.resolve(e);var a=s.map(this.usersCursor().get(),function(e){return parseInt(e.mmid)}),n=s.difference(i,a);return s.isEmpty(n)?Promise.resolve(e):this.from_out_side&&1==this.from_out_side?o.get_msg_users_outside(this.u,n).then(function(i){return t.saveUsers(i.users),Promise.resolve(e)}):o.get_msg_users(this.auth_info,n).then(function(i){return t.saveUsers(i.users),Promise.resolve(e)})}},{key:"saveUsers",value:function(e){s.isEmpty(e)||(this.usersCursor().get()?this.usersCursor().set(this.usersCursor().get().concat(e)):this.usersCursor().set(e))}},{key:"_update_af_id",value:function(e){var t=this;return e.dials&&s.forEach(e.dials,function(e){t.af_id<=e.id&&(t.af_id=e.id)}),Promise.resolve(e)}},{key:"saveMessages",value:function(e){var t=this;if(!s.isEmpty(e)){var i=s.filter(e,function(e){return l.find(t.messagesCursor(),function(t){return t.id==e.id}).merge(e)==l.emptyCursor}),a=s.filter(this.messagesCursor().get().concat(i),function(e){return 0==e.type});if(!s.isEmpty(a)){var n=s.sortBy(a,function(e){return e.id});this.messagesCursor().set(n)}}}}]),e}()},1164:function(e,t,i){"use strict";var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},n=i(75),r=i(15),s=i(17),o={};e.exports.initFConf=function(e){s.isEmpty(o)&&(o=e)},e.exports.get_dial_live=function(e,t,i,s,l){var c=o.apn_url+"msg/v4/new_dial_live?"+r.stringify(a({},e,{u:t,lid:i,af_id:s,enter_time:l,timeout:18e4}));return fetch(c).then(n.parse_online_json)},e.exports.getUserInfo=function(e,t,i){var s=o.api_url+"sdk/contact/get_card?"+r.stringify(a({},e,{u2:t,lid:i}));return fetch(s,{method:"get",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(n.parse_online_json)},e.exports.get_msg_users=function(e,t){var i=o.online_url+"msg/v31/get_msg_users?"+r.stringify(a({},e,{mmids:t.join(",")}));return fetch(i).then(n.parse_online_json)},e.exports.get_msg_users_outside=function(e,t){var i="/article/get_msg_users_outside?"+r.stringify({u:e,mmids:t.join(",")});return fetch(i,{credentials:"same-origin"}).then(n.parse_online_json)}},1165:function(e,t,i){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){var i=d.findIndex(e.get(),function(e){return d.isMatch(e,t)});return i<0?f:e.select(i)}function r(e,t){var i=d.findIndex(e.get(),t);return!(i<0)&&(e.splice([i,1]),!0)}function s(e,t){var i=d.findIndex(e.get(),t);return i<0?f:e.select(i)}function o(e){if(!e||!e.get()||0==e.get().length)return f;var t=e.get().length-1;return e.select(t)}function l(e,t,i){return e?e.get()[t]?e.select(t).merge(i):e.select(t).set(i):f}function c(e){return new p(e)}var u=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),d=i(17),f={merge:function(e){return f},set:function(e){return f},push:function(e){return f},unshift:function(e){return f},splice:function(e){return f},apply:function(e){return f},select:function(e){return f},get:function(){return f}},p=function(){function e(t){a(this,e),this.cursor=t}return u(e,[{key:"findWhere",value:function(t){return new e(n(this.cursor,t))}},{key:"find",value:function(t){return new e(s(this.cursor,t))}},{key:"last",value:function(){return new e(o(this.cursor))}},{key:"mergeOrSet",value:function(t,i){return new e(l(this.cursor,t,i))}},{key:"merge",value:function(t){return this.cursor.merge(t),new e(this.cursor)}},{key:"set",value:function(t){return this.cursor.set(t),new e(this.cursor)}},{key:"push",value:function(t){return this.cursor.push(t),new e(this.cursor)}},{key:"unshift",value:function(t){return this.cursor.unshift(t),new e(this.cursor)}},{key:"apply",value:function(t){return this.cursor.apply(t),new e(this.cursor)}},{key:"select",value:function(t){return new e(this.cursor.select(t))}},{key:"get",value:function(){return this.cursor}},{key:"isEmptyCursor",value:function(){return this.cursor==f}},{key:"isNotEmptyCursor",value:function(){return this.cursor!=f}}]),e}();e.exports.emptyCursor=f,e.exports.findWhere=n,e.exports.find=s,e.exports.last=o,e.exports.mergeOrSet=l,e.exports.chain=c,e.exports.findAndDelete=r},1486:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var n=i(1),r=a(n),s=i(50),o=(a(s),i(46)),l=(a(o),i(113),r.default.createClass({displayName:"LiveHistory",getInitialState:function(){return{}},componentDidMount:function(){},componentWillUnmount:function(){},render:function(){var e=this,t=this.props,i=t.hist;return 1!=t.first_load||i&&0!=i.length?r.default.createElement("div",null,i&&i.map(function(t){return r.default.createElement("div",{className:"livecast-card",key:t.lid,onClick:function(i){return e.liveHistoryClick(t)}},r.default.createElement("div",{className:"livecast-title"},t.title),r.default.createElement("div",{className:"livecast-desc"},t.cnt?t.cnt:0,"人看过"))})):r.default.createElement("div",{style:{marginTop:50,height:80},className:"text-primary text-center"},"TA没有精彩回放哦")},liveHistoryClick:function(e){this.props.onClick(e)}}));e.exports=l},1487:function(e,t,i){"use strict";var a=i(1),n=(i(985)("app"),i(1488).dialogueItemsHeights),r=i(302),s=i(275),o=i(47),l=(i(165),i(1489)),c=i(17),u=a.createClass({displayName:"DialogueListOutSideLive",mixins:[s],shouldComponentUpdate:function(e,t){return this.props.message&&this.props.message!=e.message&&this.saveScrollBottom(),this.props.message&&(this.props.message!=e.message||t!=this.state)},getInitialState:function(){return{}},render:function(){var e=this,t=[],i=this.state?this.state.height||100:100,s=[],o=[];return this.props.message.forEach(function(i){var r=i.id,u=c.findWhere(e.props.users,{mmid:i.data.src_uid+""}),d=[],f=[];n[r]?(d=s,f=o):d=t,f.push(n[r]),d.push(a.createElement(l,{message:i,updateItemHeight:e.updateItemHeight,customKey:r,key:r,type:i.type,user:u}))}),this.cellsHeight=o,a.createElement("div",{ref:"list",className:"livechat-chat"},t.length>0&&a.createElement("div",{style:d.invisible},t),s.length>0&&a.createElement(r,{ref:"infinite_list",className:"dialogue_list_container",containerHeight:i,handleScroll:this.handleScroll,elementHeight:o},s))},restorePosition:function(){var e=o.findDOMNode(this.refs.infinite_list);e&&(this.scrollBottom?e.scrollTop=e.scrollHeight-this.scrollBottom:e.scrollTop=e.scrollHeight)},handleScroll:function(e){this.handleVisibleCell(e),this.savePosition(e)},handleVisibleCell:function(e){if(this.cellsHeight&&this.cellsHeight.length>0){var t=e.scrollTop,i=t+e.clientHeight,a=17;for(var n in this.cellsHeight){var r=this.cellsHeight[n];if(a>=i)break;a>=t&&a<i&&n>0&&this.props.message.length>n&&this.onCellDidVisible(this.props.message[n]),a+=r}}},onCellDidVisible:function(e){},savePosition:function(e){e.scrollTop;e.clientHeight,e.scrollHeight},saveScrollBottom:function(){var e=this,t=o.findDOMNode(this.refs.infinite_list);t&&(this.scrollBottom=t.scrollHeight-t.scrollTop,this.forceUpdate(),setTimeout(function(){delete e.scrollBottom},1e3))},minDlgId:function(e){return e.dialogues?e.dialogues[0].id:-1},componentDidUpdate:function(){this.restorePosition(),this.updateContainerHeight()},componentDidMount:function(){this.restorePosition(),this.forceUpdate()},updateContainerHeight:function(){var e=o.findDOMNode(this.refs.list);e&&(this.state&&e.clientHeight==this.state.height||(this.setState({height:e.clientHeight}),this.forceUpdate()))},updateItemHeight:function(e,t){n[e]!=t&&(n[e]=t,this.forceUpdate())}}),d={webimChatCon:{position:"absolute",left:"30px",right:"30px",bottom:"53px",top:"53px",overflow:"auto",background:"white"},yellowWar:{position:"absolute",left:"0",top:0,zIndex:"10",width:"100%",color:"#000000",lineHeight:"30px",fontSize:"12px",background:"#ffffa0",cursor:"pointer"},invisible:{height:"0"},container:{height:"100%",width:"100%",position:"absolute",top:0,bottom:20}};e.exports=u},1488:function(e,t,i){"use strict";e.exports.dialoguePositions={},e.exports.topDlalogueIds={},e.exports.dialogueItemsHeights={},e.exports.dialogueInputDrafts={},e.exports.dialogueInputAtUsers={}},1489:function(e,t,i){"use strict";var a=i(1),n=i(166),r=(i(1490),i(1491)),s=(i(282).format_for_dialogue,i(1492),i(50),i(46),i(270),i(273),i(47)),o=(i(1493),i(1494),i(1495),i(1496),a.createClass({displayName:"DialogueCardLive2",shouldComponentUpdate:function(e,t){return this.props.message!=e.message},render:function(){var e=this.props.type,t=this.props.user,i="";if(0==e)t.name,t.avatar,t.judge,t.career,i=this.props.message.data.text;else if(6==e)i=t.name+this.props.message.data.text,"职播消息","/static/images/logo.png","",0;else if(2==e){var n=this.props.message.data.text;n&&(n=n.substring(-1==n.indexOf("我")?0:n.indexOf("我")+1)),i=t.name+" "+n+"该公司图标","职播消息","/static/images/logo.png","",0}else i=this.props.message.data.text,"职播消息","/static/images/logo.png","",0;var s;return s=a.createElement(r,{className:"livechat-item-career",text:i}),a.createElement("div",{ref:"root",className:"clearfix"},a.createElement("div",{className:"livechat-item"},this.renderCareer(e,t),a.createElement("div",{className:"livechat-item-content"},s)))},renderCareer:function(e,t){return 0!=e?a.createElement("div",null,a.createElement("span",{className:"livechat-item-name"},"职播消息")):a.createElement("div",null,a.createElement("span",{className:"livechat-item-name"},t.name),a.createElement("span",{className:"livechat-item-career"}," ",t.career),1==t.judge&&a.createElement("span",{className:"add_v_img"}))},componentDidMount:function(){this.reportItemHeight()},componentDidUpdate:function(){this.reportItemHeight()},reportItemHeight:function(){if(this.props.updateItemHeight){var e=s.findDOMNode(this.refs.root);console.log("clientHeight + 20="+(e.clientHeight+10)),this.props.updateItemHeight(this.props.customKey,e.clientHeight+10)}}}));e.exports=n(o)},1490:function(e,t,i){"use strict";var a={borderRadius:"2px",black:"#000000",gray:"#777777",lightGray:"#999999",blue:"#2e90e4",white:"#ffffff",large:"16px",medium:"14px",small:"12px"};e.exports={addv:{paddingRight:"18px",background:"url(/static/images/addv_pc.png) no-repeat right center",backgroundSize:"12px 12px"},chatItemMarin:{marginBottom:"20px"},chatConInfo:{maxWidth:"50%",textAlign:"center",margin:"0px auto 28px"},chatConCardInfo:{maxWidth:"70%",margin:"0px auto 28px"},chatConTime:{display:"inline-block",fontSize:a.small,color:a.lightGray,borderRadius:a.borderRadius,lineHeight:"20px",background:"#f1f1f1",padding:"0 16px"},myChatConBox:{textAlign:"right"},chatConBoxAvatar:{cursor:"pointer",display:"inline-block",width:40,height:40,borderRadius:a.borderRadius},chatConOthersAvatar:{float:"left",marginRight:"10px"},chatConMyAvatar:{float:"right",marginLeft:"10px"},chatCon:{overflow:"hidden",fontSize:a.medium,color:a.black,lineHeight:"20px",maxWidth:"70%",display:"inline-block"},chatConH4:{display:"inline-block",fontWeight:"normal",fontSize:"13px",color:a.black,paddingLeft:"11px",maxWidth:"350px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",wordWrap:"break-word",wordBreak:"break-all"},chatMyConH4:{paddingLeft:"11px",paddingRight:"11px"},chatConSpan:{fontSize:a.small,color:a.lightGray,paddingLeft:"5px"},chatTxt:{display:"inline-block",padding:"11px 13px",wordWrap:"break-word",wordBreak:"break-all",lineHeight:"20px",borderRadius:"3px"},chatImage:{display:"inline-block",padding:"4px 6px",borderRadius:"3px"},chatConOthersChatTxt:{background:"#c4effe"},chatConMyChatTxt:{background:"#f1f1f1",position:"relative"},othersChatTxtBox:{position:"relative",paddingLeft:"11px"},myChatTxtBox:{position:"relative",paddingRight:"11px",paddingLeft:"24px"},leftChatIcon:{position:"absolute",left:"0",top:"5px",display:"inline-block",width:11,height:9,background:"url(/static/images/icon_spirit2.png) no-repeat 0 -195px"},rightChatIcon:{position:"absolute",right:"0",top:"5px",display:"inline-block",width:11,height:9,background:"url(/static/images/icon_spirit2.png) no-repeat 0 -210px"},leftAudioTxt:{display:"inline-block",padding:"11px 10px"},rightAudioTxt:{display:"inline-block",padding:"11px 10px",float:"right"},messageStatus:{width:20,height:20,position:"absolute",left:"-24px",top:"50%",marginTop:"-10px"}}},1491:function(e,t,i){"use strict";var a=i(1),n=i(90),r=i(41),s=i(1019);e.exports=a.createClass({displayName:"exports",mixins:[r],render:function(){var e=this.props.text;return a.createElement("div",null,s(e).lines().map(function(e,t){return e&&a.createElement("div",{style:{textAlign:"left"},key:t},a.createElement(n,{text:e,support_dref:!0,emojiSize:18,emojiMargin:2}))||null}))}})},1492:function(e,t,i){"use strict";var a=i(1),n=function(e){return e&&e.__esModule?e:{default:e}}(a),r=i(117),s=n.default.createClass({displayName:"cmp",openDetail:function(){this.props.openImageInMessage(this.props.image)},render:function(){var e=this.props.image;return n.default.createElement("div",{style:o.cursor},n.default.createElement("img",{onClick:this.openDetail,style:(0,r.rect)(e.tx/2,e.ty/2),src:e.turl}))}}),o={cursor:{cursor:"pointer"}};e.exports=s},1493:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var n=i(1),r=a(n),s=i(90),o=a(s),l=i(984);e.exports=r.default.createClass({displayName:"exports",render:function(){return r.default.createElement("div",{className:"dialog_common_card",onClick:this.props.click},r.default.createElement("div",{className:"line_title bottom_margin"},r.default.createElement(o.default,{text:this.props.title})),r.default.createElement("img",{src:this.props.image,className:"pull-left"}),r.default.createElement("div",{className:"pull-left"},r.default.createElement("div",{className:"small single_line text-muted",style:null==this.props.line2||0==this.props.line2.length?(0,l.margin)("10px","0px","0px","0px"):{}},r.default.createElement(o.default,{text:this.props.line1})),r.default.createElement("div",{className:"small single_line text-muted"},r.default.createElement(o.default,{text:this.props.line2}))))}})},1494:function(e,t,i){"use strict";var a=i(984),n=i(1),r=i(90),s=n.createClass({displayName:"PCdashedCard",renderBottom:function(){var e=this,t="media p-y p-x dashBottomCon ",i=!1;return(this.props.line1||this.props.line2)&&(t+="dashTopCon",i=!0),n.createElement("div",{className:t,onClick:this.props.cardContentClick},i&&n.createElement("div",null,n.createElement("div",{className:"media-left"},n.createElement("img",{src:this.props.icon})),n.createElement("div",{className:"media-body media-middle"},n.createElement("div",{className:"text-info"},n.createElement(r,{text:this.props.line1,support_dref:!0})),n.createElement("div",{className:"text-info"},n.createElement(r,{text:this.props.line2,support_dref:!0})))),this.props.button&&n.createElement("div",{className:"pull-right text-primary",onClick:function(t){e.props.btnClick(t),t.stopPropagation()}},this.props.button))},render:function(){return n.createElement("div",{className:"solidOutline"},n.createElement("div",{className:"media p-y p-x",onClick:this.props.cardTopClick},n.createElement("div",{className:"media-body"},n.createElement("div",{className:"text-content"},n.createElement(r,{text:this.props.top,support_dref:!0})),n.createElement("div",{className:"text-info",style:(0,a.textOverflow)(2)},n.createElement(r,{text:this.props.content,support_dref:!0})))),this.renderBottom())}});e.exports=s},1495:function(e,t,i){"use strict";var a=i(1),n=a.createClass({displayName:"PCrRedPacketCard",render:function(){return a.createElement("div",{className:"RPwrap white-bg",onClick:this.props.onClick},a.createElement("div",{className:"media orange-bg p-t-10 p-b-10 p-l-10 p-r-10  borderBottom"},a.createElement("div",{className:"media-left"},a.createElement("img",{className:"media-object imgSize",src:this.props.icon})),a.createElement("div",{className:"media-body media-vertical"},a.createElement("div",{className:"interLine1"},this.props.title),a.createElement("div",{className:"interLine2"},this.props.sub_title))),a.createElement("div",{className:"RPFrom text-info p-x"},this.props.footer))}});e.exports=n},1496:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var n=i(1),r=a(n),s=i(1497),o=a(s),l=i(76),c=(a(l),i(17)),u=a(c);e.exports=r.default.createClass({displayName:"exports",getInitialState:function(){return{playing:!1}},componentDidMount:function(){this.audioManager=new o.default},onItemClicked:u.default.debounce(function(){this.props.dialogue.play?this.props.stopAudio(this.props.message.id,this.props.dialogue.id):this.props.playAudio(this.props.message.id,this.props.dialogue.id)},1e3,!0),renderPlaying:function(){if("loading"==this.props.dialogue.play||"playing"==this.props.dialogue.play){var e="/static/images/"+(this.props.dialogue.is_me?"audio_playing2.gif":"audio_playing1.gif");return r.default.createElement("img",{src:e,style:{width:16,height:16}})}},renderPlay:function(){if(!this.props.dialogue.play){var e="/static/images/"+(this.props.dialogue.is_me?"audio_play2.png":"audio_play1.png");return r.default.createElement("img",{src:e,style:{width:16,height:16}})}},render:function(){var e=8*this.props.dialogue.file.duration;e=e>100?100:e;var t=e+30;return r.default.createElement("div",{onClick:this.onItemClicked,style:{width:t,textAlign:this.props.dialogue.is_me?"right":"left",cursor:"pointer"}},this.renderPlay(),this.renderPlaying())}})},1497:function(e,t,i){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n,r,s=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}();t.default=e.exports=(r=n=function(){function e(){a(this,e)}return s(e,[{key:"loadData",value:function(t){return new Promise(function(i,a){if(e.audio_cache[t])return void i(e.audio_cache[t]);var n=new XMLHttpRequest;0==t.indexOf("http://")&&(t=t.replace(/^http:\/\//,"https://")),n.open("GET",t,!0),n.responseType="blob",n.onload=function(n){if(200==n.target.status){var r=n.target.response,s=new FileReader;s.onload=function(a){var n=a.target.result;e.audio_cache[t]=n,i(n)},s.readAsBinaryString(r)}else a(n.target.status)},n.send()})}},{key:"play",value:function(t){return new Promise(function(i){e.audio&&e.audio.pause();var a=Speex.decodeFile(t),n=a[0],r=a[1],s=r.rate,o=n,l=PCMData.encode({sampleRate:s||8e3,channelCount:1,bytesPerSample:2,data:o}),c=new Audio;e.audio=c,c.src="data:audio/wav;base64,"+btoa(l),c.play(),c.addEventListener("ended",function(){c.currentTime=0,i()})})}},{key:"stop",value:function(){e.audio&&e.audio.pause()}}]),e}(),n.audio_cache={},r)},1498:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var n=i(76),r=(a(n),i(75)),s=a(r),o=i(1),l=(i(47),""),c=o.createClass({displayName:"LiveVideoPlayer",contextTypes:{auth_info:o.PropTypes.object,fconf:o.PropTypes.object,req:o.PropTypes.object},shouldComponentUpdate:function(e,t){return!(!this.props.key||this.props.key==e.key&&t==this.state)},getInitialState:function(){return{isPause:!1,isEnd:!1}},componentWillMount:function(){},componentDidMount:function(){var e=this,t=document.getElementById("v1");if(t){var i="";navigator.userAgent.match(/Android/i)&&(i="android"),"android"===i&&navigator.userAgent.indexOf("AppleWebKit")>-1?(t.addEventListener("webkitfullscreenchange",function(e){document.webkitIsFullScreen||t.pause()},!1),t.addEventListener("ended",function(){document.webkitCancelFullScreen(),t.controls="controls";var e="/article/qlive_stat?lid="+l;fetch(e,{credentials:"same-origin"}).then(s.default.parse_online_json).then(function(e){0==e.astat&&a()}).catch(function(e){s.default.toast_error_handler(e)})},!1)):t.addEventListener("ended",function(){console.log("video ended");var e="/article/qlive_stat?lid="+l;fetch(e,{credentials:"same-origin"}).then(s.default.parse_online_json).then(function(e){0==e.astat&&a()}).catch(function(e){s.default.toast_error_handler(e)})},!1);var a=function(){e.setState({isEnd:!0}),e.forceUpdate()};t.addEventListener("error",function(e){switch(e.target.error.code){case 1:"视频播放被用户终止，请重试";break;case 2:"视频下载发生错误";break;case 3:"视频解码发生错误";break;case 4:"浏览器无法支持当前视频播放"}var t="/article/qlive_stat?lid="+l;fetch(t,{credentials:"same-origin"}).then(s.default.parse_online_json).then(function(e){0==e.astat&&a()}).catch(function(e){s.default.toast_error_handler(e)})},!1),t.addEventListener("play",function(){console.log("video play")},!1),t.addEventListener("pause",function(){console.log("video pause")},!1),t.play()}},render:function(){var e=this;console.log("render livevideo");var t=this.props.data;l=t.lid;var i=this.props.clientHeight;return o.createElement("div",null,o.createElement("video",{ref:"refvideo",title:t.title,style:{height:i},className:"livevideo_show",id:"v1",controls:"controls",autoplay:"autoplay","webkit-playsinline":!0,onClick:function(t){return e.onVideoClick()},src:this.props.playUrl}),this.state.isEnd&&o.createElement("div",{className:"livevideo_end_div"},"直播已结束"))},onVideoClick:function(){},onPlayClick:function(){}});e.exports=c},826:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},r=i(1),s=a(r),o=i(75),l=a(o),c=i(114),u=a(c),d=i(15),f=a(d),p=i(76),m=a(p),h=i(981),g=a(h),v=i(983),_=a(v),y=i(46),b=(a(y),i(50)),x=a(b),E=i(78),k=a(E),C=i(165),w=a(C),N=i(1486),P=a(N),T=i(1161),M=a(T),H=i(1487),j=a(H),S=i(1498),I=a(S),O=i(115),B=i(1162),D=a(B),A=i(982),U=i(1098).TabEnum,R=(i(1098).tab_manager,i(1163)),L=i(275),z=i(17),W=s.default.createClass({displayName:"live_detail",mixins:[L],contextTypes:{req:s.default.PropTypes.object,fconf:s.default.PropTypes.object,auth_info:s.default.PropTypes.object,env:s.default.PropTypes.object},getInitialState:function(){return{isPlayClick:!1,liveUrl:""}},componentWillMount:function(){},componentDidMount:function(){},componentWillUnmount:function(){console.log("componentWillUnmount")},render:function(){var e=this,t=this.props,i=t.result,a=(t.cursor,t.cur),n=t.sub_stat,r=t.subcnt,o=this.context,l=o.auth_info,c=o.env,u={share_info:{name:"职播",title:i&&i.cur&&i.cur.title?i.cur.title:"",desc:i&&i.desc,card_id:i.cur?i.cur.lid+"":"",card_type:7,icon_url:i.auth_info.avatar}};return u.more_items=[{title:"分享",callback:"MaiMai_Native.native_share(1)"}],s.default.createElement("div",null,s.default.createElement(g.default,{title:i.auth_info&&i.auth_info.name?i.auth_info.name+"的职播":"职播间"}),s.default.createElement(_.default,{msg_to_app:u}),s.default.createElement("div",{className:"outside-liveuser-line",onClick:function(t){return e.gotoDetail()}},s.default.createElement("img",{className:"liveavatar",src:i.auth_info.avatar}),s.default.createElement("div",{className:"livecompany-positiondiv"},s.default.createElement("span",{className:"livename"},i.auth_info.name),s.default.createElement("span",{className:"livecompany-position"}," | ",i.auth_info.company,i.auth_info.position),1==i.auth_info.judge&&s.default.createElement("span",{className:"add_v_img"}))),a&&s.default.createElement("div",{className:"livevideo-container"},!this.state.isPlayClick&&this.renderPicShow(),this.state.isPlayClick&&this.renderVideoPlay(),!this.state.isPlayClick&&s.default.createElement("div",{className:"livevideo-status"},a.tip)),s.default.createElement("div",{className:"live-outside-line"},s.default.createElement("div",{className:"live-outside-line-num"},r),s.default.createElement("div",{className:"live-outside-line-text"},"人关注该职播"),0==i.is_author&&-1!=l.u&&s.default.createElement("div",{className:"live-outside-line-fllow",onClick:function(t){return 1==n?e.unfollow():e.follow()}},1==n?"取消关注":"关 注")),this.renderFooter(),-1==l.u&&c.mobile&&!this.state.isPlayClick&&s.default.createElement("div",null,s.default.createElement("div",{style:q.bottomHeight}),s.default.createElement(D.default,{avatar:i.auth_info.avatar})))},renderPicShow:function(){var e=this,t=this.props,i=t.result,a=t.cur;return s.default.createElement("div",{className:"livedummy"},s.default.createElement("img",{className:"livepicture",src:i.files,onClick:function(t){return a&&1==a.status?null:e.onPictureClick(a)}}),a&&1==a.status&&s.default.createElement("img",{className:"liveplay_icon",src:"../../static/images/live_play.png",onClick:function(t){return e.onPictureClick(a)}}),s.default.createElement("div",{className:"livetitle-container"},s.default.createElement("div",{className:"livetitle"},a.title)),1==i.red_packet&&s.default.createElement("img",{className:"livepaly_redpackage",src:"../../static/images/redpackage.png",onClick:function(t){return e.onRedPacketClick()}}))},renderVideoPlay:function(){var e=document.documentElement.clientHeight-60,t=this.props.cur;return s.default.createElement("div",null,s.default.createElement("div",{style:{marginTop:e}}),s.default.createElement(I.default,{data:t,clientHeight:e,key:t.lid,playUrl:this.state.liveUrl,ref:"livevideo"}),s.default.createElement("div",{className:"livechat-container"},s.default.createElement(j.default,{key:t.lid,message:this.props.dials,users:this.props.users})))},renderFooter:function(){var e=this.props.cursor.select("tab_manager").get();if(!e)return null;var t=e.tabs[e.current_tabindex],i=e.current_tabindex,a=this.props.cursor.select("tab_manager","tabs",i,"cursor_status"),n=t.hasMore,r=t.firstload,o=[],l=[];return i==U.hotlive?l=e.tabs[i].data.videos||[]:o=e.tabs[i].data.hist||[],s.default.createElement("div",null,s.default.createElement("div",{className:"livevideo-top-blank"}),s.default.createElement("div",{className:"clearfix"},s.default.createElement("div",{className:"twoTabs-live text-center clearfix"},s.default.createElement("div",{className:0==i?"leftTab pull-left live-tab-text-blue curTab-live":"leftTab pull-left tab-live-color-gray",onClick:this.onTabVisitClicked},s.default.createElement("div",{className:"twoTabTxt"},"热门职播")),s.default.createElement("div",{className:1==i?"rightTab pull-right live-tab-text-blue curTab-live":"rightTab pull-right tab-live-color-gray",onClick:this.onTabPrizeClicked},s.default.createElement("div",{className:"twoTabTxt"},"TA的精彩回放"))),s.default.createElement("hr",{className:"live-tabble-line"}),s.default.createElement(A,{loadMore:this.loadMore,hasMore:n,loader:s.default.createElement(w.default,{ref:"loader",reload:this.loadMore,cursor:a})},s.default.createElement("div",{className:"panel panel-default",id:"zkp_content",style:{marginBottom:"0"}},s.default.createElement("ul",{className:"list-group",key:"1",style:i==U.hotlive?q.show:q.hide},s.default.createElement(M.default,{key:"1",videos:l,onClick:this.liveHotClick,first_load:r})),s.default.createElement("ul",{className:"list-group",key:"2",style:i==U.history?q.show:q.hide},s.default.createElement(P.default,{key:"2",hist:o,onClick:this.liveHistoryClick,first_load:r}))))))},loadMore:function(){var e,t=this,i=this.props.result,a=this.context,n=a.auth_info,r=(a.req,a.fconf,this.props.cursor.select("tab_manager")),s=r.select("current_tabindex").get(),o=r.select("tabs",s);switch(s){case U.hotlive:e="/article/qlive_court?"+f.default.stringify({u:n.u,page:o.get().currentPage,count:5});break;case U.history:e="/article/livemore?"+f.default.stringify({u:n.u,u2:i.auth_info.id,page:o.get().currentPage,count:5})}if(this.refs.loader&&!this.props.cursor.select("tab_manager","tabs",s).get().requesting&&this.props.cursor.select("tab_manager","tabs",s).get().hasMore){var c=i.auth_info.mmid;this.refs.loader.bindRequest(function(){return o.select("requesting").set(!0),fetch(e,{credentials:"same-origin"}).then(l.default.parse_online_json).then(function(e){t.updateData(e,o,s,c);var i=U.history?e.more||0:e.more;o.select("firstload").set(1),o.select("hasMore").set(1==i),o.select("currentPage").apply(function(e){return e+1}),o.select("cursor_status").set(0),o.select("requesting").set(!1),t.props.cursor.select("tab_manager","tabs",s,"requesting").set(!1)}).catch(function(e){o.select("firstload").set(2),o.select("cursor_status").set("failed"),o.select("requesting").set(!1),l.default.toast_error_handler(e)})})}},updateData:function(e,t,i,a){switch(i){case U.hotlive:if(e.videos&&e.videos.length>0){var n=z.filter(e.videos,function(e){return e.mmid!=a});0==t.select("currentPage").get()?t.select("data","videos").set(n):t.select("data","videos").concat(n)}break;case U.history:e.hist&&e.hist.length>0&&(0==t.select("currentPage").get()?t.select("data","hist").set(e.hist):t.select("data","hist").concat(e.hist))}},follow:function(){var e=this,t=this.context,i=(t.req,t.fconf),a=t.auth_info,r=this.props.result,s=i.online_url+"user/v4/sub_liveu?"+f.default.stringify(n({u:a.u,u2:r.auth_info.id},a));console.log("click url="+s);var l=fetch(s).then(o.parse_online_json).then(function(){(0,m.default)("已关注"),e.props.cursor.select("sub_stat").set(1),e.props.cursor.select("subcnt").set(e.props.cursor.select("subcnt").get()+1)}).catch(o.toast_error_handler);(0,u.default)("请稍候...",l)},unfollow:function(){var e=this,t=this.context,i=(t.req,t.fconf),a=t.auth_info,r=this.props.result,s=i.online_url+"user/v4/unsub_liveu?"+f.default.stringify(n({u:a.u,u2:r.auth_info.id},a)),l=fetch(s).then(o.parse_online_json).then(function(){(0,m.default)("已取消关注"),e.props.cursor.select("sub_stat").set(0),e.props.cursor.select("subcnt").set(e.props.cursor.select("subcnt").get()-1)}).catch(o.toast_error_handler);(0,u.default)("请稍候...",l)},onTabVisitClicked:function(){this.props.cursor.select("tab_manager","current_tabindex").set(U.hotlive)},onTabPrizeClicked:function(){this.props.cursor.select("tab_manager","current_tabindex").set(U.history)},onRedPacketClick:function(){var e=this.props.result;(0,m.default)("只能在脉脉客户端中,才能领取红包哦~~"),(0,O.launch)("livevideo",e.auth_info.id)},onPictureClick:function(e){var t=this.props.result,i=this.context.auth_info;if(0==e.status)window.MaiMai_Native&&window.MaiMai_Native.native_live_video?window.MaiMai_Native.native_live_video(e.lid,t.auth_info.id==i.u):t.auth_info.id==i.u?alert("请在脉脉app内部开始职播"):alert("职播未开始，打开脉脉app关注不错过精彩内容");else if(1==e.status){if(i.u<0)return void this.initVideoPlayer();window.MaiMai_Native&&window.MaiMai_Native.native_live_video?window.MaiMai_Native.native_live_video(e.lid,t.auth_info.id==i.u):this.initVideoPlayer()}else 2==e.status&&(0,x.default)("/article/weblive2?lid="+e.lid+"&type=3",e.title)},initVideoPlayer:function(){var e=this.props,t=e.cur,i=e.from_pc;i&&1==i?(0,x.default)("/article/weblive2?lid="+t.lid,t.title):this.getPlayInfo()},getPlayInfo:function(){var e=this,t=this.props,i=t.cur,a=(t.from_pc,this.context),n=(a.req,a.fconf,"/article/get_live_url?"+f.default.stringify({lid:i.lid})),r=fetch(n).then(o.parse_online_json).then(function(t){e.setState({isPlayClick:!0,liveUrl:t.url}),!i||1!=i.status&&0!=i.status||(e.messageManager=new R(e.context,i.lid,e.props.cursor.tree),e.messageManager.setFromFlag(!0),e.messageManager.fetch_new_dlg())}).catch(o.toast_error_handler);(0,u.default)("请稍候..",r)},liveHistoryClick:function(e){(0,x.default)("/article/weblive2?lid="+e.lid+"&type=3",e.title)},liveHotClick:function(e){var t="/article/live2?"+f.default.stringify({uid:e.mmid});(0,x.default)(t,e.title)},gotoDetail:function(){var e=this.props.result;try{(0,k.default)(e.auth_info.encode_mmid||e.auth_info.mmid,this.context)}catch(e){alert(e)}}}),q={table1:{width:"100%",tableLayout:"fixed",marginBottom:1},tr:{height:"50px"},text_info:{color:"#9C9C9C",fontSize:15},text_selected:{color:"#4876FF",fontSize:15},show:{display:"block",marginTop:-1},hide:{display:"none"},livechat:{marginBottom:40,backgroudColor:"#4876FF"},bottomHeight:{width:"100%",height:"140px"}};e.exports=W}});