webpackJsonp([33],{1147:function(e,t,r){"use strict";var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=(r(992),r(113),r(167),r(78)),s=function(e){return e&&e.__esModule?e:{default:e}}(o),c=r(1),a=r(41),i=(r(50),r(46)),l=r(75),u=(l.parse_online_json,l.toast_error_handler,r(15)),f=r(270),d=r(164),h=(d.nativeAddFriend,d.completeRealProfile,d.refreshPageSilent,c.createClass({displayName:"FastContactBatchCard",mixins:[a],contextTypes:{fconf:c.PropTypes.object,auth_info:c.PropTypes.object,req:c.PropTypes.object},getInitialState:function(){return{is_check:0}},goUhchat:function(e){e.stopPropagation();var t=this.props.contact;i("/uh_chat?"+u.stringify({u2:t.id,from:"fc_search"}),"极速联系","fetch")},nullFuc:function(e){e.stopPropagation()},goDetail:function(e){var t=this.props,r=t.contact,o=(t.cursor,this.context),c=o.auth_info,a=o.fconf;o.req;if(e.stopPropagation(),r.search_qs&&r.search_order){var i=a.online_url+"search/web/s_pb?"+u.stringify(n({srcu:c.u,type:"contact",targetid:r.mmid,order:r.search_order,qs:r.search_qs},c));fetch(i)}(0,s.default)(r.encode_mmid||r.mmid,this.context,{outofrel:r.outofrel})},render:function(){var e=(this.context.auth_info,this.props),t=e.contact,r=e.cursor;return c.createElement(f,{onClick:this.goDetail,contact:t,hideDist:!0,member_icon:this.props.member_icon,openMyMember:this.props.openMyMember,show_large_comps:this.props.show_large_comps,show_large_school:this.props.show_large_school},0==r.select("contact","is_fc").get()||0==r.select("is_fc").get()?c.createElement("div",{className:"fast_click_btn",style:p.noPaddingRight,onClick:this.goUhchat},"极速联系"):c.createElement("div",{className:"fast_disable_btn",style:p.noPaddingRight,onClick:this.nullFuc},"已联系过"))}})),p={done:{marginTop:6,height:40,lineHeight:"40px",verticalAlign:"middle",backgroundColor:"#efefef"},buttons:{marginTop:6,height:40},button:{display:"inline-block",width:"50%",paddingLeft:4,paddingRight:4},noPaddingRight:{marginRight:"-10px",marginTop:"6px"}};e.exports=h},1441:function(e,t,r){"use strict";var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=(r(992),r(113),r(167),r(78)),s=function(e){return e&&e.__esModule?e:{default:e}}(o),c=r(1),a=r(41),i=(r(50),r(46),r(75)),l=(i.parse_online_json,i.toast_error_handler,r(15)),u=r(270),f=r(164),d=(f.nativeAddFriend,f.completeRealProfile,f.refreshPageSilent,c.createClass(function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({displayName:"FastContactBatchCard",mixins:[a],contextTypes:{fconf:c.PropTypes.object,auth_info:c.PropTypes.object,req:c.PropTypes.object},getInitialState:function(){return{is_check:0}},changeBtn:function(e){e.stopPropagation();var t=this.props.contact;this.props.batchCB(this.state.is_check,t.id),0==this.state.is_check?this.setState({is_check:1}):this.setState({is_check:0})},nullFuc:function(e){e.stopPropagation()},goDetail:function(e){var t=this.props,r=t.contact,o=(t.cursor,this.context),c=o.auth_info,a=o.fconf;o.req;if(e.stopPropagation(),r.search_qs&&r.search_order){var i=a.online_url+"search/web/s_pb?"+l.stringify(n({srcu:c.u,type:"contact",targetid:r.mmid,order:r.search_order,qs:r.search_qs},c));fetch(i)}(0,s.default)(r.encode_mmid||r.mmid,this.context,{outofrel:r.outofrel})},render:function(){var e=(this.context.auth_info,this.props),t=e.contact,r=e.cursor;return c.createElement(u,{onClick:this.goDetail,contact:t,hideDist:!0,member_icon:this.props.member_icon,openMyMember:this.props.openMyMember},0==r.select("contact","is_fc").get()?c.createElement("div",{className:0==this.state.is_check?"fast_select_no":"fast_select",style:h.noPaddingRight,onClick:this.changeBtn}):c.createElement("div",{className:"fast_disable_batch_btn",style:h.noPaddingRight,onClick:this.nullFuc},"已联系过"))},renderPacket:function(){var e=this.props,t=e.contact;e.cursor;return c.createElement(u,{contact:t,hideDist:!0,member_icon:this.props.member_icon,openMyMember:this.props.openMyMember},c.createElement("div",{className:0==this.state.is_check?"fast_select_no":"fast_select",style:h.noPaddingRight,onClick:this.changeBtn}))}},"render",function(){this.context.auth_info;return c.createElement("div",null,this.renderPacket())}))),h={done:{marginTop:6,height:40,lineHeight:"40px",verticalAlign:"middle",backgroundColor:"#efefef"},buttons:{marginTop:6,height:40},button:{display:"inline-block",width:"50%",paddingLeft:4,paddingRight:4},noPaddingRight:{marginRight:"-10px",marginTop:"6px"}};e.exports=d},1442:function(e,t,r){"use strict";var n=(r(992),r(113),r(167),r(1)),o=r(41),s=(r(50),r(46)),c=r(75),a=(c.parse_online_json,c.toast_error_handler,r(15),r(270)),i=r(164),l=(i.nativeAddFriend,i.completeRealProfile,i.refreshPageSilent,n.createClass({displayName:"FastContactItemCardOut",mixins:[o],contextTypes:{fconf:n.PropTypes.object,auth_info:n.PropTypes.object,req:n.PropTypes.object},getInitialState:function(){return{is_check:0}},goUhchat:function(e){e.stopPropagation();var t=this.props.contact;s("/contact/detail/"+(t.encode_mmid||t.id)+"?from=fc_search_out","极速联系","fetch")},nullFuc:function(e){e.stopPropagation()},render:function(){var e=this.props,t=e.contact;e.cursor;return n.createElement(a,{contact:t,hideDist:!0,member_icon:this.props.member_icon},n.createElement("div",{className:"fast_click_btn",style:u.noPaddingRight,onClick:this.goUhchat},"极速联系"))}})),u={done:{marginTop:6,height:40,lineHeight:"40px",verticalAlign:"middle",backgroundColor:"#efefef"},buttons:{marginTop:6,height:40},button:{display:"inline-block",width:"50%",paddingLeft:4,paddingRight:4},noPaddingRight:{marginRight:"-10px",marginTop:"6px"}};e.exports=l},734:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a,i,l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),f=r(1),d=n(f),h=r(75),p=r(15),m=n(p),_=r(46),g=n(_),y=r(165),v=n(y),b=r(996),j=n(b),q=r(283),P=r(1021),E=n(P),C=r(1441),x=n(C),k=r(1147),w=n(k),M=r(1442),T=n(M),F=r(113),N=r(1020),S=(n(N),r(270),r(982)),R=r(63),L=r(990),O=r(1009),B=r(17),A=r(76);t.default=e.exports=(i=a=function(e){function t(){var e,r,n,c;o(this,t);for(var a=arguments.length,i=Array(a),u=0;u<a;u++)i[u]=arguments[u];return r=n=s(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),n.state={sel_cnt:0,is_batch:0,sel_uids:{}},n.getChildContext=function(){return n.context.req.query.talent?l({from:"search_talent_search"},R.getChildContext(n)):R.getChildContext(n)},n.loadMore=function(){var e=n.context,t=(e.fconf,e.req),r=(e.auth_info,n.props),o=r.cursor,s=r.searchTokens,c=n.refs.loader;c&&c.bindRequest(function(){var e="/search/fast_contact?"+m.default.stringify({count:20,page:n.nextPage||1,query:n.query||t.query.query,dist:t.query.dist||0,cid:t.query.cid,company:t.query.company,forcomp:t.query.forcomp||"0",searchTokens:JSON.stringify(s),highlight:"true",school:t.query.school,profession:n.profession,major:n.major,province:n.province,city:n.city,me:t.query.me,jsononly:1,frm:"webview#/search/fast_contact"});return fetch(e,{credentials:"same-origin"}).then(h.parse_online_json).then(function(e){o.select("contacts").concat(e.data.contacts),o.select("more").set(e.data.more),n.nextPage++})})},n.loadHotWords=function(){var e=n.props.cursor;return fetch("/search/hotwords",{credentials:"same-origin"}).then(h.parse_online_json).then(function(t){e.select("hotwords").set(t.hotwords),e.select("contacts").set(void 0)}).catch(function(t){e.select("hotwords").set(void 0)})},n.onReload=function(){n.query&&n.query.length>0&&n.searchContent(n.query)},n.searchContent=B.throttle(function(e){var t=this,r=this.props.cursor,n=this.context.req;if(!e||0==e.length)return r.merge({contacts:void 0,loading:null,hotwords:void 0}),this.loadHotWords();if(!this.query||this.query==e){r.merge({loading:"loading",failed:!1,contacts:[],more:0});var o="/search/fast_contact?"+m.default.stringify({query:this.query,count:20,page:0,dist:n.query.dist||0,cid:n.query.cid,company:n.query.company,forcomp:n.query.forcomp||"0",school:n.query.school,profession:this.profession,major:this.major,province:this.province,city:this.city,me:n.query.me,highlight:"true",jsononly:1});return fetch(o,{credentials:"same-origin"}).then(h.parse_online_json).then(function(n){t.query==e&&r.merge(B.extend(n.data,{loading:null})),t.closeBatch()}).catch(function(n){t.query==e&&r.merge({failed:!0})})}},1e3),n.searchCallback=function(e){var t=JSON.parse(e);this.nextPage=1,this.query&&this.query==t.keyword||(this.query=t.keyword,0==t.keyword.length&&this.props.cursor.merge({contacts:void 0,loading:null,hotwords:void 0}),this.searchContent(this.query))},n.toggleLocsFilter=function(){var e=n.props.cursor.select("locsFilter","close").get();n.props.cursor.select("locsFilter","close").set(!e),n.props.cursor.select("pfmjsFilter","close").set(!0)},n.togglePfmjsFilter=function(){var e=n.props.cursor.select("pfmjsFilter","close").get();n.props.cursor.select("pfmjsFilter","close").set(!e),n.props.cursor.select("locsFilter","close").set(!0)},n.onSelectLoc=function(e,t){if(e!=n.selectedLoc.province||t!=n.selectedLoc.city){n.selectedLoc.province=e,n.selectedLoc.city=t,n.province=e>0?n.locs[e].name:"",n.city=t>0?n.locs[e].items[t].name:"";var r=n.context.req;n.query=n.query||r.query.query,n.searchContent(n.query)}},n.onSelectedPfmj=function(e,t){if(e!=n.selectedPfmj.profession||t!=n.selectedPfmj.major){n.selectedPfmj.profession=e,n.selectedPfmj.major=t,n.profession=e>0?n.pfmjs[e].name:"",n.major=t>0?n.pfmjs[e].items[t].name:"";var r=n.context.req;n.query=n.query||r.query.query,n.searchContent(n.query)}},n.onCancelSelectLoc=function(){n.props.cursor.select("locsFilter","parent").set(n.selectedLoc.province),n.props.cursor.select("locsFilter","child").set(n.selectedLoc.city)},n.onCancelSelectPfmj=function(){n.props.cursor.select("pfmjsFilter","parent").set(n.selectedPfmj.profession),n.props.cursor.select("pfmjsFilter","child").set(n.selectedPfmj.major)},n.openMyMember=function(e){e.stopPropagation(),(0,g.default)("/uh_memlist?tpl=show&fr=fc","会员权益","fetch")},n.doAdsearch=function(){(0,g.default)("/search/uh_adsearch_index?"+m.default.stringify({}),"","fetch",{show_search_title:!0,search_hint:"请输入人名、职位、企业等关键字",search_focus:!1})},n.renderFilter=function(){if(n.context.req.query.talent)return d.default.createElement("div",null);var e=(n.province||"")+(n.city||""),t="filter_third filter_border highlight";e||(e="全部城市",t+="filter_third");var r=(n.profession||"")+(n.major||""),o="filter_third filter_border highlight";return r||(r="全部行业",o+="filter_third"),d.default.createElement("div",null,d.default.createElement("div",{className:"searchFilter"},d.default.createElement("div",{className:t,onClick:n.toggleLocsFilter},d.default.createElement("span",null,e)),d.default.createElement("div",{className:o,onClick:n.togglePfmjsFilter},d.default.createElement("span",null,r)),d.default.createElement("div",{className:"filter_third",onClick:n.doAdsearch},d.default.createElement("span",null,"高级搜索"))),d.default.createElement(O,{cursor:n.props.cursor.select("locsFilter"),items:n.locs,onSelect:n.onSelectLoc,onCancel:n.onCancelSelectLoc}),d.default.createElement(O,{cursor:n.props.cursor.select("pfmjsFilter"),items:n.pfmjs,onSelect:n.onSelectedPfmj,onCancel:n.onCancelSelectPfmj}))},n.renderHeadLoader=function(){return d.default.createElement("div",null,n.renderFilter(),d.default.createElement("div",{className:"searchList"},d.default.createElement(v.default,{ref:"loading",reload:n.onReload,failed:n.props.failed})))},n.renderEmptyResult=function(){var e=n.query||n.context.req.query.query;return d.default.createElement("div",null,n.renderFilter(),e&&d.default.createElement("div",{className:"searchList",style:L.empty},"没有找到相关结果"),!e&&d.default.createElement("div",{className:"searchList",style:L.empty},"请输入搜索词"))},n.goUhchat=function(e,t){e.stopPropagation(),(0,g.default)("/uh_chat?"+m.default.stringify({u2:t,from:"fc_search"}),"极速联系","fetch")},n.batchCB=function(e,t){0==e?(n.setState({sel_cnt:n.state.sel_cnt+1}),n.state.sel_uids[t]=1):(n.setState({sel_cnt:n.state.sel_cnt-1}),n.state.sel_uids[t]=0)},n.singleCB=function(e){n.setState({sel_cnt:n.state.sel_cnt+1}),n.state.sel_uids[e]=1},n.openBatch=function(){n.setState({is_batch:1})},n.closeBatch=function(){n.setState({is_batch:0,sel_cnt:0,sel_uids:{}})},n.batchSubmit=function(e){if(e.stopPropagation(),!(n.state.sel_cnt<=0)){var t=n.props.mycard,r=n.context,o=r.auth_info,s=r.fconf,c=[];for(var a in n.state.sel_uids){1==n.state.sel_uids[a]&&c.push(a)}var i=c.join(","),u=s.online_url+"/talent/v3/uh/group_user_cnt?"+m.default.stringify(l({},o));if(t.mem_st&&2!=t.mem_id)(0,g.default)("/contact/fast_add_group?"+m.default.stringify({u2_list:i,u2_cnt:c.length}),"添加到分组","fetch");else{fetch(u,{credentials:"same-origin"}).then(h.parse_online_json).then(function(e){e.left?e.left&&e.left<c.length?t.mem_st?t.mem_st&&2==t.mem_id&&(A("商务版会员当前可添加"+e.left+"人，升级会员可解除限制"),setTimeout(function(){(0,g.default)("/uh_memlist?fr=group_fc_search&set_flt=3,5&set_flt_only=1","会员中心","fetch")},1e3)):(A("非会员当前可添加人"+e.left+"人"),setTimeout(function(){(0,g.default)("/uh_memlist?fr=group_fc_search?","会员中心","fetch")},1e3)):(0,g.default)("/contact/fast_add_group?"+m.default.stringify({u2_list:i,u2_cnt:c.length}),"添加到分组","fetch"):t.mem_st?t.mem_st&&2==t.mem_id&&(A("立即升级会员，提升分组人数限制！"),setTimeout(function(){(0,g.default)("/uh_memlist?fr=group_fc_search&set_flt=3,5&set_flt_only=1","会员中心","fetch")},1e3)):(A("开通会员，解除分组限制，有效管理人脉！"),setTimeout(function(){(0,g.default)("/uh_memlist?fr=group_fc_search?","会员中心","fetch")},1e3))}).catch(toast_error_handler)}}},c=r,s(n,c)}return c(t,e),u(t,[{key:"componentWillMount",value:function(){if("undefined"!=typeof window){this.locs=q.cst.loc.map(function(e){var t=e.cities.map(function(e){return{name:e.city}});return t.unshift({name:"全部"}),{name:e.province,items:t}}),this.locs.unshift({name:"全部",items:[{name:"全部"}]}),this.pfmjs=q.cst.pfmj.map(function(e){var t=e.majors.map(function(e){return{name:e.name}});return t.unshift({name:"全部"}),{name:e.name,items:t}}),this.pfmjs.unshift({name:"全部",items:[{name:"全部"}]});var e=this.context.req;this.query=e.query.query,this.province=e.query.province,this.city=e.query.city,this.profession=e.query.profession,this.major=e.query.major;var t=this.province&&B.findIndex(this.locs,{name:this.province}),r=this.city&&(t>0?B.findIndex(this.locs[t].items,{name:this.city}):-1);t>=0?r=r>0?r:0:(t=0,r=-1);var n=this.profession&&B.findIndex(this.pfmjs,{name:this.profession}),o=this.major&&(n>0?B.findIndex(this.pfmjs[n].items,{name:this.major}):-1);n>=0?o=o>0?o:0:(n=0,o=-1),this.selectedLoc={province:t,city:r},this.selectedPfmj={profession:n,major:o},this.props.cursor.merge({locsFilter:{parent:t,child:r,close:!0},pfmjsFilter:{parent:n,child:o,close:!0}})}}},{key:"componentDidMount",value:function(){var e=this;this.nextPage=1,window.search_callback=this.searchCallback.bind(this),(0,F.bindBroadcast)("broadcast_fc_send_ok",function(t){e.state.sel_cnt<=0||(e.props.contacts.map(function(t,r){for(var n in e.state.sel_uids)n==t.uid&&e.props.cursor.select("contacts",r,"contact","is_fc").set(1)}),e.setState({sel_cnt:0}),e.setState({sel_uids:{}}))}),(0,F.bindBroadcast)("update_suc",this.closeBatch)}},{key:"componentWillUnmount",value:function(){window.search_callback=null}},{key:"render",value:function(){var e=this,t=this.props,r=t.contacts,n=t.cursor,o=t.more,s=t.hotwords,c=this.context,a=c.req,i=c.auth_info;if(void 0===r)return!a.query.talent&&window.MaiMai_Native.native_set_search_key?d.default.createElement(E.default,{search:"contacts",hotwords:s}):this.renderFilter();if(this.props.loading||this.props.failed)return this.renderHeadLoader();var l=this.query||a.query.query;return 0!=r.length&&l?i.u>0?d.default.createElement("div",null,this.renderFilter(),d.default.createElement("div",{className:a.query.talent?"":"searchList"},r.length>0||d.default.createElement(j.default,{tips:"暂时没有相关人脉",onClick:function(){}}),d.default.createElement(S,{loadMore:this.loadMore,hasMore:o>0&&i.u>0,loader:d.default.createElement(v.default,{ref:"loader",reload:this.loadMore,cursor:n.select("loading_status")})},d.default.createElement("div",{className:"panel panel-default"},d.default.createElement("ul",{className:"list-group"},r.map(function(t,r){var o=!1;return 1==t.mem_info.mem_st&&(o=!0),0==e.state.is_batch?d.default.createElement(w.default,{contact:t.contact,from:"webview#/search/fc_sss",singleCB:e.singleCB,search:!0,cursor:n.select("contacts",r),member_icon:o,openMyMember:e.openMyMember,key:t.contact.id}):d.default.createElement(x.default,{contact:t.contact,from:"webview#/search/fc_sss",batchCB:e.batchCB,search:!0,cursor:n.select("contacts",r),member_icon:o,openMyMember:e.openMyMember,key:t.contact.id})}))))),d.default.createElement("div",{className:"fast_margin"}," "),0==this.state.is_batch?d.default.createElement("div",{className:"fast_bottom clearfix",onClick:this.openBatch},d.default.createElement("span",{className:"fast_open_group"},"开启添加到分组")):d.default.createElement("div",{className:"fast_bottom clearfix"},d.default.createElement("span",{className:"fast_close",onClick:this.closeBatch},"关闭"),d.default.createElement("span",{className:"fast_add_group_btn",onClick:this.batchSubmit},"添加",d.default.createElement("span",{className:"text-orange"},this.state.sel_cnt),"位人脉到分组"))):d.default.createElement("div",null,d.default.createElement("div",{className:a.query.talent?"":"searchList"},r.length>0||d.default.createElement(j.default,{tips:"暂时没有相关人脉",onClick:function(){}}),d.default.createElement(S,{loadMore:this.loadMore,hasMore:o>0,loader:d.default.createElement(v.default,{ref:"loader",reload:this.loadMore,cursor:n.select("loading_status")})},d.default.createElement("div",{className:"panel panel-default"},d.default.createElement("ul",{className:"list-group"},r.map(function(e,t){return d.default.createElement(T.default,{contact:e.contact,from:"webview#/search/fc_out",search:!0,cursor:n.select("contacts",t),member_icon:!1})})))))):this.renderEmptyResult()}}]),t}(d.default.Component),a.contextTypes={req:d.default.PropTypes.object,fconf:d.default.PropTypes.object,auth_info:d.default.PropTypes.object},a.childContextTypes=l({from:d.default.PropTypes.string},R.contentTypes),i)}});