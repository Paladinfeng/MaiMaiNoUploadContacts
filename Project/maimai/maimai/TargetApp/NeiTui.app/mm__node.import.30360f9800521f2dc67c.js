webpackJsonp([34],{1100:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s,a,l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=n(1),u=function(e){return e&&e.__esModule?e:{default:e}}(c),f=(n(172),n(285)),d=(n(164).getCache,n(164).putCache);t.default=e.exports=(a=s=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onSend=function(e){e.stopPropagation();var t=n.props.func;t&&t(n.state.input)},n.onChangeJob=function(e){e.stopPropagation();var t=n.props.changeJob;t&&t()},n.onTextChange=function(){var e=n.refs.textarea.value;d("job_invite_msg",e),n.setState({input:e})},n.state={focus:!1,input:e.invite_msg},n}return r(t,e),l(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.contact,i=t.invite_job,o=t.invite_msg,r=t.changeJob,s=!this.state.focus&&!this.state.input;return u.default.createElement("div",{className:"add_comment LayerBox"},u.default.createElement("div",{className:"comtBox2"},u.default.createElement("div",{className:"comtRelation comtChoose clearfix",onClick:this.onChangeJob},u.default.createElement("span",{className:"chooseTitle"},n.show_invite_job_tips||"邀请TA投递"),u.default.createElement("span",{className:"chooseDetail"},f(i.position,10)||r&&"请先选择职位"))),u.default.createElement("div",{className:"comtTit2"},u.default.createElement("span",{className:"stressText"},n.show_invite_msg_tips||"对TA说点什么")),u.default.createElement("div",{className:"comtConBox"},s&&u.default.createElement("div",{onClick:function(){e.setState({focus:!0}),e.refs.textarea.focus()},className:"comment_tips"},"限150字。",u.default.createElement("br",null),u.default.createElement("br",null),n.show_invite_msg_placeholder||"例：我们正在招聘xxx职位，觉得你的经历和职位要求比较吻合，感兴趣的话投个简历吧",u.default.createElement("br",null),u.default.createElement("br",null)),u.default.createElement("textarea",{ref:"textarea",defaultValue:o||"",onChange:this.onTextChange,onfocus:function(){return e.setState({focus:!0})},onblur:function(){return e.setState({focus:!1})},className:"comtCon"})),u.default.createElement("div",{className:"m-a"},u.default.createElement("div",{className:"btn btn-lg btn-secondary btn-block m-t",onClick:this.onSend},n.show_invite_send_btn||"发送邀请")))}}]),t}(u.default.Component),s.contextTypes={fconf:u.default.PropTypes.object,req:u.default.PropTypes.object,auth_info:u.default.PropTypes.object},a)},1186:function(e,t,n){"use strict";var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},o=n(77),r=function(e){return e&&e.__esModule?e:{default:e}}(o),s=n(75),a=n(113),l=n(167),c=n(1),u=n(41),f=(n(50),n(46)),d=n(15),m=n(270),p=n(17),h=n(1048),_=n(172),g=n(76),v=n(1100),b=n(164).getCache,y=(n(164).putCache,c.createClass({displayName:"ExcellentContactItemCard",mixins:[u],contextTypes:{fconf:c.PropTypes.object,auth_info:c.PropTypes.object,req:c.PropTypes.object},getInitialState:function(){return{is_check:0}},goUhchat:function(e){e.stopPropagation();var t=this.props.contact;this.props.singleCB(t.id),f("/uh_chat?"+d.stringify({u2:t.id,from:this.props.fr||"excellent"}),"极速联系","fetch")},getInviteJob:function(){var e=this.props,t=e.joblist,n=e.contact;try{var i=parseInt(_.get("job_invite_jid"));if(i>0&&n.invited_jids&&n.invited_jids.indexOf(i)>=0)return null;return p.find(t.get(),function(e){return e.id==i})}catch(e){return null}},goInvite:function(e){e.stopPropagation();var t=this.props,n=t.contact,i=t.joblist,o="",r=p.find(i.get(),function(e){return n.sent_resume_jids&&n.sent_resume_jids.indexOf(e.id)>=0});if(r)0==i.get().length||i.get().length>8?(this.goResume(r.id,n.id),o="select_job_view_resume"):(this.openInviteJobsSelection(),o="select_job_view_resume");else if(0==i.get().length)(0,l.showModalForConfirm)({title:"没有有效的职位可供邀请",ok:function(){window.MaiMai_Native.native_pub_job()},ok_text:"去发职位",cancel_text:"取消"}),o="no_job";else if(i.get().length>8)f("/invite_resume?"+d.stringify({ouid:n.ouid,fr:this.props.fr||"excellent"}),"邀请TA投递简历","fetch"),o="too_many_jobs";else{var s=this.getInviteJob();s?(this.openInviteResume(),o="msg_dialog"):(this.openInviteJobsSelection(),o="select_job")}this.pingAct("invite_show_"+o)},pingAct:function(e){var t=this.context,n=t.auth_info,o=t.fconf,r=this.props,a=r.contact,l=r.fr,c=o.online_url+"job/v3/ping_act?"+d.stringify(i({act:e,act_id:a.id,fr:l},n));fetch(c,{credential:"same-origin"}).then(s.parse_json_ignore_err)},openInviteResume:function(){var e=this.props.contact,t=this.getInviteJob(),n=this.openInviteJobsSelection,i=this.sendInvite;b("job_invite_msg",function(o){r.default.dismiss(),r.default.popup(c.createElement(v,{contact:e,invite_job:t,func:i,changeJob:n,invite_msg:o}))})},openInviteJobsSelection:function(){var e=this.props,t=e.contact,n=e.joblist;r.default.dismiss();var i=this,o=t.invited_jids,s=t.sent_resume_jids||[],a=p.map(n.get(),function(e){var n=e.position,i=null,r=null,a=2;return s.indexOf(e.id)>=0&&(r=t.show_invite_job_sel_more_btn||"查看简历>"),o.indexOf(e.id)>=0&&(i=t.show_invite_job_sel_disable_btn||"[已发邀请]"),t.profession==e.profession&&(a--,t.major==e.major&&a--),{id:e.id,uid:t.id,text:n,more:r,disable:i,diff:a}});a=p.sortBy(a,"diff"),a=p.filter(a,function(e){return!e.disable}).concat(p.filter(a,function(e){return e.disable}));r.default.popup(c.createElement(h,{title:"请选择职位",options:a,onSelected:function(e){var t=p.find(n.get(),function(t){return t.id==e});if(o.indexOf(t.id)>=0)return void alert("已经发送过该职位的邀请，您可以尝试其他职位。");_.set("job_invite_jid",t.id,{path:"/",expires:"2Y"}),i.openInviteResume()}}))},sendInvite:function(e){var t=this,n=this.props,o=n.my_member,l=n.contact,c=this.context,u=c.fconf,m=c.auth_info,p=l.invited_jids,h=this.getInviteJob();if(!h)return void g("请先选择职位");if(!e||0==e.trim().length)return void g("请填写邀请内容");if(e.length>150)return void g("邀请内容不能超过150字");if(p.indexOf(h.id)>=0)return void g("已经发送过该职位的邀请，您可以尝试其他职位。");if(r.default.dismiss(),1==o.mem_st&&o.req_resume_left>0){var _=u.online_url+"/job/v3/recommend/invite_anonymous?"+d.stringify(i({ouid:l.ouid,jid:h.id,text:e},m));fetch(_,{credentials:"same-origin"}).then(s.parse_online_json).then(function(e){console.log(JSON.stringify(e)),e.ok_msg?1==e.confirm?alert(e.ok_msg):g(e.ok_msg):g("职位邀请发送成功"),(0,a.sendWebViewBroadcast)("broadcast_zhaopin_job_invite",{ouid:l.ouid,jid:h.id})}).catch(function(){t.startCheckBindWx()}),this.pingAct("send_invite_ok")}else f("/uh_memlist?"+d.stringify({tpl:"invite_resume",fr:"anonymous_resume_invite"}),"会员中心","fetch"),this.pingAct("invite_send_not_member")},goResume:function(e,t){f("/resume?"+d.stringify({uid2:t,jid:e,from:"zhaopin_index_job_select_option"}),"简历详情","fetch")},goAnonymousResume:function(e){e.stopPropagation();var t=this.props.contact;t&&1!=t.disable_anonymous_resume&&f("/anonymous_resume?"+d.stringify({ouid:t.ouid,show_uh_chat:1,fr:this.props.fr||"excellent"}),"简历详情","fetch")},nullFuc:function(e){e.stopPropagation()},render:function(){var e=this.props,t=e.contact,n=e.cursor,i=e.joblist,o=void 0;t.large_comps.length>0&&(o=c.createElement("div",{className:"iSay"},c.createElement("p",null,c.createElement("nobr",null,"- 曾任职于: ",c.createElement("span",{style:{color:"#ff8d00"}},t.large_comps)),t.large_school&&t.large_school.length>0&&c.createElement("span",null,c.createElement("br",null),"- 曾就读于: ",c.createElement("span",{style:{color:"#ff8d00"}},t.large_school)),t.tags&&t.tags.length>0&&c.createElement("span",null,c.createElement("br",null),"- 技能标签: ",t.tags))));var r=void 0;if(t.show_invite){var s=p.find(i.get(),function(e){return t.sent_resume_jids&&t.sent_resume_jids.indexOf(e.id)>=0}),a=t.show_invited_btn||"再次邀请",l="fast_disable_btn";s&&(a="查看简历",l="fast_click_green_btn"),r=0==n.select("is_invited").get()?c.createElement("div",{className:"fast_click_btn",style:j.noPaddingRight,onClick:this.goInvite},t.show_invite_btn||"邀请投递"):c.createElement("div",{className:l,style:j.noPaddingRight,onClick:this.goInvite},a)}else r=0==n.select("is_fc").get()?c.createElement("div",{className:"fast_click_btn",style:j.noPaddingRight,onClick:this.goUhchat},"极速联系"):c.createElement("div",{className:"fast_disable_btn",style:j.noPaddingRight,onClick:this.nullFuc},"已联系过");return c.createElement("div",{style:{paddingBottom:"10px",backgroundColor:"#efeff4"},onClick:this.goAnonymousResume},c.createElement(m,{contact:t,hideDist:!0,openMyMember:this.props.openMyMember,custom_avatar_class:t.show_invite&&"contact_avatar_blur",onClick:function(){}},r),o)}})),j={done:{marginTop:6,height:40,lineHeight:"40px",verticalAlign:"middle",backgroundColor:"#efefef"},buttons:{marginTop:6,height:40},button:{display:"inline-block",width:"50%",paddingLeft:4,paddingRight:4},noPaddingRight:{marginRight:"-10px",marginTop:"6px"}};e.exports=y},1564:function(e,t,n){"use strict";var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},o=n(77),r=function(e){return e&&e.__esModule?e:{default:e}}(o),s=n(75),a=n(113),l=n(167),c=n(1),u=n(41),f=(n(50),n(46)),d=n(15),m=n(270),p=n(17),h=n(1048),_=n(172),g=n(76),v=n(1100),b=n(164).getCache,y=(n(164).putCache,c.createClass({displayName:"ExcellentContactItemCardV2",mixins:[u],contextTypes:{fconf:c.PropTypes.object,auth_info:c.PropTypes.object,req:c.PropTypes.object},pingAct:function(e){var t=this.context,n=t.auth_info,o=t.fconf,r=this.props,a=r.contact,l=r.fr,c=o.online_url+"job/v3/ping_act?"+d.stringify(i({act:e,act_id:a.id,fr:l||"excellent_v2"},n));fetch(c,{credential:"same-origin"}).then(s.parse_json_ignore_err)},getInviteJob:function(){var e=this.props,t=e.joblist,n=e.contact;try{var i=parseInt(_.get("job_invite_jid"));if(i>0&&n.invited_jids&&n.invited_jids.indexOf(i)>=0)return null;return p.find(t.get(),function(e){return e.id==i})}catch(e){return null}},goInvite:function(e){e.stopPropagation();var t=this.props,n=t.contact,i=t.joblist,o="";if(p.find(i.get(),function(e){return n.sent_resume_jids&&n.sent_resume_jids.indexOf(e.id)>=0}))MaiMai_Native.native_chat&&MaiMai_Native.native_chat("",n.id);else if(0==i.get().length)(0,l.showModalForConfirm)({title:"没有有效的职位可供邀请",ok:function(){window.MaiMai_Native.native_pub_job()},ok_text:"去发职位",cancel_text:"取消"}),o="no_job";else if(i.get().length>8)f("/invite_resume?"+d.stringify({ouid:n.ouid,fr:this.props.fr||"excellent"}),"邀请TA投递简历","fetch"),o="too_many_jobs";else{var r=this.getInviteJob();r?(this.openInviteResume(),o="msg_dialog"):(this.openInviteJobsSelection(),o="select_job")}this.pingAct("invite_show_"+o)},openInviteResume:function(){var e=this.props.contact,t=this.getInviteJob(),n=this.openInviteJobsSelection,i=this.sendInvite;b("job_invite_msg",function(o){r.default.dismiss(),r.default.popup(c.createElement(v,{contact:e,invite_job:t,func:i,changeJob:n,invite_msg:o}))})},openInviteJobsSelection:function(){var e=this.props,t=e.contact,n=e.joblist;r.default.dismiss();var i=this,o=t.invited_jids,s=t.sent_resume_jids||[],a=p.map(n.get(),function(e){var n=e.position,i=null,r=null,a=2;return s.indexOf(e.id)>=0&&(r=t.show_invite_job_sel_more_btn||"查看简历>"),o.indexOf(e.id)>=0&&(i=t.show_invite_job_sel_disable_btn||"[已发邀请]"),t.profession==e.profession&&(a--,t.major==e.major&&a--),{id:e.id,uid:t.id,text:n,more:r,disable:i,diff:a}});a=p.sortBy(a,"diff"),a=p.filter(a,function(e){return!e.disable}).concat(p.filter(a,function(e){return e.disable}));r.default.popup(c.createElement(h,{title:"请选择职位",options:a,onSelected:function(e){var t=p.find(n.get(),function(t){return t.id==e});if(o.indexOf(t.id)>=0)return void alert("已经发送过该职位的邀请，您可以尝试其他职位。");_.set("job_invite_jid",t.id,{path:"/",expires:"2Y"}),i.openInviteResume()}}))},sendInvite:function(e){var t=this,n=this.props,o=n.my_member,l=n.contact,c=this.context,u=c.fconf,m=c.auth_info,p=l.invited_jids,h=this.getInviteJob();if(!h)return void g("请先选择职位");if(!e||0==e.trim().length)return void g("请填写邀请内容");if(e.length>150)return void g("邀请内容不能超过150字");if(p.indexOf(h.id)>=0)return void g("已经发送过该职位的邀请，您可以尝试其他职位。");if(r.default.dismiss(),1==o.mem_st&&o.req_resume_left>0){var _=u.online_url+"/job/v3/recommend/invite_anonymous?"+d.stringify(i({ouid:l.ouid,jid:h.id,text:e},m));fetch(_,{credentials:"same-origin"}).then(s.parse_online_json).then(function(e){console.log(JSON.stringify(e)),e.ok_msg?1==e.confirm?alert(e.ok_msg):g(e.ok_msg):g("职位邀请发送成功"),(0,a.sendWebViewBroadcast)("broadcast_zhaopin_job_invite",{ouid:l.ouid,jid:h.id})}).catch(function(){t.startCheckBindWx()}),this.pingAct("send_invite_ok")}else f("/uh_memlist?"+d.stringify({tpl:"invite_resume",fr:"anonymous_resume_invite"}),"会员中心","fetch"),this.pingAct("invite_send_not_member")},goDetail:function(e){e.stopPropagation();var t=this.props,n=t.contact,i=t.fr,o=this.getInviteJob();if(n){var r={fr:i||"excellent_v2",from:i||"excellent_v2"};o&&(r.uh_jid=o.id),f("/contact/detail/"+n.id+"?"+d.stringify(r),"人脉详情","fetch")}},nullFuc:function(e){e.stopPropagation()},render:function(){var e=this.props,t=e.contact,n=e.cursor,i=e.joblist,o=void 0;t.large_comps.length>0&&(o=c.createElement("div",{className:"iSay"},c.createElement("p",null,c.createElement("nobr",null,"- 曾任职于: ",c.createElement("span",{style:{color:"#ff8d00"}},t.large_comps)),t.large_school&&t.large_school.length>0&&c.createElement("span",null,c.createElement("br",null),"- 曾就读于: ",c.createElement("span",{style:{color:"#ff8d00"}},t.large_school)),t.tags&&t.tags.length>0&&c.createElement("span",null,c.createElement("br",null),"- 技能标签: ",t.tags))));var r=void 0,s=p.find(i.get(),function(e){return t.sent_resume_jids&&t.sent_resume_jids.indexOf(e.id)>=0}),a=t.show_invited_btn||"再次邀请",l="fast_disable_btn";return s&&(a="查看回复",l="fast_click_green_btn"),r=0==n.select("is_invited").get()?c.createElement("div",{className:"fast_click_btn",style:j.noPaddingRight,onClick:this.goInvite},t.show_invite_btn||"邀请投递"):c.createElement("div",{className:l,style:j.noPaddingRight,onClick:this.goInvite},a),c.createElement("div",{style:{paddingBottom:"10px",backgroundColor:"#efeff4"},onClick:this.goDetail},c.createElement(m,{contact:t,hideDist:!0,openMyMember:this.props.openMyMember,onClick:this.goDetail},r),o)}})),j={done:{marginTop:6,height:40,lineHeight:"40px",verticalAlign:"middle",backgroundColor:"#efefef"},buttons:{marginTop:6,height:40},button:{display:"inline-block",width:"50%",paddingLeft:4,paddingRight:4},noPaddingRight:{marginRight:"-10px",marginTop:"6px"}};e.exports=y},907:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a,l,c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),f=n(1),d=i(f),m=n(75),p=n(15),h=i(p),_=n(46),g=i(_),v=n(165),b=i(v),y=n(996),j=i(y),x=n(283),k=n(1186),w=i(k),E=n(1564),C=i(E),T=n(113),P=(n(270),n(982)),q=n(63),F=n(990),O=n(1009),I=n(17);n(76);t.default=e.exports=(l=a=function(e){function t(){var e,n,i,s;o(this,t);for(var a=arguments.length,l=Array(a),c=0;c<a;c++)l[c]=arguments[c];return n=i=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),i.state={sel_cnt:0,is_batch:0,sel_uids:{}},i.getChildContext=function(){return q.getChildContext(i)},i.loadMore=function(){var e=i.props.cursor;i.refs.loader.bindRequest(function(){return t.loadFilteredData(i.context,i.nextPage,i.query,i.profession,i.major,i.province,i.city,i.workTime).then(function(t){i.nextPage++;var n=t.data;e.select("userlist").concat(n.userlist),e.select("remain").set(n.remain)})})},i.onReload=function(){i.query&&i.query.length>0&&i.searchContent(i.query)},i.searchContent=I.throttle(function(e){var n=this,i=this.props.cursor;this.context.req;return i.merge({loading:"loading",failed:!1,userlist:[],remain:0}),this.nextPage=0,t.loadFilteredData(this.context,this.nextPage,e,this.profession,this.major,this.province,this.city,this.workTime).then(function(t){n.nextPage++,n.query==e&&i.merge(I.extend(t.data,{loading:null}))}).catch(function(t){n.query==e&&i.merge({failed:!0})})},1e3),i.searchCallback=function(e){var t=JSON.parse(e);this.nextPage=1,this.query&&this.query==t.keyword||(this.query=t.keyword,0==t.keyword.length&&this.props.cursor.merge({userlist:void 0,loading:null,hotwords:void 0}),this.searchContent(this.query))},i.toggleLocsFilter=function(){var e=i.props.cursor.select("locsFilter","close").get();i.props.cursor.select("locsFilter","close").set(!e),i.props.cursor.select("pfmjsFilter","close").set(!0),i.props.cursor.select("workTimeFilter","close").set(!0)},i.togglePfmjsFilter=function(){var e=i.props.cursor.select("pfmjsFilter","close").get();i.props.cursor.select("pfmjsFilter","close").set(!e),i.props.cursor.select("locsFilter","close").set(!0),i.props.cursor.select("workTimeFilter","close").set(!0)},i.toggleWorkTimeFilter=function(){var e=i.props.cursor.select("workTimeFilter","close").get();i.props.cursor.select("workTimeFilter","close").set(!e),i.props.cursor.select("pfmjsFilter","close").set(!0),i.props.cursor.select("locsFilter","close").set(!0)},i.onSelectLoc=function(e,t){if(e!=i.selectedLoc.province||t!=i.selectedLoc.city){i.selectedLoc.province=e,i.selectedLoc.city=t,i.province=e>0?i.locs[e].name:"",i.city=t>0?i.locs[e].items[t].name:"";var n=i.context.req;i.query=i.query||n.query.query,i.searchContent(i.query)}},i.onSelectedPfmj=function(e,t){if(e!=i.selectedPfmj.profession||t!=i.selectedPfmj.major){i.selectedPfmj.profession=e,i.selectedPfmj.major=t,i.profession=e>=0?i.pfmjs[e].name:"",i.major=t>=0?i.pfmjs[e].items[t].name:"";var n=i.context.req;i.query=i.query||n.query.query,i.searchContent(i.query)}},i.onSelectedWorkTime=function(e,t){if(e!=i.selectedWorkTime.workTime){i.selectedWorkTime.workTime=e,i.workTime=e>=0?i.workTimes[e].name:"";var n=i.context.req;i.query=i.query||n.query.query,i.searchContent(i.query)}},i.onCancelSelectLoc=function(){i.props.cursor.select("locsFilter","parent").set(i.selectedLoc.province),i.props.cursor.select("locsFilter","child").set(i.selectedLoc.city)},i.onCancelSelectPfmj=function(){i.props.cursor.select("pfmjsFilter","parent").set(i.selectedPfmj.profession),i.props.cursor.select("pfmjsFilter","child").set(i.selectedPfmj.major)},i.onCancelSelectWorkTime=function(){i.props.cursor.select("workTimeFilter","parent").set(i.selectedWorkTime.workTime)},i.openMyMember=function(e){e.stopPropagation(),(0,g.default)("/uh_memlist?tpl=show&fr=jobs_exec","会员权益","fetch")},i.renderFilter=function(){if(i.context.req.query.talent)return d.default.createElement("div",null);var e=(i.province||"")+(i.city||""),t="first highlight";e||(e="全部城市",t+="first");var n=(i.profession||"")+(i.major||""),o="second highlight";n||(n="全部行业",o+="second");var r=i.workTime||"",s="third highlight";return r||(r="全部年限",s+="third"),d.default.createElement("div",null,d.default.createElement("div",{className:"searchFilter"},d.default.createElement("div",{className:t,onClick:i.toggleLocsFilter},d.default.createElement("span",null,e)),d.default.createElement("div",{className:o,onClick:i.togglePfmjsFilter},d.default.createElement("span",null,n)),d.default.createElement("div",{className:s,onClick:i.toggleWorkTimeFilter},d.default.createElement("span",null,r))),d.default.createElement(O,{cursor:i.props.cursor.select("locsFilter"),items:i.locs,onSelect:i.onSelectLoc,onCancel:i.onCancelSelectLoc}),d.default.createElement(O,{cursor:i.props.cursor.select("pfmjsFilter"),items:i.pfmjs,onSelect:i.onSelectedPfmj,onCancel:i.onCancelSelectPfmj}),d.default.createElement(O,{cursor:i.props.cursor.select("workTimeFilter"),items:i.workTimes,onSelect:i.onSelectedWorkTime,onCancel:i.onCancelSelectWorkTime,single:!0}))},i.renderHeadLoader=function(){return d.default.createElement("div",null,i.renderFilter(),d.default.createElement("div",{className:"searchList"},d.default.createElement(b.default,{ref:"loading",reload:i.onReload,failed:i.props.failed})))},i.renderEmptyResult=function(){var e=i.query||i.context.req.query.query;return d.default.createElement("div",null,i.renderFilter(),e&&d.default.createElement("div",{className:"searchList",style:F.empty},"没有找到相关结果"),!e&&d.default.createElement("div",{className:"searchList",style:F.empty},"请输入搜索词"))},i.singleCB=function(e){i.setState({sel_cnt:i.state.sel_cnt+1}),i.state.sel_uids[e]=1},s=n,r(i,s)}return s(t,e),u(t,[{key:"componentWillMount",value:function(){if("undefined"!=typeof window){this.locs=x.cst.loc.map(function(e){var t=e.cities.map(function(e){return{name:e.city}});return t.unshift({name:"全部"}),{name:e.province,items:t}}),this.locs.unshift({name:"全部",items:[{name:"全部"}]}),this.pfmjs=x.cst.pfmj.map(function(e){var t=e.majors.map(function(e){return{name:e.name}});return t.unshift({name:"全部"}),{name:e.name,items:t}}),this.pfmjs.unshift({name:"全部",items:[{name:"全部"}]}),this.workTimes=t.WORK_TIMES.map(function(e){return{name:e,items:[]}}),this.workTimes.unshift({name:"全部",items:[]});var e=this.context.req;this.query=e.query.query,this.province=e.query.province,this.city=e.query.city,this.profession=e.query.profession,this.major=e.query.major,this.workTime=e.query.wt;var n=this.province&&I.findIndex(this.locs,{name:this.province}),i=this.city&&(n>0?I.findIndex(this.locs[n].items,{name:this.city}):-1);n>=0?i=i>0?i:0:(n=0,i=-1);var o=this.profession&&I.findIndex(this.pfmjs,{name:this.profession}),r=this.major&&(o>0?I.findIndex(this.pfmjs[o].items,{name:this.major}):-1);o>=0?r=r>0?r:0:(o=0,r=-1);var s=this.workTime&&I.findIndex(this.workTimes,{name:this.workTime});this.selectedLoc={province:n,city:i},this.selectedPfmj={profession:o,major:r},this.selectedWorkTime={workTime:s},this.props.cursor.merge({locsFilter:{parent:n,child:i,close:!0},pfmjsFilter:{parent:o,child:r,close:!0},workTimeFilter:{parent:s,close:!0}})}}},{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.cursor,i=t.user;if(this.nextPage=1,(0,T.bindBroadcast)("broadcast_zhaopin_job_invite",function(e){if(e&&(e.uid>0||e.ouid>0)){var t=e.uid,i=e.ouid,o=e.jid,r=n.select("userlist").get(),s=n.select("canditates").get();void 0!=r&&r.map(function(e,r){if((t==e.id||i==e.ouid)&&(n.select("userlist",r,"is_invited").set(1),n.select("member","req_resume_left").set(n.select("member","req_resume_left").get()-1),o)){var s=n.select("userlist",r,"invited_jids").get();void 0!=s&&s.push(o)}}),void 0!=s&&s.map(function(e,o){t!=e.id&&i!=e.ouid||n.select("canditates",o,"is_invited").set(1)})}}),window.search_callback=this.searchCallback.bind(this),void 0!=i&&i.pf&&i.pf.length>0){this.profession=i.pf;var o=this.profession&&I.findIndex(this.pfmjs,{name:this.profession}),r=0;void 0!=i.mj&&i.mj&&i.mj.length>0&&(this.major=i.mj,r=this.major&&(o>0?I.findIndex(this.pfmjs[o].items,{name:this.major}):-1)),n.merge({pfmjsFilter:{parent:o,child:r,close:!0}})}(0,T.bindBroadcast)("broadcast_fc_send_ok",function(t){if(!(e.state.sel_cnt<=0)){n.select("userlist").get().map(function(t,i){for(var o in e.state.sel_uids)o==t.uid&&n.select("userlist",i,"is_fc").set(1)}),e.setState({sel_cnt:0}),e.setState({sel_uids:{}})}}),(0,T.bindBroadcast)("broadcast_web_pay_suc",function(t){var i=e.context,o=i.auth_info,r=i.fconf,s=JSON.parse(t);if(void 0!==s.apptype&&"uh_memdeal"==s.apptype){var a=r.online_url+"/talent/v3/uh/get_memlist?"+h.default.stringify(c({},o));fetch(a,{credential:"same-origin"}).then(m.parse_online_json).then(function(e){e&&e.mem_info&&n.merge({member:e.mem_info.member})})}})}},{key:"componentWillUnmount",value:function(){window.search_callback=null}},{key:"render",value:function(){var e=this,t=this.props,n=t.userlist,i=t.cursor,o=t.member,r=t.remain,s=this.context,a=s.req,l=s.auth_info;return this.props.loading||this.props.failed?this.renderHeadLoader():0==n.length?this.renderEmptyResult():d.default.createElement("div",null,this.renderFilter(),d.default.createElement("div",{className:"searchList"},n.length>0||d.default.createElement(j.default,{tips:"暂时没有推荐人才",onClick:function(){}}),i.select("workTimeFilter","close").get()&&i.select("locsFilter","close").get()&&i.select("pfmjsFilter","close").get()&&d.default.createElement(P,{loadMore:this.loadMore,hasMore:r>0&&l.u>0,loader:d.default.createElement(b.default,{ref:"loader",reload:this.loadMore,cursor:i.select("loading_status")})},d.default.createElement("div",{className:"panel panel-default"},d.default.createElement("ul",{className:"list-group"},n.map(function(t,n){return 2==t.card_version?d.default.createElement(C.default,{contact:t,key:t.ouid,from:"webview#/search/fc_sss",fr:a.query.fr||"excellent_v2",singleCB:e.singleCB,search:!0,cursor:i.select("userlist",n),member_icon:1==t.mem_st,my_member:o,joblist:i.select("valid_joblist"),openMyMember:e.openMyMember}):d.default.createElement(w.default,{contact:t,key:t.ouid,from:"webview#/search/fc_sss",fr:a.query.fr||"excellent",singleCB:e.singleCB,search:!0,cursor:i.select("userlist",n),member_icon:1==t.mem_st,my_member:o,joblist:i.select("valid_joblist"),openMyMember:e.openMyMember})}))))))}}],[{key:"loadData",value:function(e,n){return t.loadFilteredData(e,n,"","","","","","")}},{key:"loadFilteredData",value:function(e,t,n,i,o,r,s,a){var l=e.req,u=c({page:t,jsononly:1},l.query);void 0!=i&&i.length>0&&(u.pf=i),void 0!=o&&o.length>0&&(u.mj=o),void 0!=a&&a.length>0&&(u.wt=a),void 0!=r&&r.length>0&&(u.province=r),void 0!=s&&s.length>0&&(u.city=s),void 0!=n&&n.length>0&&(u.query=n);var f=l.pathname+"?"+h.default.stringify(u);return fetch(f,{credentials:"same-origin"}).then(m.parse_online_json)}}]),t}(d.default.Component),a.contextTypes={req:d.default.PropTypes.object,fconf:d.default.PropTypes.object,auth_info:d.default.PropTypes.object},a.childContextTypes=c({from:d.default.PropTypes.string},q.contentTypes),a.WORK_TIMES=["1年以内","1-3年","3-5年","5-10年","10年以上"],l)}});