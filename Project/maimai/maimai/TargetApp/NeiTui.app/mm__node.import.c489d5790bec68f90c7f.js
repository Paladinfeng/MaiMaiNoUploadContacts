webpackJsonp([134],{1061:function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a,s,c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),p=n(1),u=n(17),m=n(15),f=(n(985)("app"),n(273),n(991)),h=(n(46),n(75)),d=n(114),y=n(1001),g=n(41),v=n(281);t.default=e.exports=(s=a=function(e){function t(){var e,n,i,a;o(this,t);for(var s=arguments.length,l=Array(s),p=0;p<s;p++)l[p]=arguments[p];return n=i=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),i.vote=u.debounce(function(e){e.stopPropagation();var t,n=i.props,o=n.comment,r=n.listCursor,a=n.index,s=n.singleCursor,l=i.context,p=l.auth_info;l.fconf;if(p&&p.u&&!(p.u<0)){t=s?s.select("votes"):r.select("comments",a,"comment","votes");var u=i.my_vote_index(),f="/sdk/company/vote_comment?"+m.stringify(c({_id:o._id,vote:u>=0?"0":"1"},p)),y=fetch(f,{credentials:"same-origin"}).then(h.parse_online_json).then(function(e){u>=0?t.splice([u,1]):t.unshift(parseInt(p.u))}).catch(h.toast_error_handler);d("请求中",y)}},1e3,!0),i.deleteClicked=u.debounce(function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation();var t=i.context,n=t.auth_info;t.fconf;if(confirm("确定要删除点评吗？")){var o="/sdk/company/delete_comment?"+m.stringify(c({_id:i.props.comment._id},n)),r=fetch(o,{credentials:"same-origin"}).then(h.parse_online_json).then(function(e){i.props.listCursor&&i.props.listCursor.splice([i.props.index,1])}).catch(h.toast_error_handler);d("删除点评中",r)}},1e3,!0),a=n,r(i,a)}return i(t,e),l(t,[{key:"shouldComponentUpdate",value:function(e,t){return g.shouldComponentUpdate.apply(this,[e,t])}},{key:"my_vote_index",value:function(){var e=this.props.comment,t=this.context.auth_info;return e.votes.indexOf(parseInt(t.u))}},{key:"render",value:function(){var e=this.props,t=e.comment,n=e.user,o=e.cname,r=this.context.auth_info,i="有用 ";if(t.votes.length>0&&(i="有用 "+t.votes.length),this.my_vote_index()>=0)var a="/static/images/ding2.png";else var a="/static/images/ding1.png";var s=v(n)+"是"+o+"的"+t.relation;return 1==t.isAnonymous&&(s="TA是"+o+"的"+t.relation,n={},n.name=t.anonymousName,n.avatar=t.anonymousAvatar,n.judge=0,n.line1="",n.id=6),p.createElement("li",{className:this.props.className?this.props.className:"list-group-item",onClick:this.props.onClick},p.createElement(f,{user:n,article_line:s}),p.createElement("div",{style:_.body},p.createElement("div",{className:"media-heading m-l-lg text-content"},y(t.content)),p.createElement("div",{style:{height:"4px"}}),p.createElement("span",{className:"pull-right text-light small",onClick:this.vote},p.createElement("img",{style:_.like,src:a}),i),p.createElement("span",{className:"pull-right text-primary small",onClick:this.deleteClicked,style:_.delete},t.uid==r.u&&"删除")))}}]),t}(p.Component),a.contextTypes={auth_info:p.PropTypes.object,fconf:p.PropTypes.object},s);var _={heading:{marginTop:-10,marginLeft:-20,marginRight:-20},body:{marginTop:5,marginBottom:20},like:{marginTop:-5,width:15,height:15},delete:{marginRight:20},short_text:{WebkitLineClamp:"2",height:42,fontSize:14,lineHeight:"20px",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitBoxOrient:"vertical"}}},861:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}var r=n(988),i=(o(r),n(981)),a=o(i),s=n(1061),c=o(s),l=n(291),p=o(l),u=n(46),m=(o(u),n(1));n(15),n(985)("app"),n(50),n(75),n(114),n(113);e.exports=m.createClass({displayName:"exports",contextTypes:{req:m.PropTypes.object,auth_info:m.PropTypes.object},render:function(){var e=this.props.companyComment,t=this.props.card,n=this.props.cinfo,o=(this.onPub,this.context.auth_info,this.props.cursor.select("companyComment")),r="http://i9.taou.com/maimai/c/offlogo/"+n.logo;return m.createElement("div",null,m.createElement(a.default,{title:n.company}),m.createElement(p.default,{logo:r,name:n.company,line2:n.domain}),m.createElement(c.default,{key:e._id,comment:e,user:t,cname:n.company,singleCursor:o}))}})}});