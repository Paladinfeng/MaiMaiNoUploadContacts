webpackJsonp([27],{1087:function(e,t,s){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c,o,l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},h=function(){function e(e,t){for(var s=0;s<t.length;s++){var a=t[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,s,a){return s&&e(t.prototype,s),a&&e(t,a),t}}(),p=s(1),d=a(p),u=s(15),m=a(u);t.default=e.exports=(o=c=function(e){function t(){var e,s,a,n;r(this,t);for(var c=arguments.length,o=Array(c),h=0;h<c;h++)o[h]=arguments[h];return s=a=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),a.goExpDetial=function(e){var t=a.context,s=t.fconf,r=t.auth_info,i=a.props,n=i.tag,c=i.cinfo,o=i.id,h=s.online_url+"feed/v3/std_pingback?"+m.default.stringify(l({base:0,tag:n,cname:c.name,fid:o},r));fetch(h,{credentials:"same-origin"}),window.MaiMai_Native.native_feed_detail?window.MaiMai_Native.native_feed_detail(o):window.location.href=s.web_url+"web/feed_detail?fid="+o},n=s,i(a,n)}return n(t,e),h(t,[{key:"render",value:function(){var e=this.props,t=e.text,s=e.title,a=e.headClass,r=e.uinfo;return d.default.createElement("li",{className:"company_exp media "+(a||""),onClick:this.goExpDetial},r&&d.default.createElement("div",{className:"media-left media-top"},d.default.createElement("img",{src:r.avatar,className:"avatar-37 b-r-c"})),d.default.createElement("div",{className:"media-body p-t-8"},r&&d.default.createElement("span",{className:"font-15"}," ",r.name," "),d.default.createElement("span",{className:"exp_sign "+(r?"":"exp_sign_icon")}),d.default.createElement("h3",{className:"font-15 m-t-10 m-b-3 font-bold"},s),d.default.createElement("p",{className:"exp_text"},t)))}}]),t}(d.default.Component),c.contextTypes={auth_info:d.default.PropTypes.object,fconf:d.default.PropTypes.object},o)},1124:function(e,t,s){"use strict";var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},r=s(75),i=s(15),n=s(113);e.exports=function(e,t,s,c,o){return new Promise(function(l,h){window.MaiMai_Native.native_local_search_with_contacts?(n.unbindBroadcast("local_search_result"),n.bindBroadcast("local_search_result",function(t){console.log(t);var s=JSON.parse(t);if(s.searchKey==e)if(o){var n=o.fconf,c=o.auth_info,h=[];s.local_contacts.data.forEach(function(e){e.in_app=1,h.push(new Promise(function(t,s){var o=n.online_url+"talent/v3/uh/get_one_sentence?"+i.stringify(a({u2:e.id},c));fetch(o).then(r.parse_online_json).then(function(e){t(e)},s)}))});var p=Promise.all(h);p.then(function(e){s.local_contacts.data.forEach(function(t,a){return s.local_contacts.data[a].one_sentence=e[a].one_sentence}),l(s)})}else s.local_contacts.data.forEach(function(e){e.in_app=1}),l(s)}),window.MaiMai_Native.native_local_search_with_contacts(e,t,s,c)):window.MaiMai_Native.native_local_search?(n.unbindBroadcast("local_search_result"),n.bindBroadcast("local_search_result",function(t){var s=JSON.parse(t);s.searchKey==e&&l(s)}),window.MaiMai_Native.native_local_search(e,t,s)):l({})})}},1125:function(e,t,s){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},i=s(984),n=s(116),c=a(n),o=s(63),l=a(o),h=s(1),p=s(17),d=s(15),u=(s(985)("app"),s(117),s(991),s(90)),m=(s(75),s(41)),f=s(50);e.exports=h.createClass({displayName:"exports",mixins:[m],contextTypes:{auth_info:h.PropTypes.object,fconf:h.PropTypes.object,highlight_keys:h.PropTypes.arrayOf(h.PropTypes.string)},showTopicDetail:p.debounce(function(){var e=this.props.topic;f("/article/topic?id="+e.topic.id,"话题");var t=this.context,s=t.auth_info,a=t.fconf;if(e.topic.search_qs&&e.topic.search_order&&s.u>0){var i=a.online_url+"search/web/s_pb?"+d.stringify(r({srcu:s.u,type:"topic",targetid:e.topic.id,order:e.topic.search_order,qs:e.topic.search_qs},s));fetch(i)}},1e3,!0),renderFooter:function(){var e=this.props.topic,t="";if(t+=e.topic.feeds_count>0?e.topic.feeds_count+"个观点 ":"",t+=e.topic.feeds_active_count>0?e.topic.feeds_active_count+"个赞同 ":"",!e.contact)return h.createElement("div",{className:"text-muted small"},t&&h.createElement("span",{className:"pull-right"},t));var s=c.default.getCareer(e.contact);return s.length>=12&&(s=s.substr(0,11)+"..."),h.createElement("div",{className:"text-muted small"},e.contact&&l.default.mark(this,e.contact.name),e.contact&&h.createElement("span",null," · ",l.default.mark(this,s)),e.contact&&1==e.contact.judge&&h.createElement("span",{className:"add_v_img"}),t&&h.createElement("span",{className:"pull-right"},t))},render:function(){var e=this.props.topic;return h.createElement("li",{className:"list-group-item clearfix "+(this.props.xSpace?"p-x-"+this.props.xSpace:""),onClick:this.showTopicDetail},h.createElement("div",{className:"d-t-c"},h.createElement("div",{className:"list-group-item-text font-15 clearfix p-t-10"},h.createElement("div",{className:"media-heading"},h.createElement("p",{style:(0,i.textOverflow)(3)},h.createElement(u,{text:e.topic.title,support_dref:!0}))))),h.createElement("div",{className:"topicSearch"},h.createElement("div",{className:"media-body media-middle"},this.renderFooter())))}})},1126:function(e,t,s){"use strict";var a=s(1),r=s(46),i=s(15),n=a.createClass({displayName:"Search",contextTypes:{auth_info:a.PropTypes.object,req:a.PropTypes.object},componentDidMount:function(){document.body.style.background="#f6f6f6"},gotoSearchFeed:function(){r("/search/feeds?"+i.stringify({blank:"true",highlight:"true"}),"","fetch",{show_search_title:!0,search_hint:"搜索实名动态",search_focus:!1})},gotoSearchGossip:function(){r("/search/gossips?"+i.stringify({blank:"true",highlight:"true"}),"","fetch",{show_search_title:!0,search_hint:"搜索匿名交流",search_focus:!1})},gotoSearchContact:function(){r("/search/contacts_all?"+i.stringify({blank:"true",highlight:"true"}),"","fetch",{show_search_title:!0,search_hint:"搜索人脉",search_focus:!1})},gotoSearchJob:function(){window.MaiMai_Native.native_open_job_search?window.MaiMai_Native.native_open_job_search():r("/search/jobs?"+i.stringify({blank:"true",highlight:"true"}),"",{init_empty:1},{show_search_title:!0,search_hint:"搜索职位",search_focus:!0})},gotoSearchMeeting:function(){r("/search/meetings?"+i.stringify({blank:"true",highlight:"true"}),"",{init_empty:1},{show_search_title:!0,search_hint:"搜索活动",search_focus:!0})},gotoSearchTopic:function(){r("/search/topics?"+i.stringify({blank:"true",highlight:"true"}),"",{init_empty:1},{show_search_title:!0,search_hint:"搜索话题",search_focus:!0})},render:function(){return a.createElement("div",null,a.createElement("div",{className:"middleLineBox text-center",style:{background:"#f6f6f6",margin:"30px auto"}},a.createElement("div",{className:"middleLine"}),a.createElement("div",{className:"middleLineTxt",style:{background:"#f6f6f6"}},"在这里可以搜到")),a.createElement("div",{className:"searchIcons m-x clearfix"},a.createElement("div",{className:"searchItem m-b-10"},a.createElement("a",{href:"javascript:void(0)",onClick:this.gotoSearchJob},a.createElement("span",{className:"search_job_icon"})),a.createElement("p",{className:"text-muted small text-center"},"职位")),a.createElement("div",{className:"searchItem m-b-10"},a.createElement("a",{href:"javascript:void(0)",onClick:this.gotoSearchContact},a.createElement("span",{className:"search_renmai_icon"})),a.createElement("p",{className:"text-muted small text-center"},"找人")),a.createElement("div",{className:"searchItem m-b-10"},a.createElement("a",{href:"javascript:void(0)",onClick:this.gotoSearchFeed},a.createElement("span",{className:"search_feed_icon"})),a.createElement("p",{className:"text-muted small text-center"},"实名动态")),a.createElement("div",{className:"searchItem m-b-10"},a.createElement("a",{href:"javascript:void(0)",onClick:this.gotoSearchGossip},a.createElement("span",{className:"search_gossip_icon"})),a.createElement("p",{className:"text-muted small text-center"},"匿名交流")),a.createElement("div",{className:"searchItem m-b-10"},a.createElement("a",{href:"javascript:void(0)",onClick:this.gotoSearchTopic},a.createElement("span",{className:"search_topic_icon"})),a.createElement("p",{className:"text-muted small text-center"},"话题")),a.createElement("div",{className:"searchItem m-b-10"},a.createElement("a",{href:"javascript:void(0)",onClick:this.gotoSearchMeeting},a.createElement("span",{className:"search_meeting_icon"})),a.createElement("p",{className:"text-muted small text-center"},"活动"))))}});e.exports=n},696:function(e,t,s){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var r=s(1056),i=a(r),n=s(1007),c=a(n),o=s(1020),l=a(o),h=s(1087),p=a(h),d=s(17),u=s(15),m=(s(76),s(50)),f=s(46),g=s(1),_=s(273),y=s(270),v=s(1033),b=s(990),E=s(166),x=s(75),w=s(113),k=s(165),N=s(1124),C=s(63),j=s(986),M=s(271),S=s(1057),T=s(1125),K=s(291),O=s(1126),P=s(116),D=g.createClass({displayName:"everything",childContextTypes:C.contentTypes,contextTypes:{auth_info:g.PropTypes.object,req:g.PropTypes.object,fconf:g.PropTypes.object},getChildContext:function(){return C.getChildContext(this)},searchGossips:function(){f("/search/gossips?"+u.stringify({query:this.props.searchKey,searchTokens:JSON.stringify(this.props.searchTokens),highlight:"true"}),"更多八卦","fetch",{show_search_title:!0,search_keyword:this.props.searchKey,search_hint:"搜索八卦"})},searchFeeds:function(){f("/search/feeds?"+u.stringify({query:this.props.searchKey,searchTokens:JSON.stringify(this.props.searchTokens),highlight:"true"}),"更多动态","fetch",{show_search_title:!0,search_keyword:this.props.searchKey,search_hint:"搜索动态"})},searchArticles:function(){f("/search/articles?"+u.stringify({query:this.props.searchKey,searchTokens:JSON.stringify(this.props.searchTokens),highlight:"true"}),"更多行业头条","fetch",{show_search_title:!0,search_keyword:this.props.searchKey,search_hint:"搜索行业头条"})},searchTopics:function(){f("/search/topics?"+u.stringify({query:this.props.searchKey,searchTokens:JSON.stringify(this.props.searchTokens),highlight:"true"}),"更多问答","fetch",{show_search_title:!0,search_keyword:this.props.searchKey,search_hint:"搜索问答"})},searchJobs:function(){window.MaiMai_Native.native_search_jobs?window.MaiMai_Native.native_search_jobs(this.props.searchKey):f("/search/jobs?"+u.stringify({query:this.props.searchKey,searchTokens:JSON.stringify(this.props.searchTokens),highlight:"true"}),"更多职位","fetch",{show_search_title:!0,search_keyword:this.props.searchKey,search_hint:"搜索职位"})},searchServices:function(){f("/search/services?"+u.stringify({query:this.props.searchKey,searchTokens:JSON.stringify(this.props.searchTokens),highlight:"true"}),"更多服务","fetch",{show_search_title:!0,search_keyword:this.props.searchKey,search_hint:"搜索服务"})},searchMeetings:function(){f("/search/meetings?"+u.stringify({query:this.props.searchKey,searchTokens:JSON.stringify(this.props.searchTokens),highlight:"true"}),"更多活动","fetch",{show_search_title:!0,search_keyword:this.props.searchKey,search_hint:"搜索活动"})},moreExp:function(){var e=this.props.dataExp.cinfo.name||"",t=this.props.dataExp.cinfo.webcid;f("/company?"+u.stringify({webcid:t,tab:"comment",fr:"search_exp"}),e,"fetch")},searchContacts:function(){f("/search/contacts?"+u.stringify({query:this.props.searchKey,dist:3,searchTokens:JSON.stringify(this.props.searchTokens),me:1,highlight:"true",frm:"webview#/search/contacts"}),"更多人脉","fetch",{show_search_title:!0,search_keyword:this.props.searchKey,search_hint:"搜索人脉"})},searchD1Contacts:function(){f("/search/contacts?"+u.stringify({query:this.props.searchKey,dist:1,searchTokens:JSON.stringify(this.props.searchTokens),me:1,highlight:"true",frm:"webview#/search/contacts"}),"更多好友","fetch",{show_search_title:!0,search_keyword:this.props.searchKey,search_hint:"搜索好友"})},gotoAdvancedSearch:function(){f("/search/uh_adsearch_index?fr=search_adsearch_2","","fetch",{show_search_title:!0,search_hint:"请输入人名、职位、企业等关键字",search_focus:!1})},renderGossips:function(){if(this.props.gossips&&this.props.gossips.count&&0!=this.props.gossips.count)return g.createElement(M,{title:"匿名交流",headClass:"text-gray-7d p-x-20 p-t-12 p-b-5 gray-bg-f9"},this.props.gossips.gossips.map(function(e){e.gossip.summary||e.gossip.text;return g.createElement(v,{key:e.gossip.id,avatar:e.gossip.avatar,gossip:e,searchItem:!0,xSpace:20})}),function(){if(this.props.gossips.remain>0)return g.createElement(j,{onClick:this.searchGossips,title:"更多匿名交流 >>"})}.bind(this)())},renderFeeds:function(){if(this.props.feeds&&this.props.feeds.count&&0!=this.props.feeds.count)return g.createElement(M,{title:"实名动态",headClass:"text-gray-7d p-x-20 p-t-12 p-b-5 gray-bg-f9"},this.props.feeds.feeds.map(function(e){return g.createElement(S,{key:e.id,feed:e,searchItem:!0,xSpace:20})}),function(){if(this.props.feeds.remain>0)return g.createElement(j,{onClick:this.searchFeeds,title:"更多实名动态 >>"})}.bind(this)())},renderArticles:function(){if(this.props.articles&&this.props.articles.count&&0!=this.props.articles.count)return g.createElement(M,{title:"行业头条",headClass:"text-gray-7d p-x-20 p-t-12 p-b-5 gray-bg-f9"},this.props.articles.articles.map(function(e){return g.createElement(i.default,{key:e.fid,feed:e,xSpace:20})}),function(){if(this.props.articles.remain>0)return g.createElement(j,{onClick:this.searchArticles,title:"更多行业头条 >>"})}.bind(this)())},renderTopics:function(){if(this.props.topics&&this.props.topics.count&&0!=this.props.topics.count)return g.createElement(M,{title:"问答",headClass:"text-gray-7d p-x-20 p-t-12 p-b-5 gray-bg-f9"},this.props.topics.topics.map(function(e){return g.createElement(T,{key:e.topicid,topic:e,xSpace:20})}),function(){if(this.props.topics.remain>0)return g.createElement(j,{onClick:this.searchTopics,title:"更多问答 >>"})}.bind(this)())},renderServices:function(){if(this.props.services&&this.props.services.count&&0!=this.props.services.count)return g.createElement(M,{title:"服务",headClass:"text-gray-7d p-x-20 p-t-12 p-b-5 gray-bg-f9"},this.props.services.services.map(function(e){var t=P.getCareer(e.contact,""),s=e.service.unit_price+"    "+e.service.paynum+"人购买",a="发布人："+e.contact.name+(t?" | "+t:"");return g.createElement(_,{key:e.sid,avatar:e.contact.avatar,avatarRadius:!0,line1:e.service.title,line2:s,line3:a,judge3:e.contact.judge,clickHandler:m.bind(this,e.service.url,"服务详情"),xSpace:20})}),function(){if(this.props.services.remain>0)return g.createElement(j,{onClick:this.searchServices,title:"更多服务 >>"})}.bind(this)())},renderMeetings:function(){if(this.props.meetings&&this.props.meetings.count&&0!=this.props.meetings.count)return g.createElement(M,{title:"活动",headClass:"text-gray-7d p-x-20 p-t-12 p-b-5 gray-bg-f9"},this.props.meetings.meetings.map(function(e){var t=e.meeting.tags?"聚会标签："+e.meeting.tags:e.meeting.description,s="发起人："+e.contact.name;return g.createElement(_,{key:e.mid,avatar:e.contact.avatar,avatarRadius:!0,line1:e.meeting.subject,line2:t,line3:s,clickHandler:m.bind(this,e.meeting.share_url,"活动详情"),xSpace:20})}),function(){if(this.props.meetings.remain>0)return g.createElement(j,{onClick:this.searchMeetings,title:"更多活动 >>"})}.bind(this)())},renderDist1Contacts:function(){if(this.props.local_contacts&&this.props.local_contacts.data&&0!=this.props.local_contacts.data.length)return g.createElement(M,{title:"好友",headClass:"text-gray-7d p-x-20 p-t-12 p-b-5 gray-bg-f9"},this.props.local_contacts.data.map(function(e){var t=parseInt(e.mmid);return isNaN(t)?g.createElement(y,{key:e.mmid,contact:e,custom_avatar_class:"avatar-56 radius-50",xSpace:20,onClick:function(t){t.stopPropagation(),f("/contact/detail2/"+(e.encode_mmid||e.mmid),"人脉详情",{card:e})}}):g.createElement(y,{key:e.mmid,contact:e,custom_avatar_class:"avatar-56 radius-50",xSpace:20})}),function(){if(this.props.local_contacts.remain>0)return g.createElement(j,{onClick:this.searchD1Contacts,title:"更多好友 >>"})}.bind(this)())},renderContacts:function(){if(this.props.contacts&&this.props.contacts.count&&0!=this.props.contacts.count){var e=this.props,t=e.cursor,s=e.mycard,a=this.props.contacts.is_mmax;return g.createElement("div",null,g.createElement(M,{title:"人脉",headClass:"text-gray-7d p-x-20 p-t-12 p-b-5 gray-bg-f9"},this.props.contacts.contacts.map(function(e,r){return e.is_company?g.createElement(K,{logo:e.company.clogo,name:e.company.name,stdname:e.company.stdname,line2:e.company.line2,company_url:e.company.share_url,noBorderBottom:!0,xSpace:20,imgSize:"avatar-56"}):1!=e.contact.dist&&0!=e.contact.dist||1==a?e.contact.outofrel||1==a?g.createElement(l.default,{contact:e.contact,key:e.contact.id,from:"webview#/search/everything",cursor:t.select("contacts","contacts",r,"contact"),search:!0,mycard:s,custom_avatar_class:"avatar-56 radius-50",xSpace:20,is_mmax:a}):g.createElement(c.default,{contact:e.contact,key:e.contact.id,from:"webview#/search/everything",cursor:t.select("contacts","contacts",r,"contact"),search:!0,mycard:s,xSpace:20}):g.createElement(y,{key:e.contact.mmid,contact:e.contact,custom_avatar_class:"avatar-56 radius-50",xSpace:20})}),function(){if(this.props.contacts.remain>0)return g.createElement(j,{onClick:this.searchContacts,title:"更多人脉 >>"})}.bind(this)()),a&&g.createElement("ul",{className:"m-t-30 search_tel_tip"},g.createElement("li",null,"非会员搜索手机号上限每月5次"),g.createElement("li",null,"商务版会员搜索手机号上限每月15次"),g.createElement("li",null,"VIP版会员搜索手机号上限每月80次"),g.createElement("li",null,"招聘版会员搜索手机号每月上限200次")))}},openMessageOrDialog:function(e){1==e.dialogMatchCount?window.MaiMai_Native.native_start_chat(e.id,e.matchedDialogId):e.dialogMatchCount?window.MaiMai_Native.native_message_search_more(this.props.searchKey,2,e.id,e.name):window.MaiMai_Native.native_start_chat(e.id,-1)},renderMessages:function(){if(this.props.messages&&this.props.messages.data&&0!=this.props.messages.data.length)return g.createElement(M,{title:"聊天记录",headClass:"text-gray-7d p-x-20 p-t-12 p-b-5 gray-bg-f9"},this.props.messages.data.map(function(e){var t=this;return e.avatar&&0!=e.avatar.indexOf("file://")||(e.avatar="/static/images/default_group.png"),g.createElement(_,{key:e.id,avatar:e.avatar,avatarRadius:!0,line1:e.name+(e.infoText||""),judge1:e.judge,content:e.text,rightTopLabel:e.timeText,badge:e.badge,clickHandler:function(){t.openMessageOrDialog(e)},xSpace:20})},this),function(){var e=this;if(this.props.messages.remain>0)return g.createElement(j,{onClick:function(){window.MaiMai_Native.native_message_search_more(e.props.searchKey,2,-1,e.props.searchKey)},title:"更多聊天记录 >>"})}.bind(this)())},renderDialogs:function(){if(this.props.dialogs&&this.props.dialogs.data&&0!=this.props.dialogs.data.length)return g.createElement(M,{title:"群聊",headClass:"text-gray-7d p-x-20 p-t-12 p-b-5 gray-bg-f9"},this.props.dialogs.data.map(function(e){var t=this;return e.avatar&&0!=e.avatar.indexOf("file://")||(e.avatar="/static/images/default_group.png"),g.createElement(_,{key:e.id,avatar:e.avatar,avatarRadius:!0,line1:e.name,judge1:e.judge,content:e.text,rightTopLabel:e.timeText,badge:e.badge,clickHandler:function(){t.openMessageOrDialog(e)},xSpace:20})},this),function(){var e=this;if(this.props.dialogs.remain>0)return g.createElement(j,{onClick:function(){window.MaiMai_Native.native_message_search_more(e.props.searchKey,1,-1,e.props.searchKey)},title:"更多群聊 >>"})}.bind(this)())},renderJobs:function(){return this.props.jobs&&this.props.jobs.count&&0!=this.props.jobs.count?g.createElement(M,{title:"职位",headClass:"text-gray-7d p-x-20 p-t-12 p-b-5 gray-bg-f9"},this.props.jobs.jobs.map(function(e){return g.createElement(_,{key:e.job.id,avatar:e.job.clogo,line1:e.job.position,line2:e.job.area_1,line3:e.job.area_2,dist:e.job.user.dist<3&&e.job.user.dist,clickHandler:m.bind(this,e.job.share_url,"职位详情"),xSpace:20})}),g.createElement(j,{onClick:this.searchJobs,title:"更多职位 >>"})):g.createElement("div",null)},renderExp:function(){if(!this.props.dataExp||!this.props.dataExp.feeds||!this.props.dataExp.feeds.length)return g.createElement("div",null);var e=this.props.dataExp.feeds;return g.createElement("div",{className:"white-bg m-t-13 m-x-10 search_exp_warp"},g.createElement("ul",{className:"experience_search "+(1==e.length?"p-b":"")},g.createElement(p.default,{text:e[0].text,title:e[0].title,id:e[0].id,tag:this.props.dataExp.tag,cinfo:this.props.dataExp.cinfo,headClass:"search_exp"})),e.length>1&&g.createElement("div",{className:"more_exp white-bg",onClick:this.moreExp},"更多公司体验 >>"))},renderSearchBtn:function(){if(this.context.auth_info.u%5==3)return g.createElement("div",{className:"w-100 advanced_search",onClick:this.gotoAdvancedSearch},g.createElement("i",{className:"search_icon"}),g.createElement("span",null,"开启高级搜索 >>"))},onSearchKeyChanged:function(e){var t=JSON.parse(e);t.ptype=t.ptype||this.ptype,this.currentKey==t.keyword&&this.ptype==t.ptype||(this.props.cursor.merge({searchTokens:[t.keyword],loading_status:"loading",feeds:{},articles:{},gossips:{},jobs:{},topics:{},services:{},meetings:{},messages:{},dialogs:{},contacts:{},dataExp:{},local_contacts:{}}),this.currentKey=t.keyword,this.ptype=t.ptype,this.onRetryLoad())},onRetryLoad:function(){this.currentKey&&this.currentKey.length>0?this.searchContent(this.currentKey,this.ptype):this.props.cursor.merge({loading_status:null,rerender:!0})},searchContent:d.throttle(function(e,t){var s=this;if(this.currentKey==e&&this.ptype==t){this.props.cursor.merge({loading_status:"loading",complete:!1,feeds:{},articles:{},gossips:{},jobs:{},topics:{},services:{},meetings:{},messages:{},dialogs:{},contacts:{},dataExp:{},local_contacts:{}});var a=!1,r=!1,i=!1,n=!1,c="/sdk/search/get?"+u.stringify(d.extend({query:e,ptype:t,dist:this.newClient?3:0,frm:"webview#/search/everything"},this.context.auth_info)),o=function(){s.currentKey==e&&s.props.cursor.merge({complete:i&&a})};fetch(c).then(x.parse_online_json).then(function(t){if(s.currentKey==e){if(i=!0,!s.isResultEmpty(t))return void s.props.cursor.merge(d.extend(t,{loading_status:null}));a&&s.props.cursor.merge({loading_status:null})}}).catch(function(t){s.currentKey==e&&(n=!0,i=!0,a&&r&&s.props.cursor.merge({loading_status:"failed"}))}).then(o),N(e,3,3,3,this.context).then(function(t){if(s.currentKey==e){if(a=!0,!s.isResultEmpty(t))return void s.props.cursor.merge(d.extend(t,{loading_status:null}));r=!0,n?s.props.cursor.select("loading_status").set("failed"):i&&s.props.cursor.select("loading_status").set(null)}}).then(o)}},1e3),componentDidMount:function(){window.MaiMai_Native.native_local_search_with_contacts&&(this.newClient=!0),window.search_callback=this.onSearchKeyChanged,w.bindBroadcast("search_key_changed",this.onSearchKeyChanged);var e=this.context.req;this.ptype=e.query.ptype},componentWillUnmount:function(){window.search_callback=null,w.unbindBroadcast("search_key_changed",this.onSearchKeyChanged)},isResultEmpty:function(e){return!(e.jobs&&e.jobs.count||e.feeds&&e.feeds.count||e.contacts&&e.contacts.count||e.gossips&&e.gossips.count||e.local_contacts&&e.local_contacts.data&&0!=e.local_contacts.data.length||e.dialogs&&e.dialogs.data&&0!=e.dialogs.data.length||e.messages&&e.messages.data&&0!=e.messages.data.length)},render:function(){if(this.currentKey){if(this.props.loading_status)return g.createElement(k,{ref:"loader",reload:this.onRetryLoad,cursor:this.props.cursor.select("loading_status")});if(this.isResultEmpty(this.props))return g.createElement("div",{style:b.empty},"没有找到相关结果");var e=this.context.req;return"gossip"==e.query.ptype?this.props.complete?g.createElement("div",null,this.renderGossips(),this.renderFeeds(),this.renderArticles(),this.renderTopics(),this.renderDist1Contacts(),this.renderContacts(),this.renderJobs(),this.renderMessages(),this.renderDialogs(),!1,this.renderMeetings()):g.createElement("div",null,g.createElement(k,{ref:"loader",reload:this.onRetryLoad,cursor:this.props.cursor.select("loading_status")})):this.props.complete?"feed"==e.query.ptype?g.createElement("div",null,this.renderExp(),this.renderDist1Contacts(),this.renderContacts(),this.renderFeeds(),this.renderArticles(),this.renderTopics(),this.renderGossips(),this.renderJobs(),this.renderMessages(),this.renderDialogs(),!1,this.renderMeetings()):"contact"==e.query.ptype?g.createElement("div",null,this.renderDist1Contacts(),this.renderContacts(),this.renderMessages(),this.renderDialogs(),this.renderFeeds(),this.renderArticles(),this.renderTopics(),this.renderGossips(),this.renderJobs(),!1,this.renderMeetings()):g.createElement("div",null,this.renderDist1Contacts(),this.renderContacts(),this.renderJobs(),this.renderFeeds(),this.renderArticles(),this.renderTopics(),this.renderGossips(),this.renderMessages(),this.renderDialogs(),!1,this.renderMeetings()):g.createElement("div",null,this.renderDist1Contacts(),g.createElement(k,{ref:"loader",reload:this.onRetryLoad,cursor:this.props.cursor.select("loading_status")}))}return g.createElement(O,null)}});e.exports=E(D)}});