webpackJsonp([35],{1092:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},r=a(984),s=a(993),l=n(s),c=a(47),o=n(c),d=a(1),u=a(17),f=a(15),p=(a(985)("app"),a(991),a(90)),m=a(75),_=a(114),h=a(1004),v=a(41),y=a(115).launch_webview,g=a(46),b=(a(116),a(168)),E=a(999),x=a(1005),N=x.showInputPanel,w=x.clearInput,k=a(1014);e.exports=d.createClass({displayName:"exports",mixins:[v],contextTypes:{auth_info:d.PropTypes.object,fconf:d.PropTypes.object,env:d.PropTypes.object},getInitialState:function(){return{expand_txt:null,line_clamp:15,showInput:!1}},componentDidMount:function(){window.onInputFinished=x.onInputFinished,this.checkExpandTxt()},checkExpandTxt:function(){this.refs.txt.isTextOverflow()&&this.setState({expand_txt:"展开"})},getCoordinates:function(e){return o.default.findDOMNode(e).getBoundingClientRect().height},componentWillUnmount:function(){window.onInputFinished=null},showFeedDetail:u.debounce(function(){var e=this.props,t=e.feed,a=e.is_exp,n=this.context,r=n.auth_info,s=n.fconf,l=t.feed.text,c=l.length>250&&"operation_topic"!=t.feed.data_str;if(r.u>0){if(c&&!a?g("/article/detail?fid="+t.fid,"查看全文","fetch"):E(t.fid),t.feed.search_qs&&t.feed.search_order){var o=s.online_url+"search/web/s_pb?"+f.stringify(i({srcu:r.u,type:"feed",targetid:t.feed.id,order:t.feed.search_order,qs:t.feed.search_qs},r));fetch(o)}}else c&&!a?g("/article/detail?fid="+t.fid,"查看全文","fetch"):location.href="/web/feed_detail?fid="+t.fid},1e3,!0),like:function(e){var t=this;e.stopPropagation();var a=this.props,n=a.feed,r=a.cursor,s=this.context,l=s.auth_info,c=s.fconf;if(r&&l.u>0)try{var o=n.me_like;this.props.cursor.select("me_like").set(1==o?0:1);var d=n.feed.likes;this.props.cursor.select("feed","likes").set((1==o?-1:1)+d);var u=c.online_url+"feed/v3/like?"+f.stringify(i({fid:this.props.feed.fid,like:1==o?0:1},l));fetch(u).then(m.parse_online_json).catch(m.toast_error_handler).catch(function(e){t.props.cursor.select("me_like").set(o),t.props.cursor.select("feed","likes").set(d)})}catch(e){alert(e)}else l.u<0&&y()},gotoDetail:function(e){this.refs.avatar.gotoDetail(e)},spreadComment:function(e,t){var a=this,n=this.context,r=n.auth_info,s=n.fconf,l=this.props.feed,c="live_video_"+l.fid;if(!e)return void toast("回复内容不能为空");var o=new FormData;o.append("fid",l.fid),o.append("text",e),o.append("at_user_info",t);var d=s.online_url+"feed/v3/comment_spread?"+f.stringify(i({},r)),u=fetch(d,{method:"post",body:o}).then(m.parse_online_json).then(function(t){w(c),a.props.cursor.select("spread_feed","feed").set({summary:e})}).catch(m.toast_error_handler);_("请求中...",u)},reply:function(e){e.stopPropagation();var t=this.props.feed;if(window.MaiMai_Native.native_show_inputpanel){var a="live_video_"+t.fid,n=this.props.contact||t.contact;N("回复",a,this.spreadComment,"回复 "+n.name)}else this.replaceState({showInput:!this.state.showInput})},renderInputPanel:function(){if(this.context.env.from_pc){var e=this.props.feed,t=this.props.contact||e.contact,a="回复 "+t.name;return d.createElement("div",{className:this.state.showInput?"p-b":"hidden",style:{marginLeft:50},onClick:function(e){e.stopPropagation()}},d.createElement(h,{placeHolder:a,onClickSend:this.spreadComment,maxWord:250}))}},onExpandTxtClicked:function(e){e.stopPropagation(),"展开"==this.state.expand_txt?this.setState({expand_txt:null,line_clamp:0}):this.showFeedDetail()},renderExpandTxt:function(){var e=this.state.expand_txt,t=this.props.type;if(e)return d.createElement("div",{className:"text-primary liveReply "+(t?"":"text-center"),onClick:this.onExpandTxtClicked},e,t?"":d.createElement("span",{className:"more_down_icon p-relative",style:{marginLeft:5}}))},render:function(){var e=this.state.line_clamp,t=this.props,a=t.feed,n=t.reply,i=t.type,s=(t.author_card,t.is_exp),c=this.props.contact||a.contact,o=this.props.author_card&&0==this.props.author_card.dist&&this.props.author_card.id!=c.id&&!n&&0!=c.dist;return d.createElement("li",{className:"border-bottom-e0 list-unstyled p-y-20 clearfix ",onClick:this.showFeedDetail},d.createElement("div",{className:"media m-b-10"},d.createElement("div",{className:"media-left media-middle"},d.createElement(b,{ref:"avatar",customClass:"avatar-24 radius-50",card:c,image_id:this.props.image_id,onClick:this.gotoDetail})),d.createElement("div",{className:"media-body media-middle"},d.createElement("div",{className:"lineClamp1 text-muted "+(i?"font-14 text-gray-7d":"")},d.createElement("span",{onClick:this.gotoDetail},c.name),1==c.judge&&d.createElement("span",{className:"add_v_img"}),1==c.mem_st&&k.renderMember(c.mem_id))),d.createElement("div",{className:"media-right media-middle text-right p-l-0"},this.props.cursor&&d.createElement("div",{style:{width:"60px"},className:"p-r-20 "+(a.me_like?"red_heart_icon":"gray_heart_icon")+(i?" font-12 text-gray-808393":""),onClick:this.like},a.feed.likes>0&&a.feed.likes),d.createElement("div",{style:{width:"50px",display:"none"}},this.props.cursor&&d.createElement("img",{src:a.me_like?"/static/images/ding2.png":"/static/images/ding1.png",style:C.img}),d.createElement("span",{className:"text-light small"}," ",a.feed.likes>0&&a.feed.likes)))),d.createElement("div",{className:"m-b-10 "+(s?"exp_topic_title":""),style:e>0?(0,r.textOverflow)(e):null},d.createElement(l.default,{ref:"txt",text:a.feed.summary||a.feed.richtext||a.feed.text})),this.renderExpandTxt(),o&&d.createElement("span",{className:"text-primary liveReply",onClick:this.reply},"回复"),this.props.children,n&&d.createElement("div",{className:"gray-bg-f9 p-x-10 p-y-10"},d.createElement("div",{className:"media-body media-middle font-13 text-muted"},d.createElement("span",null,n.contact.name),"回复:",d.createElement(p,{text:n.feed.summary||n.feed.richtext||n.feed.text,support_dref:!0}))),o&&this.renderInputPanel())}});var C={heading:{marginTop:-10,marginLeft:-20,marginRight:-20},like:{marginBottom:3},avatarSize:{width:42,height:42,WebkitBorderRadius:"2px"},img:{width:"14px",height:"14px",marginBottom:"4px"},tableCell:{display:"table-cell"},zanBox:{display:"table-cell",textAlign:"center",verticalAlign:"middle",width:50}}},1138:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},c=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),o=a(1),d=n(o),u=a(15),f=n(u),p=a(75),m=n(p),_=a(1092),h=n(_),v=a(1008),y=n(v),g=a(986),b=n(g),E=a(46),x=n(E),N=a(290),w=n(N),k=a(1093),C=n(k),T=a(1017),j=n(T),O=a(1056),P=n(O),S=a(115),M=a(114),F=n(M),q=function(e){function t(){var e,a,n,s;i(this,t);for(var c=arguments.length,o=Array(c),d=0;d<c;d++)o[d]=arguments[d];return a=n=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),n.more_topic=function(){var e=n.context.req;(0,x.default)("/article/topic_relative?"+f.default.stringify({id:e.query.id}),"更多问答","fetch")},n.article_all=function(){var e=n.context.req;(0,x.default)("/article/topic_article_relative?"+f.default.stringify({id:e.query.id}),"更多专栏","fetch")},n.topic_more=function(){var e=n.context,t=e.req,a=e.auth_info,i=n.props,r=i.cursor,s=i.feeds,c=i.topicid;r.select("content_status").set("loading");var o="/sdk/article/topic_more?"+f.default.stringify(l({id:t.query.id||c,start:s.length,count:40},a)),d=fetch(o,{credentials:"same-origin"}).then(m.default.parse_online_json).then(function(e){r.select("feeds").concat(e.feeds),r.select("more").set(e.more),r.select("content_status").set(null)}).catch(function(e){r.select("content_status").set(null),m.default.toast_error_handler(e)});(0,F.default)("加载中..",d)},s=a,r(n,s)}return s(t,e),c(t,[{key:"renderContent",value:function(){var e=this,t=this.props,a=t.feeds,n=t.content_status,i=t.feeds_count,r=t.more,s=t.tag_datas,l=t.text,c=1==r&&i>a.length&&!n,o=l||"回答",u="loading"==n;return d.default.createElement("div",null,i>0&&d.default.createElement("div",{className:"font-16 p-t p-b-5 p-x-20 bg-F3F6F7"},"全部",i,"条",o),d.default.createElement("ul",{key:"content-2",className:"list-group m-b-0 topic_contentB bg-F3F6F7"},a.map(function(t,a){var n=null;return e.props.author_card&&t.spread_feed&&(n=t.spread_feed,n.contact=e.props.author_card),d.default.createElement(h.default,{key:t.fid,feed:t,type:"topicB",is_exp:!!s.render_info,reply:n,author_card:t.contact,cursor:e.props.cursor.select("feeds",a)},d.default.createElement(y.default,{class:"topic_feedlistB",images:t.feed.pics,max_count:3,type_multi:!0}))}),c&&d.default.createElement(b.default,{onClick:this.topic_more},d.default.createElement("span",null,"更多",o),d.default.createElement("span",{className:"more_down_icon p-relative",style:{marginLeft:5}})),u&&d.default.createElement("div",{dangerouslySetInnerHTML:{__html:(0,w.default)()}})))}},{key:"renderRelateArticle",value:function(){var e=this.props.re_articles;if(e&&e.articles.length>0)return[d.default.createElement("div",{key:"relete-3",className:"panel-heading p-x-20 p-t p-b-5 bg-F3F6F7"},d.default.createElement("span",{className:"text-black-3 font-16"},"相关专栏")),d.default.createElement("ul",{key:"relete-4",className:"list-group re_articlesB m-b-0"},e.articles.map(function(e){return d.default.createElement(C.default,{key:e.id,feed:e})}),e.more>0&&d.default.createElement(b.default,{onClick:this.article_all},d.default.createElement("span",null,"更多专栏"),d.default.createElement("span",{className:"more_down_icon p-relative",style:{marginLeft:5}})))]}},{key:"renderRelateTopic",value:function(){if(this.props.re&&this.props.re.length>0)return[d.default.createElement("div",{key:"relete-1",className:"panel-heading p-x-20 p-t p-b-5 bg-F3F6F7"},d.default.createElement("span",{className:"text-black-3 font-16"},"相关问答")),d.default.createElement("ul",{key:"relete-2",className:"list-group re_topicB m-b-0"},this.props.re.map(function(e){return d.default.createElement(j.default,{key:e.id,topic:e,type:"topicB"})}),d.default.createElement(b.default,{onClick:this.more_topic},d.default.createElement("span",null,"更多问答"),d.default.createElement("span",{className:"more_down_icon p-relative",style:{marginLeft:5}})))]}},{key:"renderHotTopic",value:function(){if(this.props.hot&&this.props.hot.length>0)return[d.default.createElement("div",{key:"hot-1",className:"panel-heading p-x-20 p-t p-b-5 bg-F3F6F7"},d.default.createElement("span",{className:"text-black-3 font-16"},"热门问答")),d.default.createElement("ul",{key:"hot-2",className:"list-group hot_topicB m-b-0"},this.props.hot.map(function(e){return d.default.createElement(j.default,{key:e.id,topic:e,hideTag:!0})}),d.default.createElement(b.default,{onClick:function(){return(0,S.launch_webview)()}},d.default.createElement("span",null,"更多热门问答"),d.default.createElement("span",{className:"more_down_icon p-relative",style:{marginLeft:5}})))]}},{key:"renderHotArticle",value:function(){var e=this.context.auth_info;if(this.props.hot_article&&this.props.hot_article.length>0)return[d.default.createElement("div",{key:"relete-article",className:"panel-heading p-x-20 p-t p-b-5 bg-F3F6F7"},d.default.createElement("span",{className:"text-black-3 font-16"},"推荐头条")),d.default.createElement("ul",{key:"relete-article-u",className:"list-group hot_articleB"},this.props.hot_article.map(function(e){return d.default.createElement(P.default,{key:e.fid,feed:e,xSpace:20})}),e.u>0&&d.default.createElement(b.default,{onClick:function(){return(0,x.default)("/article/headline?fr=topic","行业头条","fetch")}},d.default.createElement("span",null,"更多行业头条"),d.default.createElement("span",{className:"more_down_icon p-relative",style:{marginLeft:5}})))]}},{key:"render",value:function(){var e=this.context,t=e.auth_info;e.fconf;return d.default.createElement("div",null,this.renderContent(),this.renderRelateArticle(),this.renderRelateTopic(),t.u<0&&this.renderHotTopic(),this.renderHotArticle())}}]),t}(d.default.Component);q.contextTypes={auth_info:d.default.PropTypes.object,req:d.default.PropTypes.object,fconf:d.default.PropTypes.object,env:d.default.PropTypes.object,wx_sdk:d.default.PropTypes.object},e.exports=q},1665:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),c=a(1),o=n(c),d=a(278),u=n(d),f=a(17),p=n(f),m=a(76),_=n(m),h=function(e){function t(){var e,a,n,s;i(this,t);for(var l=arguments.length,c=Array(l),o=0;o<l;o++)c[o]=arguments[o];return a=n=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),n.onItemClick=p.default.debounce(function(){var e=n.props.datetime;if((0,u.default)(e)-(new Date).getTime()<=0)return n.props.url?void n.props.play():void(0,_.default)("请先订阅")},500,!0),s=a,r(n,s)}return s(t,e),l(t,[{key:"getDurationInfo",value:function(){var e=this.props.duration,t=parseInt(e/60),a=e%60;return t=t>=10?t:"0"+t,a=a>=10?a:"0"+a,t+":"+a}},{key:"render",value:function(){var e=this.props,t=e.datetime,a=e.isPlaying,n=e.title,i=e.customClass,r=e.sign,s=e.sign_date,l=e.resign,c=(0,u.default)(t).format("YYYY-MM-DD"),d=(0,u.default)(t)-(new Date).getTime()<=0;return o.default.createElement("div",{className:"p-x p-y border-bottom-e0 "+(i||""),key:this.props.img,onClick:this.onItemClick},o.default.createElement("div",{className:"media-left media-middle"},o.default.createElement("div",{className:"course_avatar_wrapper"},o.default.createElement("img",{className:"w-100 mw-100",src:this.props.img}),!d&&o.default.createElement("div",{className:"course_cover"}),!d&&o.default.createElement("div",{className:"course_cover_text"},"未开播"),d&&o.default.createElement("div",{className:"course_play_absolute"+(a?" course_stop_icon":" course_play_icon")}))),o.default.createElement("div",{className:"media-body media-middle"},o.default.createElement("div",{className:"course_title m-b-5"},n),o.default.createElement("div",{className:"font-12 text-info"},o.default.createElement("span",{className:"course_date_icon m-r-5"}),o.default.createElement("span",{className:"d-i-b media-middle m-r"},c),o.default.createElement("span",{className:"course_time_icon m-r-5"}),o.default.createElement("span",{className:"d-i-b media-middle"},this.getDurationInfo()),(1==r||s==t)&&o.default.createElement("span",{className:"fr font-12 text-blue-1C4781"},o.default.createElement("i",{className:"sign_bg_blue"}),l?"已补签":"已签到"))))}}]),t}(o.default.Component);t.default=e.exports=h},948:function(e,t,a){"use strict";(function(n){function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c,o,d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},u=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),f=a(1),p=i(f),m=a(47),_=i(m),h=a(1665),v=i(h),y=a(274),g=i(y),b=a(17),E=i(b),x=a(75),N=i(x),w=a(76),k=i(w),C=a(15),T=i(C),j=a(114),O=i(j),P=a(50),S=i(P),M=a(113),F=i(M),q=a(981),I=i(q),B=a(46),D=i(B),L=a(115),R=a(1138),A=i(R),H=a(170),W=i(H),J=a(1044),Y=i(J),z=a(993),U=i(z),V=(o=c=function(e){function t(e){r(this,t);var a=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.play=function(e){var t=a.props.hen,n=t.eggs;if(!t.is_sub)return void(0,k.default)("请先订阅");if(!e)return void(0,k.default)("课程还未开始");var i=E.default.findIndex(n,function(t){return t.url==e});if(a.audio){if(e==a.audio.src&&i>-1)return a.audio.paused?a.audio.play():a.audio.pause(),void a.props.cursor.select("hen","eggs",i,"isPlaying").set(!a.audio.paused);a.audio.pause(),E.default.forEach(n,function(e,t){return a.props.cursor.select("hen","eggs",t,"isPlaying").set(!1)})}var r=_.default.findDOMNode(a.audioWrapper);a.audio&&r.removeChild(a.audio);var s=new Audio;r.appendChild(s),a.audio=s,s.src=e,s.play(),a.props.cursor.select("hen","eggs",i,"isPlaying").set(!0),s.addEventListener("ended",function(){a.props.cursor.select("hen","eggs",i,"isPlaying").set(!1),s.currentTime=0})},a.gotoPlayDetailPage=function(e,t){var n=a.context.req;if(e||0==e){var i="/article/course_play?"+T.default.stringify({offset:e,fr:"course_list",eggId:t,hidx:n.query.hidx?n.query.hidx:""});(0,D.default)(i,"课程播放","fetch")}},a.signSuc=function(e){a.setState({signed:!0,sign_date:e.sign_date})},a.scroll_to_item=function(){var e=a.context.req.query;if(e.eidx||e.sidx){var t=n(".scrollItem");if(t&&t.length>0){var i=t.offset().top;window.scrollTo(0,i-72)}}},a.paySuc=function(){window.MaiMai_Native.native_refresh()},a.course_detail=function(){a.setState({course_tab:0})},a.course_list=function(){a.setState({course_tab:1})},a.course_discuss=function(){a.setState({course_tab:2})},a.native_iap_cb=function(e,t){1==e?a.paySuc():2==e&&(0,k.default)("支付失败")},a.subBtnClicked=E.default.debounce(function(){var e=a.props,t=e.cursor,n=e.hen,i=e.activity,r=a.context,s=r.auth_info,l=r.req;if(s.u<0)return void(0,L.launch_webview)();if(!n.is_sub&&n.purchasable){var c=l.query.hidx,o="/article/course_once?"+T.default.stringify(d({jsononly:1,hidx:c},s)),u=fetch(o,{credentials:"same-origin"}).then(N.default.parse_online_json).then(function(e){if(t.select("hen").set(e.data.hen),e.data.hen.is_sub)(0,k.default)("已订购，无需重复订购");else if(43==s.u){var r=JSON.stringify({products:[{identifier:"com.taou.iap.knowledge.class."+n.id,order_id:"101",frm:l.query.frm}]});MaiMai_Native.native_iap&&MaiMai_Native.native_iap(r,"native_iap_cb")}else if(0==n.discount&&i.id&&i.used,1){var o="/article/pay_course_once?"+T.default.stringify({hidx:c,frm:l.query.frm,cpid:n.coupon_info&&n.coupon_info.id||"",cpval:n.coupon_info&&n.coupon_info.value||""});(0,S.default)(o)}else{var u="/sdk/article/course_subscribe?"+T.default.stringify(d({cpid:n.coupon_info.id,cpval:n.coupon_info.value,frm:l.query.frm,id:n.id},s));fetch(u,{credentials:"same-origin"}).then(N.default.parse_online_json).then(function(e){a.paySuc()}).catch(function(e){N.default.toast_error_handler(e)})}}).catch(N.default.toast_error_handler);(0,O.default)("订购中...",u)}},500,!0),a.onSignClicked=E.default.debounce(function(){var e=a.context.req,t=e.query.hidx;(0,D.default)("/article/course_sign_in?"+T.default.stringify({hidx:t})+"&topicId="+a.props.hen.tpid,"课程签到","fetch")},200,!0),a.goToSendFeed=function(){var e=a.context,t=(e.req,e.auth_info),n=a.props.hen.tpid;if(t.u>0){if(window.MaiMai_Native.native_publish||window.MaiMai_Native.native_add_topic){var i={target:"topic_add_feed",title:"参与讨论",max_limit:5e3,right_button_text:"发布",text_holder:"说上几句吧...",extra_infomation:JSON.stringify({hash:W.default.generateFeedHash(),operation_topic:n,article_url:window.location.href})};return void(window.MaiMai_Native.native_add_topic?(i.ui_tag=16,window.MaiMai_Native.native_add_topic(JSON.stringify(i))):window.MaiMai_Native.native_publish(JSON.stringify(i)))}(0,S.default)("/article/pub_feed_pc?"+T.default.stringify({id:n,article_url:window.location.href}),"参与讨论")}else(0,L.launch_webview)()},a.native_publish_success=function(e){var t=a.props.hen,n=t.tpid,i=t.show_topic;if(n>0&&1==i){var r=JSON.parse(e).publish_return_data;a.setState({course_tab:2}),a.reloadData(r.feed),window.scrollTo(0,0)}},a.reloadData=function(e){try{var t={fid:e.id,feed:{id:e.id,uid:e.main.u.id,text:e.main.text,crtime_string:e.crtime,likes:0,pics:e.main.pics,type:e.ftype},contact:e.main.u,me_like:!1};a.props.cursor.select("topic","feeds").unshift(t)}catch(e){toast_error_handler(e)}a.props.cursor.select("topic","feeds_count").set(a.props.topic.feeds_count+1)},a.renderSign=function(){var e=a.props.hen,t=e.is_sub,n=e.sign_info,i=e.inapp,r=e.tpid;if(t){var s=!0;for(var l in n)s=!1;return r&&2==a.state.course_tab||s||n.sign_today<0?p.default.createElement("div",{className:"p-y"},p.default.createElement("div",{className:"course_blue_btn m-x-30",onClick:a.goToSendFeed},"参与讨论")):a.state.signed&&0!=i?p.default.createElement("div",{className:"p-y"},p.default.createElement("div",{className:"course_gray_btn m-x-30"},p.default.createElement("i",{className:"sign_bg"}),"已签到，累计",n.sign_total+1,"次")):p.default.createElement("div",{className:"p-y"},n.sign_today<0&&p.default.createElement("div",{className:"course_gray_btn  m-x-30"},"当天无更新课程"),n.sign_today>0&&p.default.createElement("div",{className:"course_gray_btn  m-x-30"},p.default.createElement("i",{className:"sign_bg"}),"已签到，累计",n.sign_total,"次"),0==n.sign_today&&0!=i&&p.default.createElement("div",{className:"course_blue_btn  m-x-30",onClick:a.onSignClicked},"签到"),0==i&&p.default.createElement("div",{className:"course_gray_btn  m-x-30"},"已购买"))}},a.getTicket=E.default.debounce(function(){var e=a.context,t=e.auth_info,n=e.fconf,i=e.req,r=n.online_url+"ge/v1/getcp?"+T.default.stringify(d({},t,{frm:i.query.frm}));fetch(r,{credentials:"same-origin"}).then(N.default.parse_online_json).then(function(){(0,k.default)("领取成功！"),setTimeout(function(){F.default.sendWebViewBroadcast("getTicketsuc"),location.reload()},1e3)}).catch(function(e){N.default.toast_error_handler(e)})},200,!0),a.state={course_tab:0,signed:!1},a}return l(t,e),u(t,[{key:"componentWillMount",value:function(){this.props.hen.is_sub&&0!=this.props.hen.inapp&&this.setState({course_tab:1})}},{key:"componentDidMount",value:function(){if(window.MaiMai_Native.native_set_navigationbar_custom){var e={left_image:"back_icon_normal",left_area_left_margin:5,scrolled:{left_image:"back_icon_circle",left_area_left_margin:5}};window.MaiMai_Native.native_set_navigationbar_custom(JSON.stringify(e))}g.default.isSupportTansShowTitleMenuBar(this.context)&&g.default.setMenuBarStyle({banner_trans:!0,hideTitle:!0}),F.default.bindBroadcast("broadcast_web_pay_suc",this.paySuc),F.default.bindBroadcast("course_sign_suc",this.signSuc),F.default.bindBroadcast("native_publish_success",this.native_publish_success),window.native_iap_cb=this.native_iap_cb,this.scroll_to_item()}},{key:"componentWillUnmount",value:function(){F.default.unbindBroadcast("broadcast_web_pay_suc",this.paySuc),F.default.unbindBroadcast("course_sign_suc",this.signSuc),F.default.unbindBroadcast("native_publish_success",this.native_publish_success)}},{key:"renderContent",value:function(){var e=this.props.article,t=this.props.hen,a=t.img_bodies,n=t.sales,i=this.context.req;if(a&&1!=i.query.tpl||!e.main)return p.default.createElement("div",{className:"m-t-10"},n>0&&p.default.createElement("div",{className:"purchase_tip_warp m-b-10 m-x"},1==n?p.default.createElement("span",{className:"purchase_tip"},"0元购"):p.default.createElement("span",{className:"purchase_tip"},n,"元购"),p.default.createElement("span",{className:"font-12 text-black-161719",style:{paddingLeft:"2%"}},"坚持学习，每日签到，全额返还报名费！")),a.map(function(e){return p.default.createElement("div",{className:"font-0 m-x m-b-10",key:e},p.default.createElement("img",{className:"w-100",src:e}))}));var r=e.main.html;return p.default.createElement("div",null,n>0&&p.default.createElement("div",{className:"purchase_tip_warp m-t-10 m-x"},1==n?p.default.createElement("span",{className:"purchase_tip"},"0元购"):p.default.createElement("span",{className:"purchase_tip"},n,"元购"),p.default.createElement("span",{className:"font-12 text-black-161719",style:{paddingLeft:"2%"}},"坚持学习，每日签到，全额返还报名费！")),p.default.createElement("div",{id:"article_content"},e.main.pics&&e.main.pics.length>0&&p.default.createElement("img",{src:e.main.pics[0].turl,id:"feed_first_image",className:"hidden"}),!r&&p.default.createElement("div",null,p.default.createElement(Y.default,{images:e.main.pics,first_image_id:"feed_first_image"})),2!=e.main.source_type&&p.default.createElement("div",{className:"mai-harticle-content "+(0==e.main.u.dist?"selectable":"")},!r&&p.default.createElement(U.default,{text:e.main.rtext||e.main.text}),r&&p.default.createElement("div",{dangerouslySetInnerHTML:{__html:r}})),r&&2==e.source_type&&p.default.createElement("div",{className:"rich_media_inner"},p.default.createElement("div",{className:"page-content"},p.default.createElement("div",{className:"rich_media_area_primary",dangerouslySetInnerHTML:{__html:r}})))))}},{key:"render",value:function(){var e=this,t=this.context.req.query,a=this.context.auth_info.u,n=this.props.hen,i=n.eggs,r=n.is_sub,s=n.discount_expire,l=n.discount,c=n.price,o=n.img_head,u=(n.img_bodies,n.title),f=n.inapp,m=n.expire_text,_=n.purchasable,h=n.tpid,y=(n.ios_price,n.show_topic),g=(n.coupon_info,s),b=this.props.activity,E=!1,x="",N=f>0||!f&&i&&i.length>0;return l=parseFloat(l/100).toFixed(2),c=parseFloat(c/100).toFixed(2),b.code&&43!=a&&(1==b.attended&&!b.used||0==b.attended)&&(E=!0,x=0==b.attended?"领取优惠券立减"+b.value/100+"元":"已用券帮你节省"+b.value/100+"元"),p.default.createElement("div",null,p.default.createElement(I.default,{title:u||"订阅课程"}),p.default.createElement("div",{className:"p-relative font-0 course_active"},p.default.createElement("img",{className:"mw-100",src:o}),E&&p.default.createElement("div",{className:"ticket_warp"},p.default.createElement("div",{className:"fr"},p.default.createElement("div",{className:"ticket_fr"},b.attended?p.default.createElement("span",{className:"get_ticket_suc"},"已领取"):p.default.createElement("span",{className:"get_ticket",onClick:this.getTicket},"立即领取"))),p.default.createElement("div",{className:"fl"},p.default.createElement("div",{className:"ticket_fl"},p.default.createElement("div",{className:"font-20 ticket_price"},"￥",p.default.createElement("span",{className:"font-44 font-bold price"},b.value/100)))),p.default.createElement("div",{className:"o-hidden"},p.default.createElement("div",{className:"ticket_des media-body media-middle"},p.default.createElement("div",{className:"font-16 ticket_name font-bold"},b.name),p.default.createElement("div",{className:"font-13 special"},"有效期至：",b.expire))))),(N||h>0)&&p.default.createElement("div",{className:"course_tabs"},p.default.createElement("div",{className:"course_tab "+(0==this.state.course_tab?"cur_course_tab":""),onClick:this.course_detail},p.default.createElement("span",{className:"m-r-5 "+(0==this.state.course_tab?"course_detail_blue_icon":"course_detail_icon")}),p.default.createElement("span",{className:"d-i-b media-middle"},"详情")),N&&p.default.createElement("div",{className:"course_tab "+(1==this.state.course_tab?"cur_course_tab":""),onClick:this.course_list},p.default.createElement("span",{className:"m-r-5 "+(1==this.state.course_tab?"course_blue_icon":"course_icon")}),p.default.createElement("span",{className:"d-i-b media-middle"},"课程")),h>0&&1==y&&p.default.createElement("div",{className:"course_tab "+(2==this.state.course_tab?"cur_course_tab":""),onClick:this.course_discuss},p.default.createElement("span",{className:"m-r-5 "+(2==this.state.course_tab?"course_discuss_blue_icon":"course_discuss_icon")}),p.default.createElement("span",{className:"d-i-b media-middle"},"讨论"))),0==this.state.course_tab&&p.default.createElement("div",null,this.renderContent()),1==this.state.course_tab&&p.default.createElement("div",{className:"p-t"},i.map(function(a,n){return p.default.createElement(v.default,d({},a,{position:n,play:function(){e.gotoPlayDetailPage(n,a.id)},key:a.id,sign_date:e.state.sign_date||"",customClass:t.eidx==a.id||t.sidx==a.seq_id?"scrollItem":""}))})),2==this.state.course_tab&&p.default.createElement("div",{className:"p-t"},p.default.createElement(A.default,d({},this.props.topic,{cursor:this.props.cursor.select("topic"),text:"讨论"}))),p.default.createElement("div",{style:{height:123}}),p.default.createElement("div",{className:"course_bottom_buttons",onClick:this.subBtnClicked},!r&&1==_&&43!=a&&p.default.createElement("div",{className:"p-y"},p.default.createElement("div",{className:"course_yellow_btn m-x-30 "+(g>=0?"":"m-y-10")},l!=c&&p.default.createElement("div",{className:"d-i-b m-r course_ori_price"},(g>=0?"":"¥ ")+c),p.default.createElement("div",{className:"d-i-b font-bold"},"¥ ",l)),b.code&&!b.used?p.default.createElement("div",{className:"course_time_tips"},x):g>=0&&p.default.createElement("div",{className:"course_time_tips"},"特价将于 ",0==g?1:g>7?7:g," 天后结束")),!r&&1==_&&43==a&&p.default.createElement("div",{className:"p-y"},p.default.createElement("div",{className:"course_yellow_btn m-x-30 m-y-10"},p.default.createElement("div",{className:"d-i-b font-bold"},"¥ ",l))),!r&&0==_&&m&&p.default.createElement("div",{className:"p-y"},p.default.createElement("div",{className:"course_gray_btn  m-x-30"},m)),r&&this.renderSign()),p.default.createElement("div",{className:"audioWrapper",ref:function(t){e.audioWrapper=t}}))}}]),t}(p.default.Component),c.contextTypes={req:p.default.PropTypes.object,fconf:p.default.PropTypes.object,auth_info:p.default.PropTypes.object},o);t.default=e.exports=V}).call(t,a(280))}});