webpackJsonp([74],{1439:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},l=a(1),r=n(l),s=a(15),o=n(s),d=a(90),u=n(d),c=a(75),f=n(c),p=a(114),m=n(p),_=a(41),h=n(_),v=a(168),x=n(v),y=a(1005),w=n(y),b=a(1014),E=n(b),g=a(993),q=n(g),N=a(76),k=n(N),T=a(984),C=(a(985)("app"),w.default.showInputPanel),j=w.default.clearInput;e.exports=r.default.createClass({displayName:"exports",mixins:[h.default],contextTypes:{auth_info:r.default.PropTypes.object,fconf:r.default.PropTypes.object,env:r.default.PropTypes.object},getInitialState:function(){return{expand_txt:null,line_clamp:5,showInput:!1}},componentDidMount:function(){window.onInputFinished=w.default.onInputFinished,this.checkExpandTxt()},componentWillUnmount:function(){window.onInputFinished=null},checkExpandTxt:function(){this.refs.txt.isTextOverflow()&&this.setState({expand_txt:"展开"})},gotoDetail:function(e){this.refs.avatar.gotoDetail(e)},spreadComment:function(e,t){var a=this,n=this.context,l=n.auth_info,r=(n.fconf,this.props),s=r.question,d=r.qlive_id,u="live_video_"+s.id;if(!e)return void(0,k.default)("回复内容不能为空");var c=i({question_id:s.id,qlive_id:d,qa_id:s.qa_id,text:e},l),p="/sdk/article/answer_qa?"+o.default.stringify(c),_=fetch(p,{credentials:"same-origin"}).then(f.default.parse_online_json).then(function(e){var t={id:e.id,question_id:e.question_id,text:e.text,uid:e.uid,create_time:e.create_time,answerCard:e.answerCard};j(u),a.props.cursor.select("answer").get()?a.props.cursor.select("answer").push(t):a.props.cursor.select("answer").set([t])}).catch(f.default.toast_error_handler);(0,m.default)("请求中...",_)},reply:function(e){e.stopPropagation();var t=this.props.question;if(window.MaiMai_Native.native_show_inputpanel){var a="live_video_"+t.id,n=t.card;C("回复",a,this.spreadComment,"回复"+n.name)}else this.replaceState({showInput:!this.state.showInput})},onExpandTxtClicked:function(e){e.stopPropagation(),"展开"==this.state.expand_txt&&this.setState({expand_txt:null,line_clamp:0})},renderExpandTxt:function(){var e=this.state.expand_txt;if(e)return r.default.createElement("div",{className:"text-primary liveReply",onClick:this.onExpandTxtClicked},e,r.default.createElement("span",{className:"more_down_icon p-relative",style:{marginLeft:5}}))},renderReply:function(){var e=[];return this.props.question.answer.map(function(t,a){e.push(r.default.createElement("div",{className:"gray-bg-f9 p-x-10 p-y-10 m-b-5",key:a},r.default.createElement("div",{className:"media-body media-middle font-13 text-muted"},r.default.createElement("span",null,t.answerCard.name),"回复:",r.default.createElement(u.default,{text:t.text,support_dref:!0}))))}),e},render:function(){var e=this.props,t=e.question,a=e.author_card,n=this.state.line_clamp,i=t.card,l=t.answer,s=a&&0==a.dist&&a.id!=i.id&&0!=i.dist;return r.default.createElement("li",{className:"border-bottom-e0 list-unstyled p-y-20 clearfix ",id:t.id},r.default.createElement("div",{className:"media m-b-10"},r.default.createElement("div",{className:"media-left media-middle"},r.default.createElement(x.default,{ref:"avatar",customClass:"avatar-24 radius-50",card:i,image_id:this.props.image_id,onClick:this.gotoDetail})),r.default.createElement("div",{className:"media-body media-middle"},r.default.createElement("div",{className:"lineClamp1 text-muted "},r.default.createElement("span",{onClick:this.gotoDetail},i.name),1==i.judge&&r.default.createElement("span",{className:"add_v_img"}),1==i.mem_st&&E.default.renderMember(i.mem_id)))),r.default.createElement("div",{className:"m-b-10",style:n>0?(0,T.textOverflow)(n):null},r.default.createElement(q.default,{ref:"txt",text:t.text})),this.renderExpandTxt(),s&&r.default.createElement("span",{className:"text-primary liveReply m-y-10 show",onClick:this.reply},"回复"),l&&this.renderReply())}})},727:function(e,t,a){"use strict";(function(n){function i(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o,d,u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},c=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),f=a(1),p=i(f),m=a(15),_=i(m),h=a(981),v=i(h),x=a(76),y=i(x),w=a(75),b=i(w),E=a(170),g=i(E),q=a(115),N=a(168),k=i(N),T=a(113),C=a(114),j=i(C),O=a(984),P=a(993),M=i(P),S=a(1439),I=i(S),D=a(986),F=i(D),R=a(290),J=i(R);t.default=e.exports=(d=o=function(e){function t(e){l(this,t);var a=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.reloadData=function(e){try{var t={id:e.id,uid:e.uid,qa_id:e.qa_id,text:e.text,create_time:e.create_time,card:e.card};a.props.cursor.select("questions").unshift(t)}catch(e){(0,w.toast_error_handler)(e)}a.props.cursor.select("total_question").set(a.props.total_question+1)},a.native_publish_success=function(e){var t=JSON.parse(e).publish_return_data;a.reloadData(t)},a.getQueryString=function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),a=window.location.search.substr(1).match(t);return null!=a?unescape(a[2]):null},a.gotoDetail=function(e){a.refs.avatar.gotoDetail(e)},a.onExpandTxtClicked=function(e){e.stopPropagation(),a.setState({expand_txt:null,line_clamp:0})},a.inviteFriends=function(){var e=a.context,t=e.env,n=e.auth_info,i=e.fconf;if(t.from_pc)return void(0,y.default)("请使用脉脉app邀请");var l=a.props,r=l.qlive_id,s=l.qa_id;window.invite_cb=function(e){var t=i.online_url+"user/v4/qlive/qa/invite?"+_.default.stringify(u({qlive_id:r,qa_id:s,uid2:e},n));fetch(t,{credentials:"same-origin"}).then(w.parse_online_json).then(function(e){(0,y.default)("邀请成功")}).catch(w.toast_error_handler)},window.MaiMai_Native.native_choose_contacts("invite_cb",JSON.stringify({title:"邀请LV2好友参与",count:10,selectTooManyTips:"一次最多邀请10个好友",type:2,confirmButtonText:"邀请",min_level:2}),"")},a.goToSendQuestion=function(){var e=a.context,t=(e.req,e.auth_info),n=a.props,i=n.qa_id,l=n.qlive_id;if(t.u>0){if(window.MaiMai_Native.native_publish){var r={target:"topic_qa",title:"参与互动",max_limit:1500,right_button_text:"发布",text_holder:"说上几句吧...",extra_infomation:JSON.stringify({hash:g.default.generateFeedHash(),qa_id:i,qlive_id:l,article_url:window.location.href})};return r.ui_tag=13,void window.MaiMai_Native.native_publish(JSON.stringify(r))}(0,y.default)("请使用脉脉客户端进行该操作")}else(0,q.launch_webview)()},a.share=function(){if(a.context.auth_info.u<0)return void(0,q.launch_webview)();MaiMai_Native.native_share(1)},a.follow=function(){var e=a.context,t=e.auth_info,n=e.fconf,i=a.props,l=i.qlive_id,r=i.qa_id,s=i.is_followed;if(t.u<0)return void(0,q.launch_webview)();var o="follow"==s?"unfollow":"follow",d=u({action:o,qlive_id:l,qa_id:r},t),c=n.online_url+"user/v4/qlive/qa/follow?"+_.default.stringify(d),f=fetch(c,{credentials:"same-origin"}).then(w.parse_online_json).then(function(e){a.props.cursor.select("is_followed").set(o)}).catch(w.toast_error_handler);(0,j.default)("设置中...",f)},a.question_more=function(){var e=a.context.auth_info,t=a.props,n=t.cursor,i=t.qlive_id,l=t.page;n.select("content_status").set("loading");var r="/sdk/article/question_more?"+_.default.stringify(u({qlive_id:i,page:l+1,count:20},e));fetch(r,{credentials:"same-origin"}).then(b.default.parse_online_json).then(function(e){n.select("questions").concat(e.questions),n.select("page").set(l+1),n.select("content_status").set(null)}).catch(function(e){n.select("content_status").set(null),b.default.toast_error_handler(e)})},a.state={expand_txt:null,line_clamp:7},a}return s(t,e),c(t,[{key:"componentDidMount",value:function(){(0,T.bindBroadcast)("pub_feed",this.reloadData),(0,T.bindBroadcast)("native_publish_success",this.native_publish_success);var e=this.getQueryString("question_id");e&&(document.documentElement.scrollTop=document.body.scrollTop=n("#"+e).offset().top),this.checkExpandTxt()}},{key:"componentWillUnmount",value:function(){(0,T.unbindBroadcast)("native_publish_success")}},{key:"checkExpandTxt",value:function(){this.props.title&&this.refs.txt&&this.refs.txt.isTextOverflow()&&this.setState({expand_txt:"展开"})}},{key:"renderAuthorCard",value:function(){var e=this.props.author_card;if(e)return p.default.createElement("div",{className:"p-x-20 m-b-10"},p.default.createElement("div",{className:"media-left media-middle"},p.default.createElement(k.default,{ref:"avatar",customClass:"avatar-24 radius-50",card:e,image_id:"user_avatar"})),p.default.createElement("div",{className:"media-body media-middle"},p.default.createElement("div",{className:"text-muted"},p.default.createElement("span",{onClick:this.gotoDetail},e.name))))}},{key:"renderFollowCard",value:function(){var e=this.context,t=e.env,a=e.auth_info,n=this.props.is_followed;return p.default.createElement("div",{className:"p-x-20 w-100 clearfix"},p.default.createElement("div",{className:"w-40 text-primary p-l-0 fr",style:{visibility:a.u>0?"visible":"hidden"}},p.default.createElement("div",{className:"fr topicFocus text-right"},p.default.createElement("span",{className:"follow"==n?"":"topicFocusBg",onClick:this.follow},"follow"==n?"取消关注":"关注")),!t.from_pc&&p.default.createElement("div",{className:"fr p-r-10"},p.default.createElement("span",{className:"topicShare",onClick:this.share},"分享"))))}},{key:"renderActionCard",value:function(){if(!(this.context.auth_info.u<0))return p.default.createElement("div",{className:"p-x-20"},p.default.createElement("div",{className:"media-table w-100 text-center"},p.default.createElement("div",{className:"media-left p-y halfWidth media-middle",onClick:this.inviteFriends},p.default.createElement("div",{className:"btn btn-outline-0089e9 btn-radius-26 w-100",style:{padding:"10px 12px"}},p.default.createElement("span",{className:"media-middle topicInviteIcon"}),p.default.createElement("span",null,"邀请参与"))),p.default.createElement("div",{className:"media-right p-l-0 p-y halfWidth media-middle",onClick:this.goToSendQuestion},p.default.createElement("div",{className:"btn btn-primary btn-radius-26 w-100",style:{padding:"10px 12px"}},p.default.createElement("span",{className:"media-middle topicJoinIcon"}),p.default.createElement("span",null,"撩专家")))))}},{key:"renderExpandTxt",value:function(){var e=this.state.expand_txt;if(e)return p.default.createElement("div",{className:"liveReply m-t-10 text-primary font-16",onClick:this.onExpandTxtClicked},e)}},{key:"renderHeader",value:function(){var e=this.state.line_clamp;return p.default.createElement("div",{className:"p-b-15 text-black-3 p-t-30"},p.default.createElement("div",{className:"p-x-20 m-b"},p.default.createElement("div",{className:"font-16 text-gray-7d l-h-26",style:e>0?(0,O.textOverflow)(e):null},p.default.createElement(M.default,{ref:"txt",text:this.props.title})),this.renderExpandTxt()),this.renderAuthorCard(),this.renderFollowCard(),this.renderActionCard())}},{key:"renderContent",value:function(){var e=this,t=this.props,a=t.questions,n=t.content_status,i=t.total_question,l=t.qa_id,r=t.qlive_id,s=(t.cursor,i>a.length),o="loading"==n;return p.default.createElement("div",null,i>0&&p.default.createElement("div",{className:"font-16 p-t-20 p-x-20"},"全部",i,"条问答"),p.default.createElement("ul",{className:"list-group p-x-20 m-b-0"},a.map(function(t,a){return p.default.createElement(I.default,{key:t.id,qlive_id:r,qa_id:l,question:t,author_card:e.props.author_card,cursor:e.props.cursor.select("questions",a)})}),s&&p.default.createElement(F.default,{onClick:this.question_more},p.default.createElement("span",null,"更多问答"),p.default.createElement("span",{className:"more_down_icon p-relative",style:{marginLeft:5}})),o&&p.default.createElement("div",{dangerouslySetInnerHTML:{__html:(0,J.default)()}})))}},{key:"render",value:function(){return p.default.createElement("div",null,p.default.createElement(v.default,{title:this.props.liveTitle||this.props.title}),p.default.createElement("div",{className:"l-h-22"},this.renderHeader(),p.default.createElement("div",{className:"gray-bg-f2",style:{height:4}}),p.default.createElement("div",{className:"panel panel-default"},this.renderContent())))}}]),t}(p.default.Component),o.contextTypes={req:p.default.PropTypes.object,fconf:p.default.PropTypes.object,auth_info:p.default.PropTypes.object,env:p.default.PropTypes.object,wx_sdk:p.default.PropTypes.object},d)}).call(t,a(280))}});