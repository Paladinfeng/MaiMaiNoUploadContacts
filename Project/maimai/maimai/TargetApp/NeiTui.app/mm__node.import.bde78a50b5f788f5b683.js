webpackJsonp([188],{740:function(t,e,a){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var c,r,l=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(t[s]=a[s])}return t},u=function(){function t(t,e){for(var a=0;a<e.length;a++){var s=e[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,a,s){return a&&t(e.prototype,a),s&&t(e,s),e}}(),p=a(1),f=s(p),h=a(75),_=a(981),d=s(_),m=a(15),y=s(m),v=a(46),g=s(v),w=a(165),S=(s(w),a(996)),C=(s(S),a(283)),b=a(1085),k=s(b),E=a(1021),N=(s(E),a(1007)),M=(s(N),a(1020)),O=(s(M),a(988)),x=s(O),j=a(167),L=a(271),P=s(L),T=(a(270),a(982),a(63),a(990),a(1009)),J=(a(17),a(164).getCache,a(164).putCache,a(113));e.default=t.exports=(r=c=function(t){function e(){var t,a,s,n;i(this,e);for(var c=arguments.length,r=Array(c),u=0;u<c;u++)r[u]=arguments[u];return a=s=o(this,(t=e.__proto__||Object.getPrototypeOf(e)).call.apply(t,[this].concat(r))),s.state={w:"",p:"",c:"",t:"",cp:"",curcp:"",excp:"",pos:"",wt:"",sch:"",pro:"",m:"",ipro:0,im:0},s.WORK_TIMES=["1年以内","1-3年","3-5年","5-10年","10年以上"],s.DISTS=["不限","好友","2度","2度、3度"],s.onPaysuc=function(){var t=s.context,e=t.fconf,a=t.auth_info,i=s.props.cursor,o=e.online_url+"talent/v3/uh/get_memlist?"+y.default.stringify(l({},a));return fetch(o,{credentials:"same-origin"}).then(h.parse_online_json).then(function(t){i.select("memlist").set(t)})},s.goInput=function(){(0,g.default)("/search/uh_adsearch_input","","fetch")},s.setLocation=function(t){var e=JSON.parse(t);e.province&&e.city&&s.setState({p:e.province,c:e.city})},s.goLocation=function(){s.toggleLocsFilter()},s.setVocation=function(t){var e=JSON.parse(t);s.setState({pro:e.profession_name,m:e.major_name,ipro:e.profession_id,im:e.major_id})},s.goVocation=function(){var t=[];s.state.pro.length>0&&t.push({id:s.state.ipro,name:s.state.pro,majors:[{id:s.state.im,name:s.state.m}]}),MaiMai_Native.native_choose_vocation(JSON.stringify({professions:t}),"setVocation",!1)},s.setCurcompany=function(t){var e=JSON.parse(t);s.setState({curcp:e.cname})},s.goCurcompany=function(){MaiMai_Native.native_select_company?MaiMai_Native.native_select_company(s.state.curcp,"setCurcompany"):(0,g.default)("/search/uh_adsearch_input?"+y.default.stringify({key:"curcp",val:s.state.curcp,title:"公司名称"}),"公司名称","fetch")},s.setExcompany=function(t){var e=JSON.parse(t);s.setState({excp:e.cname})},s.goExcompany=function(){MaiMai_Native.native_select_company?MaiMai_Native.native_select_company(s.state.excp,"setExcompany"):(0,g.default)("/search/uh_adsearch_input?"+y.default.stringify({key:"excp",val:s.state.excp,title:"公司名称"}),"公司名称","fetch")},s.setWorktime=function(t){var e=JSON.parse(t);s.setState({wt:e<s.WORK_TIMES.length?t:""})},s.goWorktime=function(){MaiMai_Native.native_show_actionsheet_list("工作时间",JSON.stringify(s.WORK_TIMES),1,1,s.state.wt,0,"setWorktime")},s.setSchool=function(t){var e=JSON.parse(t);s.setState({sch:e.cname})},s.goSchool=function(){MaiMai_Native.native_select_school?MaiMai_Native.native_select_school(s.state.sch,"setSchool"):(0,g.default)("/search/uh_adsearch_input?"+y.default.stringify({key:"sch",val:s.state.sch,title:"学校名称"}),"学校名称","fetch")},s.setPosition=function(t){var e=JSON.parse(t);s.setState({pos:e.cname})},s.goPosition=function(){MaiMai_Native.native_select_careerTitle?MaiMai_Native.native_select_careerTitle(s.state.pos,"setPosition"):(0,g.default)("/search/uh_adsearch_input?"+y.default.stringify({key:"pos",val:s.state.pos,title:"职位名称"}),"职位名称","fetch")},s.setDist=function(t){var e=JSON.parse(t);s.setState({dist:e<s.DISTS.length?t:""})},s.goDist=function(){MaiMai_Native.native_show_actionsheet_list("人脉关系",JSON.stringify(s.DISTS),1,1,s.state.dist,0,"setDist")},s.doSearch=function(){var t=s.props.memlist;if(s.state.w||s.state.p||s.state.c||s.state.t||s.state.curcp||s.state.excp||s.state.pos||""!=s.state.wt||s.state.sch||s.state.pro||s.state.m)if(t.mem_info.id>0){var e="/search/uh_adsearch?"+y.default.stringify({w:s.state.w,p:s.state.p,c:s.state.c,t:s.state.t,cp:s.state.cp,curcp:s.state.curcp,excp:s.state.excp,pos:s.state.pos,wt:s.state.wt,sch:s.state.sch,pro:s.state.pro,m:s.state.m,dist:s.state.dist});(0,g.default)(e,"高级搜索","fetch")}else{var a="search_adsearch";"search_adsearch_2"==s.context.req.query.from&&(a="search_adsearch_2");var e="/uh_memlist?"+y.default.stringify({fr:a});(0,g.default)(e,"","fetch")}else(0,j.showModalForConfirm)({title:"至少输入一个查询条件",ok_text:"知道了",ok:function(){}})},s.on_data_receive_from_next_page=function(t){var e=JSON.parse(t);if(e.type&&"input"==e.type){var a={};a[e.key]=e.input_value,s.setState(a)}},s.onSearchKeyChanged=function(t){var e=JSON.parse(t);s.setState({w:e.keyword})},s.onSelectLoc=function(t,e){t==s.selectedLoc.province&&e==s.selectedLoc.city||(s.selectedLoc.province=t,s.selectedLoc.city=e,s.province=t>0?s.locs[t].name:"",s.city=e>0?s.locs[t].items[e].name:"",s.setState({p:s.province,c:s.city}))},s.onCancelSelectLoc=function(){s.props.cursor.select("locsFilter","parent").set(s.selectedLoc.province),s.props.cursor.select("locsFilter","child").set(s.selectedLoc.city)},s.toggleLocsFilter=function(){var t=s.props.cursor.select("locsFilter","close").get();s.props.cursor.select("locsFilter","close").set(!t),s.props.cursor.select("pfmjsFilter","close").set(!0)},s.gotoVip=function(){(0,g.default)("/uh_memlist?fr=search_adsearch_2","会员中心","fetch")},n=a,o(s,n)}return n(e,t),u(e,[{key:"componentWillMount",value:function(){"undefined"!=typeof window&&(window.on_data_receive_from_next_page=this.on_data_receive_from_next_page,window.setLocation=this.setLocation,window.setVocation=this.setVocation,window.setCurcompany=this.setCurcompany,window.setExcompany=this.setExcompany,window.setWorktime=this.setWorktime,window.setSchool=this.setSchool,window.setPosition=this.setPosition,window.setDist=this.setDist,window.search_callback=this.onSearchKeyChanged,J.bindBroadcast("search_key_changed",this.onSearchKeyChanged),J.bindBroadcast("broadcast_web_pay_suc",this.onPaysuc),this.locs=C.cst.loc.map(function(t){var e=t.cities.map(function(t){return{name:t.city}});return e.unshift({name:"全部"}),{name:t.province,items:e}}),this.locs.unshift({name:"全部",items:[{name:"全部"}]}),this.props.cursor.merge({locsFilter:{parent:0,child:-1,close:!0},pfmjsFilter:{parent:0,child:-1,close:!0}}),this.selectedLoc={province:0,city:-1})}},{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){window.search_callback=null,J.unbindBroadcast("search_key_changed",this.onSearchKeyChanged),J.unbindBroadcast("broadcast_web_pay_suc",this.onPaysuc)}},{key:"render",value:function(){var t=this.context,e=(t.auth_info,t.req);return f.default.createElement("div",null,f.default.createElement(d.default,{title:"高级搜索"}),"search_adsearch_2"==e.query.fr&&f.default.createElement("div",{className:"media vip_tip"},f.default.createElement("div",{className:"media-left img_icon"}),f.default.createElement("div",{className:"media-right tip_text"},"尝试又快又精准的方式搜索？开通会员尊享高级搜索特权",f.default.createElement("span",{onClick:this.gotoVip},"立即开通"))),f.default.createElement(P.default,{key:"tip",title:"选择你的搜索条件",icon_classname:"null",headClass:"p-b-5 p-t p-x gray-bg-f2f6f7 text-info"}),f.default.createElement("div",{className:"white-bg"},f.default.createElement(k.default,{key:1,onClick:this.goPosition,title:"职位名称",titleClass:"",leftClass:"m-l",lastCell:null,arrow_img:"arrow_blue_gray"},this.state.pos),f.default.createElement(k.default,{key:2,onClick:this.goLocation,title:"所在地区",titleClass:"",leftClass:"m-l",lastCell:null,arrow_img:"arrow_blue_gray"},this.state.p||this.state.c?this.state.p+" "+this.state.c:"全部"),f.default.createElement(k.default,{key:3,onClick:this.goVocation,title:"行业方向",titleClass:"",leftClass:"m-l",lastCell:null,arrow_img:"arrow_blue_gray"},this.state.pro||this.state.m?this.state.pro+" "+this.state.m:"全部"),f.default.createElement(k.default,{key:5,onClick:this.goCurcompany,title:"目前就职",titleClass:"",leftClass:"m-l",lastCell:null,arrow_img:"arrow_blue_gray"},this.state.curcp),f.default.createElement(k.default,{key:6,onClick:this.goExcompany,title:"曾经就职",titleClass:"",leftClass:"m-l",lastCell:null,arrow_img:"arrow_blue_gray"},this.state.excp),f.default.createElement(k.default,{key:7,onClick:this.goWorktime,title:"工作年限",titleClass:"",leftClass:"m-l",lastCell:null,arrow_img:"arrow_blue_gray"},isNaN(parseInt(this.state.wt))?"不限":this.WORK_TIMES[this.state.wt]),f.default.createElement(k.default,{key:8,onClick:this.goSchool,title:"毕业学校",titleClass:"",leftClass:"m-l",lastCell:null,arrow_img:"arrow_blue_gray"},this.state.sch),f.default.createElement(k.default,{key:9,onClick:this.goDist,title:"人脉关系",titleClass:"",leftClass:"m-l",lastCell:null,arrow_img:"arrow_blue_gray"},isNaN(parseInt(this.state.dist))?this.DISTS[0]:this.DISTS[this.state.dist])),f.default.createElement("div",null,f.default.createElement(T,{cursor:this.props.cursor.select("locsFilter"),items:this.locs,onSelect:this.onSelectLoc,onCancel:this.onCancelSelectLoc})),f.default.createElement(x.default,{btns:["立即搜索"],actions:[this.doSearch]}))}}]),e}(f.default.Component),c.contextTypes={req:f.default.PropTypes.object,fconf:f.default.PropTypes.object,auth_info:f.default.PropTypes.object},r)}});