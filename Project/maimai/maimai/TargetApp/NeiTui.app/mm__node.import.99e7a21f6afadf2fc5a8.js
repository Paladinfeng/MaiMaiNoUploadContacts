webpackJsonp([47],{1457:function(e,t,a){"use strict";function l(e){var t=JSON.parse(e);s(t)}function r(e,t,a){window.MaiMai_Native.native_show_locationpicker&&(s=a,window.MaiMai_Native.native_show_locationpicker(e,t,"onPickerFinished"))}function i(){return null!=window.MaiMai_Native.native_show_locationpicker}var s;e.exports.hasPicker=i,e.exports.showPicker=r,e.exports.onPickerFinished=l},1458:function(e,t,a){"use strict";var l={gray:"#9da8b3",black:"#081424",blue:"#00baff",white:"#ffffff",orange:"#ff7800",large:"14px",medium:"13px",small:"12px",padding:"0 15px"};e.exports={layerCover:{left:"0",top:"0",position:"fixed",background:"rgba(0,0,0,0.6)",height:"100%",width:"100%",zIndex:"3"},layerBox:{boxSizing:"border-box",padding:"18px 0 0",margin:"auto",width:"92%",position:"fixed",top:"50%",left:"50%",zIndex:"6",WebkitTransform:"translate(-50%,-50%)",MsTransform:"translate(-50%,-50%)",transform:"translate(-50%,-50%)",background:"#ffffff",borderRadius:"4px"},layerTit:{color:l.black,fontSize:l.large,textAlign:"center",lineHeight:"26px",margin:"0 0 12px 0",padding:l.padding},layerWarning:{fontSize:l.medium,padding:l.padding,color:l.gray,lineHeight:"20px"},orangeTxt:{color:l.orange,fontStyle:"normal"},layerCon:{padding:"18px 15px",background:"#ebecec",borderRadius:"4px",fontSize:l.large,color:l.black,margin:"10px 15px 0"},conRowLabel:{minWidth:"56px",color:l.gray,fontWeight:"normal",margin:"0"},twoBtns:{display:"table",width:"100%",textAlign:"center",height:50,marginTop:"20px",color:l.blue,fontSize:"16px"},btnItem:{display:"table-cell",width:"50%",verticalAlign:"middle",borderTop:"1px solid #d9d9d9"},leftBtn:{borderRight:"1px solid #d9d9d9",color:l.gray}}},766:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},i=a(1),s=l(i),d=a(114),o=l(d),n=a(75),u=l(n),c=a(15),f=l(c),p=a(76),h=l(p),m=a(275),v=l(m),y=a(166),b=l(y),g=a(1060),x=l(g),E=a(981),_=l(E),k=a(1457),B=l(k),N=a(1458),w=l(N),M=a(113),I=l(M),P=a(1028),O=a(41),D=a(47),S=s.default.createClass({displayName:"AddBank",mixins:[v.default,O],contextTypes:{auth_info:s.default.PropTypes.object,fconf:s.default.PropTypes.object},componentDidMount:function(){this.props.cursor.select("can_request_verify").set(!0),window.onPickerFinished=B.default.onPickerFinished,this.props.cursor.select("show_location_picker").set(B.default.hasPicker()),this.props.deposit&&this.props.dpvalue&&(this.refs.deposit_value.value=this.props.dpvalue)},componentWillUnmount:function(){window.onPickerFinished=null},onRequestVerify:function(){var e=this,t=D.findDOMNode(this.refs.mobile).value,a=(0,P.checkStrNumbValid)(t);if(a<=0)return(0,h.default)(-1==a?"请输入手机号":"请输入正确手机号");if(this.props.cursor.select("can_request_verify").get())var l=this.context,i=l.fconf,s=l.auth_info,d=i.online_url+"mmpay/v4/bindcode?"+f.default.stringify(r({mobile:t.trim()},s)),n=fetch(d,{credentials:"same-origin"}).then(u.default.parse_online_json).then(function(){(0,h.default)("验证码已发送"),(0,o.default)("获取验证码",n),e.props.cursor.select("request_verify_time").set(60),e.startCount()}).catch(function(e){(0,h.default)("string"==typeof e?e:"网络连接失败")})},chooseLocation:function(){B.default.showPicker(null,null,this.onLocationPicked)},onLocationPicked:function(e){e.province&&this.props.cursor.select("province").set(e.province),e.city&&this.props.cursor.select("city").set(e.city)},onValidData:function(){var e=D.findDOMNode(this.refs.card_numb).value,t=D.findDOMNode(this.refs.name).value,a=D.findDOMNode(this.refs.ident).value,l=D.findDOMNode(this.refs.mobile).value,r=D.findDOMNode(this.refs.code).value,i=(0,P.checkStrNumbValid)(e);if(i<=0)return(0,h.default)(-1==i?"请输入银行卡号":"请输入正确银行卡号");if(!this.props.ident){if((0,P.checkStrEmpty)(t))return void(0,h.default)("请输入持卡人姓名");if((0,P.checkStrEmpty)(a))return void(0,h.default)("请输入身份证")}if(B.default.hasPicker()&&!this.props.cursor.select("province").get()&&!this.props.cursor.select("city").get())return void(0,h.default)("请选择归属地");if((i=(0,P.checkStrNumbValid)(l))<=0)return(0,h.default)(-1==i?"请输入手机号":"请输入正确手机号");if((0,P.checkStrEmpty)(r))return void(0,h.default)("请输入验证码");if(this.props.deposit){var s=new Set(["1","4","221"]);if(1==this.props.type){var d=this.context.auth_info;if(!s.has(d.u))return void(0,h.default)("不支持使用信用卡充值");var o=D.findDOMNode(this.refs.validthru).value;if(!o||4!=o.length)return(0,h.default)("有效期格式为MMYY,比如2019年7月则输入0719");var n=D.findDOMNode(this.refs.cvv2).value;if(!n||3!=n.length)return(0,h.default)("cvv2为三位数字,在您的信用卡背后可找到")}var u=D.findDOMNode(this.refs.deposit_value).value;if((0,P.checkStrEmpty)(u))return void(0,h.default)("请输入充值金额");var c=parseFloat(u);if(c<1)return(0,h.default)("单次充值金额必须大于1元");if(c>2e3)return(0,h.default)("单次充值金额不得超过2000元")}if(this.props.ident)return void this.onSubmit();this.props.cursor.select("show_dialog").set(!0)},onSubmit:function(){var e=this;if(this.props.deposit||confirm("为了验证银行卡真实有效，绑卡时可能会从该卡充值1分钱到您的脉脉账户。")){var t=D.findDOMNode(this.refs.card_numb).value,a=D.findDOMNode(this.refs.name).value,l=D.findDOMNode(this.refs.ident).value,i=D.findDOMNode(this.refs.mobile).value,s=D.findDOMNode(this.refs.code).value;t=t.trim(),a=a.trim(),l=l.trim(),i=i.trim(),s=s.trim();var d=this.context,n=d.fconf,c=d.auth_info,p=r({cardnum:t,mobile:i,code:s},c);if(this.props.ident||(p.name=a),this.props.ident||(p.ident=l),this.props.cursor.select("province").get()&&(p.province=this.props.cursor.select("province").get()),this.props.cursor.select("city").get()&&(p.city=this.props.cursor.select("city").get()),this.props.deposit){if(1==this.props.type){var m=D.findDOMNode(this.refs.validthru).value,v=D.findDOMNode(this.refs.cvv2).value;p.validthru=m,p.cvv2=v}var y=D.findDOMNode(this.refs.deposit_value).value,b=parseFloat(y);p.value=b}var g=n.online_url+"mmpay/v4/bindcard?"+f.default.stringify(r({with_photo:n.need_idcard_photo},c)),x=fetch(g,{credentials:"same-origin",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:f.default.stringify(p)}).then(u.default.parse_json_original_err).then(function(t){(0,h.default)(e.props.deposit?"支付成功":"添加成功"),I.default.sendWebViewBroadcast("bank_card_added",t.card),window.MaiMai_Native.close_native(null,!0)}).catch(function(t){e.props.deposit&&10002==t.code?(0,h.default)("充值遇到问题,请过5分钟查询帐户明细确定是否充值成功"):(0,h.default)(t.error_msg?t.error_msg:"未知错误: "+JSON.stringify(t))});(0,o.default)(this.props.deposit?"支付中..":"添加中..",x)}},startCount:function(){var e=this;this.props.cursor.select("can_request_verify").set(!1),this.setTimeout(function(){if(e.props.cursor.select("request_verify_time").get()<=0)return void e.props.cursor.select("can_request_verify").set(!0);e.props.cursor.select("request_verify_time").apply(function(e){return e-1}),e.startCount()},1e3)},render:function(){var e,t=this;(this.props.cursor.select("province").get()||this.props.cursor.select("city").get())&&(e=this.props.cursor.select("province").get()+this.props.cursor.select("city").get());var a;if(this.props.cursor.select("show_dialog").get()){var l=D.findDOMNode(this.refs.name).value,r=D.findDOMNode(this.refs.ident).value;a=s.default.createElement("div",null,s.default.createElement("div",{style:w.default.layerCover}),s.default.createElement("div",{style:w.default.layerBox},s.default.createElement("div",{style:w.default.layerTit},"请确认实名认证信息"),s.default.createElement("div",{style:w.default.layerWarning},s.default.createElement("em",{style:w.default.orangeTxt},"认证后无法修改身份信息！"),"为了账户安全，后续提现只能提至此信息开户的银行卡。"),s.default.createElement("div",{style:w.default.layerCon},s.default.createElement("div",null,s.default.createElement("label",{style:w.default.conRowLabel},"姓名"),l),s.default.createElement("div",null,s.default.createElement("label",{style:w.default.conRowLabel},"身份证"),r)),s.default.createElement("div",{className:"clearfix",style:w.default.twoBtns},s.default.createElement("a",{href:"javascript:void(0)",style:[w.default.btnItem,w.default.leftBtn],onClick:function(){t.props.cursor.select("show_dialog").set(!1)}},"取消"),s.default.createElement("a",{href:"javascript:void(0)",style:w.default.btnItem,onClick:this.onSubmit},"确认"))))}var i,d,o,n,u,c,f;return this.props.ident?(i=s.default.createElement("div",{key:"1",className:"clearfix",style:[x.default.cashBox,x.default.borderBottom]},s.default.createElement("label",{style:x.default.cashLabel},"持卡人"),s.default.createElement("p",{style:x.default.cashBoxP},s.default.createElement("input",{style:[x.default.cashInput,x.default.rightInput,x.default.disableBg],type:"text",placeholder:"",ref:"name",disabled:"disabled",value:this.props.ident.name}))),d=s.default.createElement("div",{key:"2",className:"clearfix",style:[x.default.cashBox,x.default.borderBottom,x.default.disableBg]},s.default.createElement("label",{style:x.default.cashLabel},"身份证号码"),s.default.createElement("p",{style:x.default.cashBoxP},s.default.createElement("input",{style:[x.default.cashInput,x.default.rightInput,x.default.disableBg],type:"text",placeholder:"",ref:"ident",disabled:"disabled",value:this.props.ident.ident})))):(i=s.default.createElement("div",{key:"1",className:"clearfix",style:[x.default.cashBox,x.default.borderBottom]},s.default.createElement("label",{style:x.default.cashLabel},"持卡人"),s.default.createElement("p",{style:x.default.cashBoxP},s.default.createElement("input",{style:[x.default.cashInput,x.default.rightInput],type:"text",placeholder:"",ref:"name"}))),d=s.default.createElement("div",{key:"2",className:"clearfix",style:[x.default.cashBox,x.default.borderBottom]},s.default.createElement("label",{style:x.default.cashLabel},"身份证号码"),s.default.createElement("p",{style:x.default.cashBoxP},s.default.createElement("input",{style:[x.default.cashInput,x.default.rightInput],type:"text",placeholder:"",ref:"ident"})))),this.props.cursor.select("show_location_picker").get()&&(o=s.default.createElement("div",{key:"3",className:"clearfix",style:[x.default.cashBox,x.default.borderBottom],onClick:this.chooseLocation},s.default.createElement("label",{style:x.default.cashLabel},"银行卡归属地"),s.default.createElement("p",{style:x.default.cashBoxP,ref:"location",className:"text-right"},e))),this.props.deposit?(1==this.props.type&&(c=s.default.createElement("div",{key:"61",className:"clearfix",style:[x.default.cashBox,x.default.borderBottom]},s.default.createElement("label",{style:x.default.cashLabel},"有效期(MMYY)"),s.default.createElement("p",{style:x.default.cashBoxP},s.default.createElement("input",{style:[x.default.cashInput,x.default.rightInput],type:"number",placeholder:"",ref:"validthru"}))),f=s.default.createElement("div",{key:"62",className:"clearfix",style:[x.default.cashBox,x.default.borderBottom]},s.default.createElement("label",{style:x.default.cashLabel},"CVV2"),s.default.createElement("p",{style:x.default.cashBoxP},s.default.createElement("input",{style:[x.default.cashInput,x.default.rightInput],type:"number",placeholder:"",ref:"cvv2"})))),n=s.default.createElement("div",{key:"6",className:"clearfix",style:[x.default.cashBox,x.default.borderBottom]},s.default.createElement("label",{style:x.default.cashLabel},"充值金额"),s.default.createElement("p",{style:x.default.cashBoxP},s.default.createElement("input",{style:[x.default.cashInput,x.default.rightInput],type:"number",placeholder:"",ref:"deposit_value"}))),u=s.default.createElement("div",{className:"m-t m-l small text-muted"}," 单次充值至少1元,最多2000元,每日累计10000元")):u=s.default.createElement("div",{className:"m-t m-l small text-muted"}," 提示:绑定时可能会从卡里扣1分钱充入您的脉脉账户"),s.default.createElement("div",null,s.default.createElement(_.default,{title:this.props.deposit?"银行卡充值":"添加银行卡"}),s.default.createElement("div",{style:x.default.cashBankCardWrap},s.default.createElement("div",{key:"0",className:"clearfix",style:[x.default.cashBox,x.default.borderBottom]},s.default.createElement("label",{style:x.default.cashLabel},"银行卡号"),s.default.createElement("p",{style:x.default.cashBoxP},s.default.createElement("input",{style:[x.default.cashInput,x.default.rightInput,x.default.disableBg],type:"number",placeholder:"",ref:"card_numb",disabled:"disabled",value:this.props.cardnum}))),i,d,o,s.default.createElement("div",{key:"4",className:"clearfix",style:[x.default.cashBox,x.default.borderBottom]},s.default.createElement("label",{style:x.default.cashLabel},"银行预留手机号"),s.default.createElement("p",{style:x.default.cashBoxP},s.default.createElement("input",{style:[x.default.cashInput,x.default.rightInput],type:"number",placeholder:"",ref:"mobile"}))),c,f,s.default.createElement("div",{key:"5",style:[x.default.identifyBox,x.default.borderBottom]},s.default.createElement("input",{style:x.default.cashInput,type:"number",placeholder:"验证码",ref:"code"}),s.default.createElement("a",{href:"javascript:void(0)",onClick:this.onRequestVerify,style:x.default.getIdentify},"获取验证码",this.props.cursor.select("request_verify_time").get()?"("+this.props.cursor.select("request_verify_time").get()+")":"")),n,u),s.default.createElement("div",{style:x.default.nextBtn,onClick:this.onValidData},"下一步"),a)}});e.exports=(0,b.default)(S)}});