webpackJsonp([9],{1145:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(77),r=function(e){return e&&e.__esModule?e:{default:e}}(n);t.default=e.exports=function(e,t,a){var n=1;r.default.showProgressDialog(e),t.then(function(e){1==n&&r.default.hideProgressDialog(),n=2,!a&&e&&r.default.toast(e)}).catch(function(e){1==n&&r.default.hideProgressDialog(),n=2,r.default.toast(e)})}},1433:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l,s,c,u=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),d=a(75),f=n(d),_=a(17),p=n(_),m=a(1),h=n(m),g=a(15),y=n(g),v=a(77),w=n(v),b=a(1145),k=n(b),E=(s=l=function(e){function t(e){r(this,t);var a=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));c.call(a);var n=parseInt(21*Math.random());return 17!=n&&18!=n||(n=0),a.state={word:"",textarea_sub:"最多240字",defined_bg_url:"",default_bg_num:n,high_light:!1},a}return o(t,e),u(t,[{key:"componentDidMount",value:function(){window.upload_callback=this.upload_callback}},{key:"render",value:function(){var e="/static/images/ny_2016/ny_word_bg"+this.state.default_bg_num+".jpg",t=this.state.defined_bg_url.length>0;return h.default.createElement("div",{className:"white-bg ny_border_radius_6"},h.default.createElement("div",{className:"ny_edit_bg_wrap p-relative w-100 o-hidden"},h.default.createElement("div",{className:"ny_edit_bg"},h.default.createElement("img",{style:{maxWidth:500},src:t?this.state.defined_bg_url:e})),!t&&h.default.createElement("div",{className:"ny_edit_bg_cover"}),h.default.createElement("div",{className:"ny_input_word"},h.default.createElement("div",{className:"ny_input_word_bg"},h.default.createElement("img",{className:"w-100",src:"/static/images/ny_2016/ny_tian.png"}),h.default.createElement("div",{className:"ny_input_word_bg_animate"}),h.default.createElement("input",{className:"ny_input_word_text",placeholder:"述",ref:"word",onCompositionEnd:this.handleComposition,type:"text"})),h.default.createElement("div",{className:"text-center text-black-3 font-13 p-y-5"},"点击田字格，输入一个汉字"),MaiMai_Native.native_upload_image&&h.default.createElement("div",{className:"ny_camera",onClick:this.uploadImg}))),h.default.createElement("div",{className:"ny_edit_textarea_wrap"},h.default.createElement("textarea",{onChange:this.textChange,className:"ny_edit_textarea",ref:"txt",placeholder:"关于"+this.props.year+", 我想说..."}),h.default.createElement("div",{className:"ny_edit_textarea_sub"},this.state.textarea_sub)),h.default.createElement("div",{className:"text-center p-y-5",onClick:this.publish},h.default.createElement("span",{className:"ny_pub_btn",style:{color:this.state.high_light?"#0ba0ff":""}},"发布")))}}]),t}(h.default.Component),c=function(){var e=this;this.publish=p.default.debounce(function(){var t=(e.refs.word.value||"").trim(),a=e.refs.txt.value||"",n=e.state.default_bg_num;if(!t||t.length>1)return void w.default.toast("请在田字格输入一个汉字");if(0==a.length)return void w.default.toast("请输入描述内容");if(a.length>240)return void w.default.toast("描述内容最多240个字");var r=e.props,i=r.avatar,o=r.u,l=r.name,s=r.req,c=s.query?s.query.shareid:"",u=s.query?s.query.wxtoken:"",d=s.query.fr,_=e.state.defined_bg_url,p=e.props.year,m=void 0;if(e.props.regSuccU&&e.props.regSuccToken&&e.props.regSuccEnuid){var h=e.props.regSuccU,g=e.props.regSuccEnuid,v=e.props.regSuccToken,b=e.props.regSuccName;m="/sdk/article/pub_word?"+y.default.stringify({uid:g,token:v,uinfo:h,word:t,text:a,avatar:i,name:b,shareid:c,wxtoken:u,default_bg_num:n,defined_bg_url:_,year:p,fr:d})}else m="/sdk/article/pub_word?"+y.default.stringify({uinfo:o,word:t,text:a,avatar:i,name:l,shareid:c,wxtoken:u,default_bg_num:n,defined_bg_url:_,year:p,fr:d});var E=fetch(m,{credentials:"same-origin"}).then(f.default.parse_online_json).then(function(t){e.props.cursor.select("data","feed").unshift(t.feed),w.default.dismiss(),e.props.showPubImg()}).catch(f.default.toast_error_handler);(0,k.default)("发送中",E)},500),this.textChange=function(t){var a=t.target.value.length,n=240-a,r="剩余"+n+"字";a<=240?(r=a+"/240",e.setState({textarea_sub:a>0?r:"最多240字",high_light:a>0})):a>240?(t.target.value=t.target.value.substring(0,240),e.setState({textarea_sub:"240/240",high_light:!0})):e.setState({textarea_sub:"最多240字",high_light:!1})},this.upload_callback=function(t){e.props.is_ios&&MaiMai_Native.show_dialog_bg();var a=JSON.parse(t);e.setState({defined_bg_url:a.url})},this.uploadImg=function(){if(MaiMai_Native.native_upload_image){var t={type:2,compress:.6,security:1};MaiMai_Native.native_upload_image(JSON.stringify(t),"upload_callback"),e.props.is_ios&&MaiMai_Native.hide_dialog_bg()}},this.handleComposition=function(e){if("compositionend"==e.type&&e.target.value.length>1){var t=e.target.value.split("");e.target.value=t.slice(0,1)}}},s);t.default=e.exports=E},1434:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l,s,c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},u=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),d=a(1),f=n(d),_=a(77),p=n(_),m=a(169),h=n(m),g=a(17),y=n(g),v=a(75),w=n(v),b=a(15),k=n(b),E=a(78),x=n(E),N=a(167),S=a(277),M=a(76),j=a(276),P=(s=l=function(e){function t(e){r(this,t);var a=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.getImgHeight=function(e,t,a){return a/t*e},a.onShareWXFriend=y.default.debounce(function(){if(a.checkShareInterface()){var e=a.props.item;window.MaiMai_Native.native_share_v2&&window.MaiMai_Native.native_share_v2(4,JSON.stringify({icon_url:e.tmp_image,share_wx_type:2,title:e.title,desc:e.text})),(0,S.pingback)("oneyear","share_wxf")}},500,!0),a.onShareWX=y.default.debounce(function(){if(a.checkShareInterface()){var e=a.props.item;window.MaiMai_Native.native_share_v2&&window.MaiMai_Native.native_share_v2(3,JSON.stringify({icon_url:e.tmp_image,share_wx_type:2,title:e.title,desc:e.text})),(0,S.pingback)("oneyear","share_wx")}},500,!0),a.checkShareInterface=function(){var e=a.context.auth_info,t=e.channel;return"AppStore"==t||"Development"==t||"InHouse"==t||"InHouseDev"==t||"develop"==t||(!j.lt(e.version,"4.15.7")||(M("请下载最新版本客户端分享~"),!1))},a.showImg=function(e){var t=a.context.env,n=a.props.item,r=!!window.MaiMai_Native.native_share_v2,i={show:e&&!t.from_pc},o=(0,h.default)().width>500?500:(0,h.default)().width-40,l=(0,h.default)().height,s=l-(r?135:90),c=r?900:1138,u=a.getImgHeight(o,750,c),d=r?n.image[0].url:n.tmp_image,_=function(){if(!r||!i.show)return void p.default.dismiss();p.default.dismiss(),setTimeout(function(){(0,S.pingback)("oneyear","scshow"),(0,N.showModalForConfirm)({title:"太走心了！与朋友一起分享你的感悟吧！",ok:function(){a.onShareWX(),(0,S.pingback)("oneyear","sc_ok")},cancel:function(){(0,S.pingback)("oneyear","sc_cancel")},ok_text:"立即分享",cancel_text:"放弃"})},500)};p.default.popup2({content:f.default.createElement("div",{style:{width:o}},f.default.createElement("div",{className:"text-right font-0 m-b-10",onClick:_},f.default.createElement("span",{className:"ny_close_pop"})),f.default.createElement("div",{className:"ny_view_word",style:{height:u>s?s:u}},f.default.createElement("img",{className:"mw-100 ny_border_radius_6",src:d})),!t.from_pc&&f.default.createElement("div",{className:"text-center text-white m-t-10",style:{display:r?"block":"none"}},f.default.createElement("div",{className:"ny_wechat_wrap m-r",onClick:function(){a.onShareWXFriend(),i.show=!1}},f.default.createElement("span",{className:"ny_wechat"}),f.default.createElement("br",null),f.default.createElement("span",null,"微信好友")),f.default.createElement("div",{className:"ny_wecircle_wrap m-l",onClick:function(){a.onShareWX(),i.show=!1}},f.default.createElement("span",{className:"ny_wecircle"}),f.default.createElement("br",null),f.default.createElement("span",null,"朋友圈"))),!r&&f.default.createElement("div",{className:"ny_save_text text-center m-t-10"},"长按图片保存")),page_from:"word_activity"}).catch(function(){_()})},a.onLikeClicked=y.default.debounce(function(){console.log("like clicked ");var e=a.context,t=e.auth_info,n=e.fconf,r=e.req,i=a.props,o=i.cursor,l=i.item,s=r.query.fr,u=t.u;t.u<=0&&(u="gqt"==s?78606:"wb"==s?140987620:"sogo"==s?140987606:78585),1==l.mylike?(a.setState({mylike:0,show_add_one:!1,likes:a.state.likes-1}),o.select("mylike").set(0),o.select("likes").set(l.likes-1)):(a.setState({mylike:1,show_add_one:!0,likes:a.state.likes+1}),o.select("mylike").set(1),o.select("likes").set(l.likes+1));var d=t.u<0?"/sdk/article/like_from_out?":n.online_url+"feed/v3/like?",f=d+k.default.stringify(c({fid:l.id,like:1==l.mylike?0:1},t,{uinfo:u}));fetch(f,{credentials:"same-origin"}).then(w.default.parse_online_json).then(function(e){}).catch(function(e){})},500,!0),a.gotoDetail=function(e){var t=a.context.auth_info;!t||t.u<0||"78606"!=a.props.item.uinfo.id&&(e.stopPropagation(),(0,x.default)(a.props.item.uinfo.id,a.context))},a.componentDidMount=function(){a.props.showpop&&a.showImg()},a.state={mylike:a.props.item.mylike,show_add_one:!1,likes:a.props.item.likes},a}return o(t,e),u(t,[{key:"render",value:function(){var e=this,t=(this.context.auth_info,this.props.item),a=["ny_item1","ny_item2","ny_item3","ny_item4","ny_item5"],n=a[t.id%5];return f.default.createElement("div",{className:"halfWidth fl ny_item_wrap",onClick:function(t){t.stopPropagation(),e.showImg()}},f.default.createElement("div",{className:"ny_item "+n},f.default.createElement("div",{className:"clearfix",onClick:this.gotoDetail},f.default.createElement("div",{className:"ny_avatar"},f.default.createElement("img",{className:"radius-50 mw-100",src:t.uinfo.avatar})),f.default.createElement("div",{className:"ny_name"},t.uinfo.name)),f.default.createElement("div",{className:"ny_word"},t.title),f.default.createElement("div",{className:"ny_text_summary"},t.text),f.default.createElement("div",{className:"clearfix"},f.default.createElement("div",{className:"fl p-relative",onClick:function(t){t.stopPropagation(),e.onLikeClicked(t)}},this.state.show_add_one&&f.default.createElement("div",{className:"light_tag_add_one"},f.default.createElement("span",{className:"ny_like_icon_red ny_add_one"},"+1")),f.default.createElement("span",{className:"font-13 "+(this.state.mylike?"ny_like_icon_red":"ny_like_icon")},this.state.likes>0?this.state.likes+"赞":"")),f.default.createElement("div",{className:"fr font-0"},f.default.createElement("span",{className:"ny_share_icon"})))))}}]),t}(f.default.Component),l.contextTypes={auth_info:f.default.PropTypes.object,req:f.default.PropTypes.object,env:f.default.PropTypes.object,fconf:f.default.PropTypes.object},s);t.default=e.exports=P},296:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l,s,c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},u=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),d=a(1),f=n(d),_=a(75),p=n(_),m=a(77),h=n(m),g=a(1433),y=n(g),v=a(1434),w=n(v),b=a(169),k=n(b),E=a(165),x=n(E),N=a(15),S=n(N),M=a(1034),j=a(983),P=(n(j),a(170)),O=n(P),C=a(114),I=n(C),T=a(76),q=n(T),D=a(981),W=a(982);t.default=e.exports=(s=l=function(e){function t(){r(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.isShowEdit=function(){return!0},e.showPubImg=function(){e.pubItem&&setTimeout(function(){return e.pubItem.showImg(!0)},200)},e.regSuccCallBack=function(t,a,n,r){e.setState({reg_succ_enuid:t,reg_succ_u:a,reg_succ_token:n,reg_succ_name:r}),e.showEdit()},e.showEdit=function(){var t=e.context,a=t.auth_info,n=t.env;if(a.u<0&&n.from_pc&&!e.state.reg_succ_token&&!e.state.reg_succ_u&&!e.state.reg_succ_enuid&&(0,M.launch_pc_pop_register)({frm:"wordactivity2017"},"","","",e.regSuccCallBack),!n.from_pc||!e.props.outapp||e.state.reg_succ_token||e.state.reg_succ_u||e.state.reg_succ_enuid){var r=(0,k.default)().width>500?500:(0,k.default)().width-40,i=e.context.auth_info.channel,o="AppStore"==i||"Development"==i||"InHouse"==i||"InHouseDev"==i;h.default.popup2({content:f.default.createElement("div",{style:{width:r}},f.default.createElement("span",{className:"ny_close_pop ny_close_pop_absolute",onClick:function(){h.default.dismiss()}}),f.default.createElement("div",{className:"white-bg ny_border_radius_6"},f.default.createElement(y.default,c({},e.props,{regSuccU:e.state.reg_succ_u,regSuccEnuid:e.state.reg_succ_enuid,regSuccToken:e.state.reg_succ_token,regSuccName:e.state.reg_succ_name,req:e.context.req,showPubImg:e.showPubImg,is_ios:o})))),page_from:"word_activity"})}},e.renderItemCell=function(t,a,n,r){return f.default.createElement(w.default,{key:t.id,item:t,cursor:a,showpop:t.id==r,ref:function(t){0==n&&(e.pubItem=t)}})},e.loadMore=function(){var t=e.context.req,a=e.props,n=a.cursor,r=a.u,i=a.year,o=t.query?t.query.wxtoken:"",l="/sdk/article/get_words?"+S.default.stringify({count:20,page:e.nextPage,uinfo:r,wxtoken:o,year:i,fr:t.query.fr});e.refs.loader.bindRequest(function(){return fetch(l,{credentials:"same-origin"}).then(p.default.parse_online_json).then(function(t){0==e.nextPage?n.select("data").set(t):n.select("data","feed").concat(t.feed),e.nextPage++}).catch(function(e){p.default.toast_error_handler(e)})})},e.onSpread=function(){var t=e.context,a=t.fconf,n=t.auth_info,r=a.online_url+"feed/v3/add?"+S.default.stringify(c({text:"我分享了一个活动，快来参与吧",card_type_str:"career_test",card_avatar:"https://maimai.cn/static/images/oneyear_word.png",card_target:"https://maimai.cn/article/word_activity_2017?fr=mm_share",card_text:"# 字述一年 #给你一个字的时间，想对你的2017说些什么？",hash:O.default.generateFeedHash()},n)),i=fetch(r).then(O.default.parse_online_json).then(function(){(0,q.default)("分享成功")}).catch(p.default.toast_error_handler);(0,I.default)("分享中..",i)},e.renderClientMsg=function(){return f.default.createElement("div",null)},e.nextPage=1,e.state={reg_succ_u:"",reg_succ_token:"",reg_succ_enuid:"",reg_succ_name:""},e}return o(t,e),u(t,null,[{key:"hideLogin",value:function(){return!0}}]),u(t,[{key:"componentDidMount",value:function(){this.context.env.wechat&&this.isShowEdit()&&this.showEdit(),window.onSpread=this.onSpread}},{key:"componentWillReceiveProps",value:function(e,t){if(!this.props.wx_sdk_inited&&e.wx_sdk_inited){var a={title:"#脉脉 2017字述一年#",desc:"我用这个“字”形容了我的2017，你呢？用一个字，和2017告个别吧",link:window.location.origin+window.location.pathname+"?fr=wx_share",imgUrl:"https://maimai.cn/static/images/oneyear_word.png",success:function(){},cancel:function(){}};t.wx_sdk.onMenuShareAppMessage(a),t.wx_sdk.onMenuShareTimeline(a),t.wx_sdk.onMenuShareQQ(a),t.wx_sdk.onMenuShareQZone(a)}}},{key:"render",value:function(){var e=this,t=this.context.req,a=this.props,n=a.cursor,r=a.data,i=a.feedid,o=a.year,l=!(r&&r.feed.length>=r.all),s="/static/images/ny_2016/ny_banner"+(2017==o?3:2)+".jpg";return"gqt"==t.query.fr&&(s="/static/images/ny_2016/ny_banner4.jpg"),f.default.createElement("div",null,f.default.createElement(D,{title:"#脉脉 2017字述一年#"}),this.renderClientMsg(),f.default.createElement("div",{className:"ny_info"},f.default.createElement("div",{className:"font-0 w-100"},f.default.createElement("img",{className:"mw-100",src:s})),f.default.createElement("div",{className:"p-x-20 p-y text-muted text-justify"},"如果只有一个字的时间，你准备怎么告别",o,"？你可以孜孜不倦，矢志不渝；你不能营营役役，虚度光阴；你需要珍惜当下，不负时光；你应该奋力求索，砥砺前行……无论时代如何变迁、风云如何变幻，想赢？凭自己！")),f.default.createElement("div",{className:"ny_gray_line"}),f.default.createElement("div",{className:"ny_list clearfix"},this.isShowEdit()&&f.default.createElement("div",{className:"halfWidth fl ny_item_wrap"},f.default.createElement("div",{className:"ny_item ny_edit_btn",onClick:this.showEdit},f.default.createElement("div",{className:"ny_man"},f.default.createElement("img",{src:"/static/images/ny_2016/ny_man.png"})),f.default.createElement("div",{className:"text-center"},f.default.createElement("span",{className:"say_something_icon"},"说说我的",o)))),f.default.createElement(W,{loadMore:this.loadMore,hasMore:l,threshold:30,loader:f.default.createElement(x.default,{ref:"loader",reload:this.loadMore,cursor:n.select("loading_status")})},r&&r.feed.map(function(t,a){return e.renderItemCell(t,n.select("data","feed",a),a,i)}))))}}]),t}(f.default.Component),l.contextTypes={auth_info:f.default.PropTypes.object,req:f.default.PropTypes.object,fconf:f.default.PropTypes.object,env:f.default.PropTypes.object,wx_sdk:f.default.PropTypes.object},l.hideHeader=!0,s)}});