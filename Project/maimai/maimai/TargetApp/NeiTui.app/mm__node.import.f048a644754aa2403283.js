webpackJsonp([57],{1140:function(e,t,r){"use strict";var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},n=r(984),s=r(1),o=r(17),l=r(15),i=(r(985)("app"),r(991),r(90)),c=r(75),d=(r(114),r(41)),f=r(115).launch_webview,u=r(46),p=r(116),m=r(168),h=r(999);e.exports=s.createClass({displayName:"exports",mixins:[d],contextTypes:{auth_info:s.PropTypes.object,fconf:s.PropTypes.object},showFeedDetail:o.debounce(function(){var e=this.props.feed,t=this.context,r=t.auth_info,n=t.fconf;if(r.u>0){var s=e.feed.text;if(s&&s.length>250&&"operation_topic"!=e.feed.data_str?u("/article/detail?fid="+e.fid,"查看全文","fetch"):h(e.fid),e.feed.search_qs&&e.feed.search_order){var o=n.online_url+"search/web/s_pb?"+l.stringify(a({srcu:r.u,type:"feed",targetid:e.feed.id,order:e.feed.search_order,qs:e.feed.search_qs},r));fetch(o)}}else f()},1e3,!0),like:function(e){var t=this;e.stopPropagation();var r=this.props,n=r.feed,s=r.cursor,o=this.context,i=o.auth_info,d=o.fconf;if(s&&i.u>0)try{var u=n.me_like;this.props.cursor.select("me_like").set(1==u?0:1);var p=n.feed.likes;this.props.cursor.select("feed","likes").set((1==u?-1:1)+p);var m=d.online_url+"feed/v3/like?"+l.stringify(a({fid:this.props.feed.fid,like:1==u?0:1},i));fetch(m).then(c.parse_online_json).catch(c.toast_error_handler).catch(function(e){t.props.cursor.select("me_like").set(u),t.props.cursor.select("feed","likes").set(p)})}catch(e){alert(e)}else i.u<0&&f()},gotoDetail:function(e){this.refs.avatar.gotoDetail(e)},renderZKP:function(){var e=this.props.feed,t="";if(e.feed.likes>0&&(t=" "+e.feed.likes+" 赞"),0==t.length)return null;var r=" ";return e.feed.pics.length>1&&(r=e.feed.pics.length+" "),s.createElement("p",null,s.createElement("span",{className:"pull-right",style:{marginTop:"5px"}},e.feed.pics.length>0&&s.createElement("span",{className:"text-muted small"},r,s.createElement("img",{src:"/static/images/album-circle.png",style:_.album})),s.createElement("span",{className:"text-muted small"},t)))},render:function(){var e,t=this.props.feed,r=p.getCareer(t.contact);e=r?" | "+r:"";var a=t.feed.summary||t.feed.richtext||t.feed.text;return t.feed.pics&&(t.feed.pics.length>1&&!a?a="发布了"+t.feed.pics.length+"张图片":1!=t.feed.pics.length||a||(a="发布了图片")),s.createElement("li",{className:"list-group-item clearfix",onClick:this.showFeedDetail},s.createElement("div",{className:"media"},s.createElement("div",{className:"media-left"},s.createElement(m,{ref:"avatar",customClass:"topic-avatar",card:t.contact,image_id:this.props.image_id})),s.createElement("div",{className:"media-body"},s.createElement("div",{className:"lineClamp1",style:{marginBottom:"6px"}},s.createElement("span",{className:"text-primary",onClick:this.gotoDetail},t.contact.name),s.createElement("span",{className:"text-info small"},e),1==t.contact.judge&&s.createElement("span",{className:"add_v_img"})),s.createElement("p",{style:(0,n.textOverflow)(4)},s.createElement(i,{text:a,support_dref:!0})),t.d1_spread_cards&&t.d1_spread_cards.length>0&&o.first(t.d1_spread_cards,3).map(function(e){return s.createElement(m,{customClass:"friend_img",card:e})}),t.d1_spread_count>1&&s.createElement("span",{className:"friend_tips text-muted small"},t.d1_spread_count,"个好友分享了这条动态"),1==t.d1_spread_count&&s.createElement("span",{className:"friend_tips text-muted small"},t.d1_spread_cards[0].name,"分享了这条动态 "),this.renderZKP())))}});var _={heading:{marginTop:-10,marginLeft:-20,marginRight:-20},like:{marginBottom:3},avatarSize:{width:42,height:42,WebkitBorderRadius:"2px"},img:{width:"14px",height:"14px",marginBottom:"4px"},album:{width:"18px",height:"18px",marginTop:"-1px"},tableCell:{display:"table-cell"},zanBox:{display:"table-cell",textAlign:"center",verticalAlign:"middle",width:50}}},1142:function(e,t,r){"use strict";var a=r(17);e.exports.generateCell=function(e){return{avatar:e.avatar.length>0?e.avatar:"/static/images/mailogo.png",line1:e.profession_name+(e.major_name&&e.major_name.length>0?"|"+e.major_name:e.major_name),line2:e.desc,selected:e.enabled,profession:e.profession,major:e.major}},e.exports.isFollowed=function(e,t,r){if(e&&e.length>0){var n=a.find(e,function(e){return e.id==t});if(n&&n.majors&&n.majors.length>0){return!!a.find(n.majors,function(e){return e.id==r})}}return!1}},707:function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l,i,c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},d=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),f=r(1),u=a(f),p=r(75),m=a(p),h=r(76),_=a(h),g=r(981),v=a(g),y=r(15),b=a(y),x=r(1140),E=a(x),w=r(46),j=a(w),q=r(117),k=a(q),N=r(113),O=(r(115),r(165)),P=a(O),C=r(90),T=(a(C),r(986)),B=(a(T),r(1141)),M=(a(B),r(17)),D=a(M),R=r(170),A=(a(R),r(279)),F=a(A),S=r(114),W=a(S),z=r(988),K=a(z),V=r(1142),Z=a(V),J=r(982);t.default=e.exports=(i=l=function(e){function t(){var e,r,a,o;n(this,t);for(var l=arguments.length,i=Array(l),d=0;d<l;d++)i[d]=arguments[d];return r=a=s(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),a.send=D.default.debounce(function(e){if(e&&(e.preventDefault(),e.stopPropagation()),a.props.disable_cancel)return void(0,_.default)("不支持取消关注");var t=void 0;if(2==a.props.dist){t="user/v3/update_config";var r=!a.props.follow,n={feed_d1d2:r?0:1};a.doRequest(t,n,function(){a.props.cursor.select("follow").set(r),n.follow=r,n.dist=a.props.dist,(0,N.sendWebViewBroadcast)("article_pm_feed_follow",n),(0,_.default)(r?"关注成功":"取消关注成功")})}else{t=a.props.follow?"feed/v3/priority_remove":"feed/v3/priority_add";var n={profession:a.props.profession,major:a.props.major};a.doRequest(t,n,function(e){var t=!a.props.follow;a.props.cursor.select("follow").set(t),e&&e.r&&(n.cell=Z.default.generateCell(e.r)),n.follow=t,(0,N.sendWebViewBroadcast)("article_pm_feed_follow",n),(0,_.default)(t?"关注成功":"取消关注成功")})}},1e3),a.doRequest=function(e,t,r){var n=a.context,s=n.auth_info,o=n.fconf;D.default.extend(t,s);var l=o.online_url+e+"?"+b.default.stringify(t),i=fetch(l,{credentials:"same-origin"}).then(m.default.parse_online_json).then(function(e){r(e)}).catch(m.default.toast_error_handler);(0,W.default)("设置中...",i)},a.loadMore=function(){try{var e=a.context.req,t=a.props,r=t.feeds,n=t.cursor,s=e.pathname+"?"+b.default.stringify(c({},e.query,{skip:r.length,jsononly:1}));fetch(s,{credentials:"same-origin"}).then(p.parse_online_json).then(function(e){e.data.feeds&&e.data.feeds.length>0?n.select("feeds").concat(e.data.feeds):n.select("end").set(1)}).catch(alert)}catch(e){alert(e)}},a.p_rank0_list=function(){var e=a.context.req;if(e.query.m>=0){var t="/contact/pm_rank0_list?"+b.default.stringify({p:e.query.p,m:e.query.m});(0,j.default)(t,(0,F.default)(e.query.p,e.query.m,"|","fetch"))}},o=r,s(a,o)}return o(t,e),d(t,[{key:"render",value:function(){var e=this.props.feeds,t=this.context.req;if(!t.query.dist&&t.query.m>=0)var r=(0,F.default)(t.query.p,t.query.m,"｜"),a="近期热门动态",n="关注“"+r+"”，了解行业牛人都在说什么";else if(t.query.dist){if(1==t.query.dist)var r="好友",a="近期热门动态",n="展示好友发布和分享的动态，不可取消关注";else if(2==t.query.dist)var r="人脉",a="近期热门动态"}else var r=(0,F.default)(t.query.p,0).profession,a="近期热门动态";return u.default.createElement("div",null,u.default.createElement(v.default,{title:r}),u.default.createElement(J,{hasMore:!this.props.end,loadMore:this.loadMore,loader:u.default.createElement(P.default,{ref:"loader",reload:this.loadMore,cursor:this.props.cursor.select("loading_status")})},u.default.createElement("div",{className:"panel panel-default"},n&&u.default.createElement("div",{className:"topicSummary m-t"},u.default.createElement("span",{className:"text-muted"},n)),u.default.createElement("div",{className:"panel-heading"},u.default.createElement("span",{className:"text-muted"},a)),u.default.createElement("ul",{className:"list-group"},e.map(function(e){return u.default.createElement(E.default,{key:e.feed.uid,feed:e})})))),u.default.createElement("div",{style:{height:30}}),(t.query.dist||t.query.m>=0)&&u.default.createElement(K.default,{btns:[this.props.follow?"取消关注":"关注"],actions:[this.send]})||null)}}]),t}(u.default.Component),l.contextTypes={req:u.default.PropTypes.object,fconf:u.default.PropTypes.object,auth_info:u.default.PropTypes.object},i);k.default.Constants.large}});