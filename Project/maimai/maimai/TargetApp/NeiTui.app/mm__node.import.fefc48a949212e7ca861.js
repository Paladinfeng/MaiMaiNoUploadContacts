webpackJsonp([180],{895:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i,c,u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),f=r(1),d=n(f),p=r(75),m=r(15),v=n(m),y=r(273),h=n(y),_=r(165),g=n(_),b=r(271),E=n(b),P=r(164),j=r(272),x=n(j),k=r(981),w=(r(50),r(46)),q=r(982),O=(r(63),r(990),r(17)),M=r(116),T=r(983);t.default=e.exports=(c=i=function(e){function t(){var e,r,n,l;o(this,t);for(var i=arguments.length,c=Array(i),u=0;u<i;u++)c[u]=arguments[u];return r=n=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),n.loadMore=function(e){var t=n.context,r=(t.fconf,t.req,t.auth_info,n.props),o=r.cursor,a=(r.searchTokens,n.refs.loader);a&&a.bindRequest(function(){var e=20*n.nextPage,t="/service/srvlist_ent?"+v.default.stringify(O.extend({type:"d1"},{limit:20,offset:e,jsononly:1}));return fetch(t,{credentials:"same-origin"}).then(p.parse_online_json).then(function(e){o.select("srvlist","services").concat(e.data.services),o.select("srvlist","more").set(e.data.more),n.nextPage++})})},n.goPub=function(){var e=n.context.req;w("/service/pub?"+v.default.stringify({from:"srvlist_"+e.query.type}),"发布服务","fetch")},n.openDetail=function(e){var t=this.context.req;w("/service/detail?"+v.default.stringify({id:e,from:"srvlist_"+t.query.type}),"服务详情","fetch")},l=r,a(n,l)}return l(t,e),s(t,[{key:"componentDidMount",value:function(){this.nextPage=1,window.goPub=this.goPub,window.close_page=function(){(0,P.closePage)("",!0)}}},{key:"componentWillUnmount",value:function(){}},{key:"renderAppMessage",value:function(){var e=u({},x.default);return e.top_right_item={title:"完成",callback:"close_page()"},d.default.createElement(T,{msg_to_app:e})}},{key:"renderHeader",value:function(){var e=this.context.req,t="支付成功,请等待接单",r="3个工作日对方未处理将自动退款";return 1==e.query.for_member&&(t="已预约,请等待通过",r="3个工作日未及时处理会退还预约额度"),d.default.createElement("div",{className:"header borderBottom"},d.default.createElement("div",{style:{fontSize:"17px"}},t),d.default.createElement("div",{style:{fontSize:"14px",color:"#11c679",marginTop:"4px"}},r))}},{key:"render",value:function(){var e=this,t=this.props.srvlist,r=t.services,n=t.more,o=(t.page_title,this.props.cursor),a=this.context,l=a.req,i=a.auth_info;if(void 0===r)return d.default.createElement("div",null);if(this.props.loading||this.props.failed)return d.default.createElement(g.default,{ref:"loading",reload:this.onReload,failed:this.props.failed});var c=[];c.push({title:"发布服务",callback:"goPub()"});var u={};u.more_items=c,u.keep_default_items=0;var s="支付成功";return 1==l.query.for_member&&(s="提交成功"),d.default.createElement("div",{className:"add_friend_requested"},i.u>0&&d.default.createElement(T,{msgd_to_app:u}),d.default.createElement(k,{title:s}),this.renderAppMessage(),this.renderHeader(),!(1==l.query.for_member)&&d.default.createElement(E.default,{title:"您还可以看看好友的服务",btn:null,onClick:null,icon_classname:"glyphicon glyphicon-pencil"},d.default.createElement(q,{loadMore:function(){e.loadMore(1)},hasMore:1==n,loader:d.default.createElement(g.default,{ref:"loader",reload:function(){e.loadMore(2)},cursor:o.select("srvlist","loading_status")})},d.default.createElement("div",{className:"panel panel-default"},d.default.createElement("ul",{className:"list-group"},r.map(function(t,r){var n=M.getCareer(t.contact,""),o=t.price_desc+"    "+t.paynum+"人购买",a="发布人："+t.contact.name+(n?" | "+n:"");return d.default.createElement(h.default,{key:t._id,avatar:t.contact.avatar,line1:t.title,line2:o,line3:a,judge3:t.contact.judge,clickHandler:function(){e.openDetail(t._id)}})}))))))}}]),t}(d.default.Component),i.contextTypes={req:d.default.PropTypes.object,fconf:d.default.PropTypes.object,auth_info:d.default.PropTypes.object},c)}});