webpackJsonp([22],{1098:function(e,t,r){"use strict";function n(){this.currentPage=0,this.data={},this.hasMore=!0,this.requesting=!1,this.cursor_status=0,this.firstload=0}function i(){var e={current_tabindex:0,tabs:[]},t=new n;t.data.videos=[],e.tabs.push(t);var t=new n;return t.data.hist=[],e.tabs.push(t),e}e.exports.TabEnum={hotlive:0,history:1},e.exports.tab_manager=i},1161:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var i=r(1),s=n(i),a=r(50),o=(n(a),r(46)),u=(n(o),r(113),r(63)),l=n(u),c=r(168),f=(n(c),r(284)),d=n(f),m=r(116),h=n(m),p=s.default.createClass({displayName:"LiveHistory",getInitialState:function(){return{}},componentDidMount:function(){},componentWillUnmount:function(){},render:function(){var e=this,t=this.props,r=t.videos;return 1!=t.first_load||r&&0!=r.length?s.default.createElement("div",null,r&&r.map(function(t){return s.default.createElement(d.default,{component:"li",className:"list-group-item",pressDelay:800,key:t.id,onClick:function(r){return e.liveHotClick(t)},style:{textAlign:"left"}},s.default.createElement("div",{className:"media list-group-item-heading list-group-item-text"},s.default.createElement("div",{className:"media-left"},s.default.createElement("img",{className:"media-object cursor-pointer",style:v.img_size,src:t.avatar}),s.default.createElement("div",{className:"live-hot-item-container"},s.default.createElement("div",{className:"live-hot-item-status"},t.tip))),s.default.createElement("div",{className:"media-body live-hotitem-right",style:v.right_container},s.default.createElement("div",{className:"text-muted small",style:v.title},t.title),s.default.createElement("div",{style:v.follow,className:"text-muted small"},t.subcnt,"人关注"),s.default.createElement("div",{style:v.positon_container},s.default.createElement("span",{style:v.name},l.default.mark(e,t.name)),s.default.createElement("span",{style:v.career}," | ",l.default.mark(e,h.default.getCareer(t))),1==t.judge&&s.default.createElement("span",{className:"add_v_img"})))))})):s.default.createElement("div",{style:{marginTop:50,height:80},className:"text-primary text-center"},"还没有热门职播哦")},liveHotClick:function(e){this.props.onClick(e)}}),v={img_size:{with:80,height:80},right_container:{marginLeft:20,marginRight:10},title:{fontSize:14,marginTop:5,color:"#232323"},follow:{fontSize:13,marginTop:5,color:"#A1A1A1"},positon_container:{marginTop:5},name:{fontSize:13,marginTop:5,color:"#5b7797"},career:{fontSize:13,marginTop:5,color:"#A1A1A1"},children:{paddingTop:5,paddingRight:10}};e.exports=p},1162:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(1),l=n(u),c=r(47),f=n(c),d=(r(115),r(15)),m=n(d),h=function(e){function t(){var e,r,n,a;i(this,t);for(var o=arguments.length,u=Array(o),l=0;l<o;l++)u[l]=arguments[l];return r=n=s(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.gotoRegister=function(){var e="http://maimai.cn/show2?"+m.default.stringify({regfr:"livevideo_bottom"});window.location=e},a=r,s(n,a)}return a(t,e),o(t,[{key:"componentDidMount",value:function(){window.screen.height,f.default.findDOMNode(this.refs.articleBottom)}},{key:"render",value:function(){return l.default.createElement("div",{ref:"articleBottom",className:"livevideoBottomWrap",onClick:this.gotoRegister},l.default.createElement("div",{className:"p-relative articleBottomBox"},l.default.createElement("div",{className:"articleBottomBg"}),l.default.createElement("div",{className:"articleBottom p-absolute text-white"},l.default.createElement("div",{className:"media-left p-r-10"},l.default.createElement("div",{className:"articleBottomAvatar"},l.default.createElement("img",{className:"w-100 radius-50",src:this.props.avatar}))),l.default.createElement("div",{className:"media-body media-middle font-14"},"我还有更多直播节目",l.default.createElement("br",null),"跟你共享"),l.default.createElement("div",{className:"media-right media-middle p-r"},l.default.createElement("div",{className:"download_btn_white small"},"立即下载")),l.default.createElement("div",{className:"articleBottomClose"}))),l.default.createElement("div",{className:"articleBottomDis text-center small clearfix"},l.default.createElement("div",{className:"fl w-60 white-bg l-h-22 border-radius-3 border-gray-1"},"我要提问"),l.default.createElement("div",{className:"fl text-blue l-h-24",style:p.nextpaly},"下一直播")))}}]),t}(l.default.Component),p={nextpaly:{float:"right",width:"40%"}};t.default=e.exports=h},1163:function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(76),a=(function(e){e&&e.__esModule}(s),r(15),r(17)),o=r(1164),u=r(1165);r(286);t.default=e.exports=function(){function e(t,r,i){n(this,e),this.lid=r,this.af_id=-1,this.enter_time=Math.round(a.now()/1e3),this.baobabTree=i,this.auth_info=t.auth_info,this.u=t.auth_info.u,this.u&&-1!=this.u||(this.u=6),o.initFConf(t.fconf)}return i(e,[{key:"setFromFlag",value:function(e){this.from_out_side=e}},{key:"fetch_new_dlg",value:function(){var e=this;o.get_dial_live(this.auth_info,this.u,this.lid,this.af_id,this.enter_time).then(this.updateUsers.bind(this)).then(this._update_af_id.bind(this)).then(function(t){e.saveMessages(t.dials),e.fetch_new_dlg()}).catch(function(t){e.pollcnt=0,setTimeout(function(){e.fetch_new_dlg()},4e3+a.random(0,1e4))})}},{key:"messagesCursor",value:function(){return this.baobabTree.root.select("dials")}},{key:"usersCursor",value:function(){return this.baobabTree.root.select("users")}},{key:"updateUsers",value:function(e){var t=this;if(!e||!e.dials)return Promise.resolve(e);var r=[];if(a.forEach(e.dials,function(e){e.data&&e.data.src_uid&&r.push(e.data.src_uid)}),a.isEmpty(r))return Promise.resolve(e);var n=a.map(this.usersCursor().get(),function(e){return parseInt(e.mmid)}),i=a.difference(r,n);return a.isEmpty(i)?Promise.resolve(e):this.from_out_side&&1==this.from_out_side?o.get_msg_users_outside(this.u,i).then(function(r){return t.saveUsers(r.users),Promise.resolve(e)}):o.get_msg_users(this.auth_info,i).then(function(r){return t.saveUsers(r.users),Promise.resolve(e)})}},{key:"saveUsers",value:function(e){a.isEmpty(e)||(this.usersCursor().get()?this.usersCursor().set(this.usersCursor().get().concat(e)):this.usersCursor().set(e))}},{key:"_update_af_id",value:function(e){var t=this;return e.dials&&a.forEach(e.dials,function(e){t.af_id<=e.id&&(t.af_id=e.id)}),Promise.resolve(e)}},{key:"saveMessages",value:function(e){var t=this;if(!a.isEmpty(e)){var r=a.filter(e,function(e){return u.find(t.messagesCursor(),function(t){return t.id==e.id}).merge(e)==u.emptyCursor}),n=a.filter(this.messagesCursor().get().concat(r),function(e){return 0==e.type});if(!a.isEmpty(n)){var i=a.sortBy(n,function(e){return e.id});this.messagesCursor().set(i)}}}}]),e}()},1164:function(e,t,r){"use strict";var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=r(75),s=r(15),a=r(17),o={};e.exports.initFConf=function(e){a.isEmpty(o)&&(o=e)},e.exports.get_dial_live=function(e,t,r,a,u){var l=o.apn_url+"msg/v4/new_dial_live?"+s.stringify(n({},e,{u:t,lid:r,af_id:a,enter_time:u,timeout:18e4}));return fetch(l).then(i.parse_online_json)},e.exports.getUserInfo=function(e,t,r){var a=o.api_url+"sdk/contact/get_card?"+s.stringify(n({},e,{u2:t,lid:r}));return fetch(a,{method:"get",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(i.parse_online_json)},e.exports.get_msg_users=function(e,t){var r=o.online_url+"msg/v31/get_msg_users?"+s.stringify(n({},e,{mmids:t.join(",")}));return fetch(r).then(i.parse_online_json)},e.exports.get_msg_users_outside=function(e,t){var r="/article/get_msg_users_outside?"+s.stringify({u:e,mmids:t.join(",")});return fetch(r,{credentials:"same-origin"}).then(i.parse_online_json)}},1165:function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){var r=f.findIndex(e.get(),function(e){return f.isMatch(e,t)});return r<0?d:e.select(r)}function s(e,t){var r=f.findIndex(e.get(),t);return!(r<0)&&(e.splice([r,1]),!0)}function a(e,t){var r=f.findIndex(e.get(),t);return r<0?d:e.select(r)}function o(e){if(!e||!e.get()||0==e.get().length)return d;var t=e.get().length-1;return e.select(t)}function u(e,t,r){return e?e.get()[t]?e.select(t).merge(r):e.select(t).set(r):d}function l(e){return new m(e)}var c=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),f=r(17),d={merge:function(e){return d},set:function(e){return d},push:function(e){return d},unshift:function(e){return d},splice:function(e){return d},apply:function(e){return d},select:function(e){return d},get:function(){return d}},m=function(){function e(t){n(this,e),this.cursor=t}return c(e,[{key:"findWhere",value:function(t){return new e(i(this.cursor,t))}},{key:"find",value:function(t){return new e(a(this.cursor,t))}},{key:"last",value:function(){return new e(o(this.cursor))}},{key:"mergeOrSet",value:function(t,r){return new e(u(this.cursor,t,r))}},{key:"merge",value:function(t){return this.cursor.merge(t),new e(this.cursor)}},{key:"set",value:function(t){return this.cursor.set(t),new e(this.cursor)}},{key:"push",value:function(t){return this.cursor.push(t),new e(this.cursor)}},{key:"unshift",value:function(t){return this.cursor.unshift(t),new e(this.cursor)}},{key:"apply",value:function(t){return this.cursor.apply(t),new e(this.cursor)}},{key:"select",value:function(t){return new e(this.cursor.select(t))}},{key:"get",value:function(){return this.cursor}},{key:"isEmptyCursor",value:function(){return this.cursor==d}},{key:"isNotEmptyCursor",value:function(){return this.cursor!=d}}]),e}();e.exports.emptyCursor=d,e.exports.findWhere=i,e.exports.find=a,e.exports.last=o,e.exports.mergeOrSet=u,e.exports.chain=l,e.exports.findAndDelete=s},827:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var i=r(1),s=n(i),a=r(75),o=r(15),u=n(o),l=r(981),c=n(l),f=r(50),d=n(f),m=r(165),h=n(m),p=r(1161),v=n(p),g=r(1162),_=(n(g),r(982)),y=r(1098).TabEnum,b=(r(1163),r(275)),E=r(17),w=s.default.createClass({displayName:"live_court_detail",mixins:[b],contextTypes:{req:s.default.PropTypes.object,fconf:s.default.PropTypes.object,auth_info:s.default.PropTypes.object,env:s.default.PropTypes.object},getInitialState:function(){return{isPlayClick:!1,liveUrl:""}},componentWillMount:function(){},componentDidMount:function(){},componentWillUnmount:function(){console.log("componentWillUnmount")},render:function(){return s.default.createElement("div",null,s.default.createElement(c.default,{title:"职播间"}),this.renderFooter())},renderFooter:function(){var e=this.props.cursor.select("tab_manager").get();if(!e)return null;var t=e.tabs[e.current_tabindex],r=e.current_tabindex,n=this.props.cursor.select("tab_manager","tabs",r,"cursor_status"),i=t.hasMore,a=t.firstload,o=e.tabs[r].data.videos||[];return s.default.createElement("div",null,s.default.createElement("div",{className:"livevideo-top-blank"}),s.default.createElement("div",{className:"clearfix"},s.default.createElement(_,{loadMore:this.loadMore,hasMore:i,loader:s.default.createElement(h.default,{ref:"loader",reload:this.loadMore,cursor:n})},s.default.createElement("div",{className:"panel panel-default",id:"zkp_content",style:{marginBottom:"0"}},s.default.createElement("ul",{className:"list-group",key:"1",style:x.show},s.default.createElement(v.default,{key:"1",videos:o,onClick:this.liveHotClick,first_load:a}))))))},loadMore:function(){var e=this,t=this.context,r=t.auth_info,n=(t.req,t.fconf,this.props.cursor.select("tab_manager")),i=n.select("current_tabindex").get(),s=n.select("tabs",i),o=-1!=r.u?r.u:6,l="/article/qlive_court?"+u.default.stringify({u:o,page:s.get().currentPage,count:5});if(this.refs.loader&&!this.props.cursor.select("tab_manager","tabs",i).get().requesting&&this.props.cursor.select("tab_manager","tabs",i).get().hasMore){var c=o;this.refs.loader.bindRequest(function(){return s.select("requesting").set(!0),fetch(l,{credentials:"same-origin"}).then(a.parse_online_json).then(function(t){e.updateData(t,s,i,c);var r=y.history?t.more||0:t.more;s.select("firstload").set(1),s.select("hasMore").set(1==r),s.select("currentPage").apply(function(e){return e+1}),s.select("cursor_status").set(0),s.select("requesting").set(!1),e.props.cursor.select("tab_manager","tabs",i,"requesting").set(!1)}).catch(function(e){s.select("firstload").set(2),s.select("cursor_status").set("failed"),s.select("requesting").set(!1),(0,a.toast_error_handler)(e)})})}},updateData:function(e,t,r,n){switch(r){case y.hotlive:if(e.videos&&e.videos.length>0){var i=E.filter(e.videos,function(e){return e.mmid!=n});0==t.select("currentPage").get()?t.select("data","videos").set(i):t.select("data","videos").concat(i)}}},liveHotClick:function(e){var t="/article/live2?"+u.default.stringify({uid:e.mmid});(0,d.default)(t,e.title)}}),x={tr:{height:"50px"},show:{display:"block",marginTop:-1},bottomHeight:{width:"100%",height:"140px"}};w.hideHeader=!0,e.exports=w}});