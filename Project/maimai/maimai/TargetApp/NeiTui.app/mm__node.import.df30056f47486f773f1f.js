webpackJsonp([254],{767:function(e,t,a){"use strict";function d(e){return e&&e.__esModule?e:{default:e}}var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(e[d]=a[d])}return e},l=a(1),r=d(l),u=a(166),o=d(u),c=a(1060),i=d(c),s=a(981),f=d(s),p=a(46),m=d(p),h=a(76),v=d(h),_=a(15),y=d(_),b=a(114),x=d(b),g=a(75),E=d(g),k=a(1028),N=a(113),B=a(41),C=a(47);e.exports=(0,o.default)(r.default.createClass({displayName:"exports",mixins:[B],contextTypes:{auth_info:r.default.PropTypes.object,fconf:r.default.PropTypes.object},componentDidMount:function(){(0,N.bindBroadcast)("bank_card_added",this.closePage)},componentWillUnmount:function(){(0,N.unbindBroadcast)("bank_card_added")},closePage:function(){window.MaiMai_Native.close_native(null,!0)},onNextBtnClicked:function(){var e=this,t=C.findDOMNode(this.refs.card_numb).value,a=(0,k.checkStrNumbValid)(t);if(a<=0)return(0,v.default)(-1==a?"请输入银行卡号":"请输入正确银行卡号");var d=this.context,l=d.fconf,r=d.auth_info,u=n({cardnum:t.trim()},r),o=l.online_url+"mmpay/v4/chkcard?"+y.default.stringify(u),c=fetch(o,{credentials:"same-origin"}).then(E.default.parse_online_json).then(function(a){if(e.props.deposit){if(1!=a.pay)return void(0,v.default)("该卡暂不支持充值功能");if(1==a.type){if(!new Set(["1","4","221"]).has(r.u))return void(0,v.default)("不支持使用信用卡充值")}}else if(1==a.type)return void(0,v.default)("不支持添加信用卡");e.goToAddCard(t.trim(),a.type)}).catch(E.default.toast_error_handler);(0,x.default)("检测中...",c)},goToAddCard:function(e,t){var a=this.context,d=a.fconf;a.auth_info;d.need_idcard_photo?(0,m.default)("/contact/account/upload_card?"+y.default.stringify({add_card:1,cardnum:e,type:t,deposit:this.props.deposit,dpvalue:this.props.dpvalue}),"我的银行卡","fetch"):(0,m.default)("/contact/account/add_bank_card?"+y.default.stringify({cardnum:e,type:t,deposit:this.props.deposit,dpvalue:this.props.dpvalue}),"我的银行卡","fetch")},render:function(){var e,t;return this.props.deposit?(e="仅支持储蓄卡充值.",t="支持工商银行,农业银行,中国银行,建设银行,华夏银行,北京银行,兴业银行,光大银行,平安银行.暂不支持招行储蓄卡."):(e="仅支持储蓄卡提现.",t="支持工商银行,农业银行,中国银行,建设银行,招商银行,民生银行,华夏银行,北京银行,兴业银行,中信银行,平安银行."),r.default.createElement("div",null,r.default.createElement(f.default,{title:"添加银行卡"}),r.default.createElement("div",{style:i.default.cashBankCardWrap},r.default.createElement("div",{className:"clearfix",style:[i.default.cashBox,i.default.borderBottom]},r.default.createElement("label",{style:i.default.cashLabel},"银行卡号"),r.default.createElement("p",{style:i.default.cashBoxP},r.default.createElement("input",{style:[i.default.cashInput,i.default.rightInput],type:"number",placeholder:"请输入卡号",ref:"card_numb"}))),r.default.createElement("div",{className:"m-t m-l small text-muted"},e),r.default.createElement("div",{className:"m-t m-l small text-muted"},t),r.default.createElement("div",{className:"m-t m-l small text-muted"},"部分建行卡因接口问题无法通过实名检测,如遇此问题请更换其它银行的卡重试.")),r.default.createElement("div",{style:i.default.nextBtn,onClick:this.onNextBtnClicked},"下一步"))}}))}});