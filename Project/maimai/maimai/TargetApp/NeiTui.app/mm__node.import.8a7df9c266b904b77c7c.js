webpackJsonp([46],{1481:function(e,t,a){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}(),i=a(1),c=function(e){return e&&e.__esModule?e:{default:e}}(i),l=function(e){function t(){var e,a,o,s;r(this,t);for(var i=arguments.length,c=Array(i),l=0;l<i;l++)c[l]=arguments[l];return a=o=n(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),o.onMobileChange=function(e){var t=e.target.value;o.props.onMobileChange(t)},s=a,n(o,s)}return o(t,e),s(t,[{key:"render",value:function(){this.props.curTabIndex;return c.default.createElement("div",null,!1,c.default.createElement("div",{className:"borderBottom p-t-30 p-b-10"},c.default.createElement("div",{className:"media-left mc_phone_area media-bottom"},this.props.mtype||"未识别运营商"),c.default.createElement("div",{className:"media-body p-b-15 text-content"},c.default.createElement("input",{className:"mc_phone_number",type:"number",inputmode:"numeric",defaultValue:this.props.mobile,onChange:this.onMobileChange}))))}}]),t}(c.default.Component);t.default=e.exports=l},1482:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var n=a(1),o=r(n),s=a(77),i=r(s),c=a(76),l=(r(c),o.default.createClass({displayName:"RechargeCell",statics:{validate:function(e){var t=e.password;if(!(t="123"))throw"请填输入支付密码";return{password:t}}},getInitialState:function(){return{password:""}},ok:function(){try{var e=l.validate(this.state);e.price=this.props.recharge.price,this.props.onPub(e),i.default.dismiss()}catch(e){alert(e)}},passwordChange:function(e){this.setState({password:e.target.value})},forgetPassword:function(){window.MaiMai_Native.native_open_new_webview("/contact/account/change_password")},showRechargePop:function(){this.props.recharge.isSale&&this.props.balance>=this.props.recharge.price&&(11!=this.props.mobile.length||0==this.props.mtype.length?alert("请输入正确的手机号"):0==this.props.has_password?this.forgetPassword():(this.setState({password:""}),i.default.popup(o.default.createElement("div",{className:"border-radius-3 p-x p-y white-bg",style:{width:300}},o.default.createElement("div",{className:"text-center text-content"},"充值金额"),o.default.createElement("div",{className:"text-center text-blue font-40 m-y-10"},"¥",this.props.recharge.price),o.default.createElement("div",{className:"centerBtn blueBtn",onClick:this.ok},"确认支付"))),document.getElementById("passwd").focus()))},render:function(){var e=this.props.balance>=this.props.recharge.price;return o.default.createElement("div",{className:"mc_recharge_table fl",onClick:this.showRechargePop},o.default.createElement("div",{className:"text-center mc_recharge_cell "+(this.props.recharge.isSale&&e?"btn-blue-outline":"btn-light-gray-outline")},this.props.recharge.value,!e&&o.default.createElement("div",{className:"small"},"余额不足"),!this.props.recharge.isSale&&e&&o.default.createElement("div",{className:"small"},"备货中")))}}));e.exports=l},808:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},c=function(){function e(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}(),l=a(1),u=r(l),p=a(981),f=r(p),d=a(1481),h=r(d),b=a(1482),m=r(b),y=a(114),_=r(y),v=a(113),w=a(75),g=w.parse_online_json,x=w.toast_error_handler,P=a(15),E=a(76),T=function(e){function t(e){n(this,t);var a=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));S.call(a);var r=a.getMobileCarrier(e.mobile);return a.state={curTabIndex:0,mobile:e.mobile,mtype:r,balance:e.balance,has_password:e.has_password,feePrices:[{isSale:"中国联通"!=r,value:"10元",price:"10"},{isSale:!0,value:"20元",price:"20"},{isSale:!0,value:"30元",price:"30"},{isSale:!0,value:"50元",price:"50"},{isSale:!0,value:"100元",price:"100"},{isSale:!0,value:"200元",price:"200"}],flowPrices:[{isSale:!0,value:"10M",price:"3.0"}]},a}return s(t,e),c(t,[{key:"componentDidMount",value:function(){(0,v.bindBroadcast)("account_password_set",this.onAccountPasswordSet)}},{key:"componentWillUnmount",value:function(){(0,v.unbindBroadcast)("account_password_set",this.onAccountPasswordSet)}},{key:"render",value:function(){var e=this;return u.default.createElement("div",null,u.default.createElement(f.default,{title:"话费充值"}),u.default.createElement(h.default,{leftText:"充话费",rightText:"充流量",firstTab:this.firstTab,secondTab:this.secondTab,mobile:this.state.mobile,mtype:this.state.mtype,onMobileChange:this.onMobileChange,curTabIndex:this.state.curTabIndex}),u.default.createElement("div",{className:"p-x-10 p-y",style:{display:0==this.state.curTabIndex?"block":"none"}},this.state.feePrices.map(function(t){return u.default.createElement(m.default,{recharge:t,ctype:"fee",balance:e.state.balance,mobile:e.state.mobile,mtype:e.state.mtype,has_password:e.state.has_password,onPub:e.onPub})})),u.default.createElement("div",{className:"p-x-10 p-y",style:{display:1==this.state.curTabIndex?"block":"none"}},this.state.flowPrices.map(function(t){return u.default.createElement(m.default,{recharge:t,ctype:"flow",balance:e.state.balance,mobile:e.state.mobile,mtype:e.state.mtype,has_password:e.state.has_password,onPub:e.onFlowPub})})),u.default.createElement("div",{className:"text-muted small p-x",style:{position:"absolute",bottom:"20px"}},"*暂时仅支持脉脉余额支付"))}}]),t}(u.default.Component);T.contextTypes={fconf:u.default.PropTypes.object,auth_info:u.default.PropTypes.object,req:u.default.PropTypes.object};var S=function(){var e=this;this.carrier_cm_pattern=new RegExp("^1(34[0-8]|(3[5-9]|5[0127-9]|8[278]|78)\\d)\\d{7}$"),this.carrier_cu_pattern=new RegExp("^1(3[0-2]|5[56]|8[56]|76)\\d{8}$"),this.carrier_ct_pattern=new RegExp("^1((33|53|77|8[09])[0-9]|349)\\d{7}$"),this.getMobileCarrier=function(t){return e.carrier_cm_pattern.test(t)?"中国移动":e.carrier_cu_pattern.test(t)?"中国联通":e.carrier_ct_pattern.test(t)?"中国电信":""},this.firstTab=function(){e.setState({curTabIndex:0})},this.secondTab=function(){e.setState({curTabIndex:1})},this.onPub=function(t){var a=e.context,r=a.fconf,n=a.auth_info,o=i({mobile:e.state.mobile,fen_value:Math.floor(100*t.price),password:t.password},n),s=r.online_url+"mmpay/v4/mobile_charge?"+P.stringify(i({},n)),c=fetch(s,{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:P.stringify(o)}).then(g).then(function(a){E(a.ok_msg);var r=e.state.balance-t.price;(0,v.sendWebViewBroadcast)("account.balance.change",{balance:r.toFixed(2)}),window.MaiMai_Native.close_native("",!0)}).catch(x);(0,_.default)("提交充值请求..",c)},this.onFlowPub=function(){},this.onMobileChange=function(t){var a=e.state.feePrices,r=e.getMobileCarrier(t);a[0].isSale="中国联通"!=r,e.setState({mobile:t,mtype:r,feePrices:a})},this.onAccountPasswordSet=function(){e.setState({has_password:1})}};t.default=e.exports=T}});