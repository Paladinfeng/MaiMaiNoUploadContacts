webpackJsonp([105],{1544:function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i,l,c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),p=n(1),u=n(17),f=n(15),d=(n(985)("app"),n(273),n(991)),m=n(46),h=n(75),y=n(114),_=n(1001),v=n(41);t.default=e.exports=(l=i=function(e){function t(){var e,n,a,i;o(this,t);for(var l=arguments.length,s=Array(l),p=0;p<l;p++)s[p]=arguments[p];return n=a=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),a.openDetail=function(e){if(e.stopPropagation(),a.props.inDetail)a.props.onClick();else if(!a.props.disabled){var t={};t.evaluation=a.props.comment_data,m("/contact/comment_detail/"+a.props.comment_data.id,"点评详情",t)}},a.like=u.debounce(function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation();var t=a.context,n=t.auth_info,o=t.fconf,r=o.online_url+"evaluation/like?"+f.stringify(c({id:a.props.comment_data.id,like:a.props.comment_data.mylike?"0":"1"},n)),i=fetch(r).then(h.parse_online_json).then(function(e){var t=a.props.comment_data.mylike?0:1,n=a.props.comment_data.likes+(t?1:-1);a.props.cursor.select("mylike").set(t),a.props.cursor.select("likes").set(n)}).catch(h.toast_error_handler);y("请求中",i)},1e3,!0),a.deleteClicked=u.debounce(function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation();var t=a.context,n=t.auth_info,o=t.fconf;if(1==confirm("确定要删除点评吗？")){var r=o.online_url+"job/v3/hr/comment_del?"+f.stringify(c({id:a.props.comment_data.id},n)),i=fetch(r).then(h.parse_online_json).then(function(e){a.props.listCursor&&a.props.listCursor.splice([a.props.index,1])}).catch(h.toast_error_handler);y("删除点评中",i)}},1e3,!0),i=n,r(a,i)}return a(t,e),s(t,[{key:"shouldComponentUpdate",value:function(e,t){return v.shouldComponentUpdate.apply(this,[e,t])}},{key:"render",value:function(){var e=this.props,t=e.comment_data,n=e.deleteClicked,o=this.context.auth_info;if(t.uid&&t.uid==o.u)var r="删除";var a=null;a=this.props.inDetail?p.createElement("div",{style:b.short_text,className:"media-heading m-l-lg text-content"},t.content):p.createElement("div",{className:"media-heading m-l-lg text-content"},_(t.content));var i="点评时间  "+(t.timestr||t.crtime.slice(0,10));return p.createElement("li",{className:"list-group-item"},!this.props.hide_card&&p.createElement(d,{user:t.card,article_line:i,star_num:t.score}),p.createElement("div",{style:b.body},a,p.createElement("div",{style:{height:"4px"}}),p.createElement("span",{className:"pull-right text-primary small",onClick:n||this.deleteClicked,style:b.delete}," ",r)))}}]),t}(p.Component),i.contextTypes={auth_info:p.PropTypes.object,fconf:p.PropTypes.object},l);var b={heading:{marginTop:-10,marginLeft:-20,marginRight:-20},body:{marginTop:5,marginBottom:20},like:{marginTop:-5,width:15,height:15},delete:{marginRight:20},short_text:{WebkitLineClamp:"2",height:42,fontSize:14,lineHeight:"20px",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitBoxOrient:"vertical"}}},872:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l,c,s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},p=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u=n(1544),f=o(u),d=n(1),m=o(d),h=n(981),y=o(h);n(17);t.default=e.exports=(c=l=function(e){function t(){var e,n,o,i;r(this,t);for(var l=arguments.length,c=Array(l),s=0;s<l;s++)c[s]=arguments[s];return n=o=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),o.loadMore=function(){var e=o.props.cursor;o.refs.loader.bindRequest(function(){return t.loadData(o.context,o.nextPage).then(function(t){o.nextPage++;var n=t.data;e.select("comment_list").concat(n.comment_list),e.select("remain").set(n.remain)})})},i=n,a(o,i)}return i(t,e),p(t,[{key:"componentDidMount",value:function(){this.nextPage=1}},{key:"render",value:function(){var e=this,t=this.props.comment_list;return m.default.createElement("div",null,m.default.createElement(y.default,{title:"全部点评"}),m.default.createElement("ul",{className:"list-group"},t.map(function(t,n){return m.default.createElement(f.default,{comment_data:t,listCursor:e.props.cursor.select("comment_list"),index:n})})))}}],[{key:"loadData",value:function(e,t){var n=e.req,o=n.query,r=n.pathname+"?"+qs.stringify(s({page:t,jsononly:1},o));return fetch(r,{credentials:"same-origin"}).then(parse_online_json)}}]),t}(m.default.Component),l.contextTypes={auth_info:m.default.PropTypes.object,req:m.default.PropTypes.object,fconf:m.default.PropTypes.object},c)}});