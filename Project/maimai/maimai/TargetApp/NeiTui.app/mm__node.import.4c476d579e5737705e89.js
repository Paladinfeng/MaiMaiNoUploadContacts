webpackJsonp([85],{1546:function(e,t,r){"use strict";var a=r(1),i=a.createClass({displayName:"ServiceAuthor",comonentDidMount:function(){document.body.style.backgroundColor="#f6f6f6"},render:function(){var e=this.props,t=e.avatar_url,r=e.line1,i=e.line2,n=e.line2Class,l=e.onClick,c=e.backgroud_num,o=e.article_num,s=e.intervaldesc;return a.createElement("div",{className:"serviceRow addArrow",onClick:l},a.createElement("dl",{className:"serviceAuthor clearfix"},a.createElement("dt",null,a.createElement("img",{src:t})),a.createElement("dd",{className:"name"},a.createElement("em",null,r),a.createElement("i",{className:n},"| ",i)),a.createElement("dd",null,"背景经历: ",a.createElement("b",null,c,"条")," | 脉脉专栏: ",a.createElement("b",null,o,"条")),a.createElement("dd",null,"服务平均响应时长",s)))}});e.exports=i},882:function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c,o,s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},u=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),d=r(1003),f=(a(d),r(1172)),p=a(f),_=r(988),h=a(_),m=r(1),v=a(m),g=r(981),y=a(g),b=r(1001),x=a(b),E=r(46),w=a(E),k=r(75),C=a(k),j=r(15),O=a(j),S=r(76),P=a(S),N=r(113),M=a(N),D=r(1025),q=(a(D),r(1012)),T=a(q),B=r(1546),U=a(B),A=r(78),L=a(A),R=r(115),V=r(1062),W=(a(V),r(1173)),J=a(W),H=r(271),z=a(H),F=r(1063),G=a(F),I=r(986),K=a(I),Q=r(117),X=a(Q),Y=r(50),Z=(a(Y),r(164)),$=r(77),ee=a($),te=r(995),re=a(te),ae=r(116),ie=a(ae),ne=r(167),le=r(983),ce=r(998),oe=r(1002).types;t.default=e.exports=(o=c=function(e){function t(){var e,r,a,l;i(this,t);for(var c=arguments.length,o=Array(c),u=0;u<c;u++)o[u]=arguments[u];return r=a=n(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),a.state={first_chat:1},a.onPubService=function(e){e._id==a.props.service._id&&a.props.cursor.select("service").set(e)},a.edit=function(){var e=a.props.service;(0,w.default)("/service/edit?_id="+e._id,"编辑服务",{service:e})},a.delete=function(){if(confirm("您确定要删除么?")){var e=a.context.auth_info,t=a.props.service._id,r="/sdk/service/delete?"+O.default.stringify(s({_id:t},e));fetch(r,{credentials:"same-origin"}).then(k.parse_online_json).then(function(e){(0,P.default)("删除成功"),M.default.sendWebViewBroadcast("delete_service",{_id:t}),MaiMai_Native.close_native&&MaiMai_Native.close_native("",!0)}).catch(k.toast_error_handler)}},a.shareServiceUrl=function(){var e=a.context.fconf,t=a.props.service,r=e.web_url+"service/detail?"+O.default.stringify({id:t._id,from:"service_share"});MaiMai_Native.native_share_v2(1,JSON.stringify({url:r}))},a.shareService=function(e){e.stopPropagation(),a.shareServiceUrl()},a.goContactDetail=function(){var e=a.props.card;a.context.auth_info;(0,L.default)(e.encode_mmid||e.id,a.context)},a.spread_service=function(){var e=a.context,t=e.auth_info,r=e.fconf,i=a.props.service;if(i.fid&&!(t.u<=0)){var n=r.online_url+"feed/v3/spread?"+O.default.stringify(s({fid:i.fid,spread:1},t));fetch(n).then(C.default.parse_online_json).then(function(){(0,P.default)("分享成功")}).catch(C.default.toast_error_handler)}},a.goCommentList=function(){var e=a.props,t=e.comment_list,r=e.service;(0,w.default)("/service/comment_list?"+O.default.stringify({srvid:r._id}),"全部点评",{comment_list:t})},a.onPay=function(){var e=a.props.service;a.context.auth_info;setTimeout(function(){(0,Z.startChatView)(null,e.uid,!1,null,!1)},2e3)},a.pay=function(e){e.stopPropagation();var t=a.context,r=t.auth_info,i=t.fconf;if(r.u>0)try{var n=a.props,l=n.service,c=(n.inDetail,a.context),r=c.auth_info,o=c.req;if(r.u==l.uid)(0,P.default)("不要自己给自己付钱哦！");else if(l.call>0)(0,w.default)("/service/call_pre_order?"+O.default.stringify({id:l._id,from:o.query.hasOwnProperty("from")?o.query.from:""}),"提交订单","fetch");else if(1==l.for_member){var u=i.online_url+"talent/v3/uh/member_srv_consume?"+O.default.stringify(s({orderid:1,check:1},r));fetch(u,{credentials:"same-origin"}).then(k.parse_online_json).then(function(e){1==e.consume_ok?(0,w.default)("/service/pre_order?"+O.default.stringify({id:l._id,from:o.query.hasOwnProperty("from")?o.query.from:""}),"提交订单","fetch"):(0,ne.showModalForConfirm)({title:e.consume_msg,ok_text:"成为会员",ok:function(){(0,w.default)("/uh_memlist?"+O.default.stringify({tpl:"show",fr:"service"}),"会员中心","fetch")},cancel_text:"取消"})}).catch(k.toast_error_handler)}else(0,w.default)("/service/pre_order?"+O.default.stringify({id:l._id,from:o.query.hasOwnProperty("from")?o.query.from:""}),"提交订单","fetch")}catch(e){alert(e)}else r.u<0&&(0,R.launch_webview)()},a.chat=function(e){var t=a.context,r=t.auth_info,i=t.fconf;if(r.u>0)try{var n=a.props,l=n.service,r=(n.inDetail,a.context.auth_info);if(r.u==l.uid)(0,P.default)("不要自己给自己付钱哦！");else if(1==a.state.first_chat){var c=i.online_url+"talent/v3/usrv/chat?"+O.default.stringify(s({srvid:l._id,msg:e},r));fetch(c).then(k.parse_online_json).then(function(e){1==e.ret?(setTimeout(function(){(0,Z.startChatView)(null,l.uid,!1,null,!1)},2e3),a.setState({first_chat:0})):(0,P.default)(e.error)}).catch(k.toast_error_handler)}else setTimeout(function(){(0,Z.startChatView)(null,l.uid,!1,null,!1)},500)}catch(e){alert(e)}else r.u<0&&(0,R.launch_webview)()},a.chatMsg=function(){var e=a.context,t=e.auth_info;e.fconf;t.u>0?1==a.state.first_chat?ee.default.popup(v.default.createElement(re.default,{title:"服务咨询",text:"",placeholder:"请填写咨询内容（不少于10个字）",ok:function(e){if(e.length<10)return void alert("请填写10字以上咨询内容");ee.default.dismiss(),a.chat(e)}})):a.chat():(0,R.launch_webview)()},a.remindShare=function(){var e=a.props.service,t=a.context.fconf;if(1==confirm("快分享服务到朋友圈，让您的好友来捧场吧~")){var r=t.web_url+"service/detail?"+O.default.stringify({id:e._id,from:"share_service_pub"});MaiMai_Native.native_share_v2(3,JSON.stringify({url:r}))}},l=r,n(a,l)}return l(t,e),u(t,[{key:"componentDidMount",value:function(){var e=this.context.req;(0,N.bindBroadcast)("pub_service",this.onPubService),window.native_image_data=ce,window.spread_service=this.spread_service,window.shareServiceUrl=this.shareServiceUrl,e.query.remind_share&&1==e.query.remind_share&&this.remindShare()}},{key:"componentWillUnmount",value:function(){(0,N.bindBroadcast)("pub_service",this.onPubService)}},{key:"renderDetail",value:function(){var e=this.props,t=e.service,r=e.card,a=e.comment_list,i=(e.can_mid,e.uinfo),n=this.context,l=n.auth_info,c=(n.req,[]);c.push({title:"分享服务",callback:"shareServiceUrl()"});var o={};o.more_items=c,o.keep_default_items=4;var s=" 元/";t.time?s+=""+t.time+oe[t.type]:s+=""+oe[t.type];var u="求捧场："+this.props.service.title+"("+this.props.service.price+s+")";u&&u.length>30&&(u=u.substr(0,30)+"...");var d=this.props.service.desc;o.share_info={title:u,name:"服务",desc:d,hide_share:!0,icon_callback:'native_image_data("card_avatar")',icon_type:"1"},l.u!=t.uid&&t.fid>0&&(o.share_info.share_to_feed_callback="spread_service",o.share_info.share_to_feed_status="0");var f="",_="立即购买";1==this.props.service.for_member&&(_="立即预约"),f=l.u==t.uid?v.default.createElement(h.default,{btns:["编辑","删除"],actions:[this.edit,this.delete]}):(t.price,v.default.createElement(h.default,{btns:[_],actions:[this.pay]}));var m=t.desc;t.call&&t.call>0&&(m="【本服务为通话形式，购买须知】\n1.由脉脉电话连接双方通话，手机号互不可见。\n2.通话费用实时结算给服务方。时间未使用完将退还现金。\n3.请主动沟通通话时间和主题。",t.desc&&t.desc.length>0&&(m="服务描述:\n"+t.desc+"\n\n"+m));var g=(ie.default.getCareer(r),i.work_exp.length+i.education.length),b=i.article.feeds&&i.article.feeds.length>0&&i.feed_info.article>=0?i.feed_info.article:0;return v.default.createElement("div",null,l.u>0&&v.default.createElement(le,{msg_to_app:o}),l.u>0?v.default.createElement(y.default,{title:"服务详情"}):v.default.createElement(y.default,{title:u}),v.default.createElement(p.default,{service:t,shareService:this.shareService}),v.default.createElement(z.default,{title:"发布人",btn:null,onClick:null,icon_classname:"glyphicon glyphicon-pencil"},v.default.createElement(U.default,{avatar_url:r.avatar,line1:r.name,line2:r.career,backgroud_num:g,article_num:b,intervaldesc:i.intervaldesc,onClick:this.goContactDetail,line2Class:1==r.judge?"add_v_img2":""})),v.default.createElement(z.default,{title:"服务详情",btn:null,onClick:null,icon_classname:"glyphicon glyphicon-pencil"},v.default.createElement("div",{className:"m-x m-y text-info",style:se.sBottom},(0,x.default)(m),4167414==t._id&&v.default.createElement("img",{style:se.serviceimg,src:"/static/images/service/service_51talk.jpg"}))),a.length>0&&v.default.createElement(z.default,{title:"服务点评",btn:null,onClick:null,icon_classname:"glyphicon glyphicon-pencil"},a.length>=1&&v.default.createElement(G.default,{comment_data:a[0],listCursor:this.props.cursor.select("comment_list"),index:0}),a.length>=2&&v.default.createElement(G.default,{comment_data:a[1],listCursor:this.props.cursor.select("comment_list"),index:1}),a.length>2&&v.default.createElement(K.default,{onClick:this.goCommentList,title:"全部点评("+a.length+") >>"})),v.default.createElement("div",{style:{height:"50px"}}),f)}},{key:"renderDeleted",value:function(){var e=this.props,t=e.service,r=e.card,a=this.context.auth_info,i=[];i.push({title:"分享服务",callback:"MaiMai_Native.native_share(1)"});var n={};n.more_items=i,n.keep_default_items=4;var l=" 元/";t.time?l+=""+t.time+oe[t.type]:l+=""+oe[t.type];var c="求捧场："+this.props.service.title+"("+this.props.service.price+l+")";c&&c.length>30&&(c=c.substr(0,30)+"...");var o=this.props.service.desc;n.share_info={title:c,name:"服务",desc:o,hide_share:!0,icon_callback:'native_image_data("card_avatar")',icon_type:"1"},a.u!=t.uid&&t.fid>0&&(n.share_info.share_to_feed_callback="spread_service",n.share_info.share_to_feed_status="0");var s=ie.default.getCareer(r);return v.default.createElement("div",null,v.default.createElement(y.default,{title:"服务详情"}),v.default.createElement("li",{className:"list-group-item",onClick:this.gotoDetail},v.default.createElement("div",{className:"serviceRow m-b-0"},v.default.createElement("div",{className:"serviceCon"},v.default.createElement("p",{className:"serviceTitle"},"该服务已被发布者下架")))),1==r.judge?v.default.createElement(T.default,{avatar_url:r.avatar,line1:r.name,line2:s,line2Class:"add_v_img2",onClick:this.goContactDetail}):v.default.createElement(T.default,{avatar_url:r.avatar,line1:r.name,line2:s,onClick:this.goContactDetail}))}},{key:"render",value:function(){var e=this.props,t=e.service;e.card;return t.uid&&1!=t.is_delete?this.renderDetail():t.uid&&1==t.is_delete?this.renderDeleted():v.default.createElement("div",null,v.default.createElement(y.default,{title:"服务详情"}),v.default.createElement(J.default,{tips:"该服务已被发布者下架"}))}}]),t}(v.default.Component),c.contextTypes={auth_info:v.default.PropTypes.object,req:v.default.PropTypes.object,fconf:v.default.PropTypes.object},o);var se={hidden:{width:"0px",height:"0px"},collapse:{marginTop:"15px",marginRight:"15px",marginBottom:"0px",marginLeft:"15px",maxHeight:"60px",lineHeight:"20px",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical"},expand:{margin:"15px"},sBottom:{paddingBottom:"46px!important"},footer:{padding:"14px",textAlign:"center",fontSize:X.default.Constants.large},serviceimg:{width:"200px",height:"152px"}}}});