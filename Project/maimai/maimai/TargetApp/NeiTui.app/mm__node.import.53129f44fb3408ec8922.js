webpackJsonp([91],{1144:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}var i=a(1),n=l(i),s=a(981),r=(l(s),a(75)),c=(l(r),a(15)),o=(l(c),a(76)),d=(l(o),a(114)),u=(l(d),a(997)),f=l(u),p=a(271),m=l(p),h=a(994),v=l(h),b=a(50),y=(l(b),a(164)),k=a(278),E=l(k),_=n.default.createClass({displayName:"PubLive",mixins:[f.default],statics:{validate:function(e){var t=e.title,a=e.desc,l=e.start,i=e.feed;if(!t||t.length<8||t>30)throw"请填写职播标题，字数8~30";return{title:t,desc:a,start:l,feed:i}}},contextTypes:{req:n.default.PropTypes.object,fconf:n.default.PropTypes.object,auth_info:n.default.PropTypes.object},pub:function(){try{var e=_.validate(this.state);this.props.onPub(e)}catch(e){alert(e)}},componentDidMount:function(){document.body.style.background="#f5f5f5",this.props.live&&this.setState(this.props.live)},getInitialState:function(){return{title:"",desc:""}},onRowClicked:function(e){this.state.start?this.setState({start:null}):this.setState({start:Date.now()})},onPublishFeedClicked:function(e){this.state.feed?this.setState({feed:null}):this.setState({feed:1})},onTimeClick:function(){var e=this;(0,y.showDatePicker)("yyyy-MM-dd HH:mm",(0,E.default)(this.state.start).format("YYYY-MM-DD HH:mm"),0,function(t){var a=JSON.parse(t);e.setState({start:a.milli_sec_since1970})})},render:function(){var e=this;return n.default.createElement("div",null,n.default.createElement("div",{className:"panel-heading"},n.default.createElement("span",{className:"text-muted"},"职播")),n.default.createElement("div",{className:"borderTop"},n.default.createElement("div",{className:"pubTopicItem borderBottom"},n.default.createElement("input",{placeholder:"为您的职播取个标题，8～30字",valueLink:this.linkState("title")}))),n.default.createElement(m.default,{title:"详情介绍"}),n.default.createElement("div",{className:"pubLiveRow"},n.default.createElement("div",{className:"servicePriceCenter"},n.default.createElement("textarea",{placeholder:"请输入详情介绍（选填）",valueLink:this.linkState("desc")}))),!this.props.live&&n.default.createElement(v.default,{title:"发布动态",checked:this.state.feed,checkRowClicked:this.onPublishFeedClicked}),!this.props.live&&n.default.createElement("div",{className:"privayBox comtBox2"},n.default.createElement(v.default,{title:"立即开始职播",checked:!this.state.start,checkRowClicked:this.onRowClicked})),(this.props.live||this.state.start)&&n.default.createElement("div",{className:"privayBox comtBox2"},n.default.createElement("div",{className:"comtChoose clearfix",onClick:function(){return e.onTimeClick()}},n.default.createElement("span",{className:"left"},"预计开始时间"),n.default.createElement("span",{className:"arrow-bg"},(0,E.default)(this.state.start).format("YYYY-MM-DD HH:mm")))),n.default.createElement("div",{className:"panel-default p-x"},n.default.createElement("button",{className:"btn btn-lg m-y btn-block btn-secondary",onClick:this.pub},this.props.live||this.state.start?"提交":"开始职播")))}});e.exports=_},714:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},n=a(1),s=l(n),r=a(981),c=l(r),o=a(75),d=a(15),u=l(d),f=a(76),p=(l(f),a(114)),m=l(p),h=a(1144),v=l(h),b=a(46),y=l(b),k=s.default.createClass({displayName:"PubTopic",contextTypes:{req:s.default.PropTypes.object,fconf:s.default.PropTypes.object,auth_info:s.default.PropTypes.object},componentDidMount:function(){document.body.style.background="#f5f5f5"},pub:function(e){var t=this.context,a=(t.req,t.fconf),l=t.auth_info,n=i({},e,l),s=a.online_url+"user/v4/create_live",r=fetch(s,{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:u.default.stringify(n)}).then(o.parse_online_json).then(function(t){e.start?(0,y.default)("/article/live?id="+t.live_id,e.title,"fetch"):window.MaiMai_Native.native_live_video(t.live_id,!0),window.MaiMai_Native.close_native("",!0)}).catch(o.toast_error_handler);(0,m.default)("请稍候..",r)},render:function(){return s.default.createElement("div",null,s.default.createElement(c.default,{title:"发起职播"}),s.default.createElement(v.default,{onPub:this.pub}))}});e.exports=k}});